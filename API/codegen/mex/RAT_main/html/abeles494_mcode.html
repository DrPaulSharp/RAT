<pre class="code">
<span class="srcline"><span class="lineno"><a href="93,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T2U3">out</span> = abeles(<span class="var type1" id="S3T213U6">x</span>,<span class="var type1" id="S4T10U7">sld</span>,<span class="var type1" id="S5T4U8">nbair</span>,<span class="var type1" id="S6T4U9">nbsub</span>,<span class="var type1" id="S7T4U10">nrepeats</span>,<span class="var type1" id="S8T4U11">ssub</span>,<span class="var type1" id="S9T4U12">layers</span>,<span class="var type1" id="S10T4U13">points</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="93,2" id="srcline2"> 2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="93,3" id="srcline3"> 3</a></span><span class="line">	</span></span>
<span class="srcline"><span class="lineno"><a href="93,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">% nbair = nbairs(thisCont);</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">% nbsub = nbsubs(thisCont);</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">% ssub = ssubs(thisCont);</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,7" id="srcline7"> 7</a></span><span class="line"><span class="comment">% nrepeats = nrepeatss(thisCont);</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,8" id="srcline8"> 8</a></span><span class="line"><span class="comment">% resol = resols(thisCont);</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,9" id="srcline9"> 9</a></span><span class="line"><span class="mxinfo " id="T2:U10"><span class="var type1" id="S2T2U16">out</span> = <span class="mxinfo " id="T2:U12">zeros(<span class="var type1" id="S10T4U19">points</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,10" id="srcline10">10</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="93,11" id="srcline11">11</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="93,12" id="srcline12">12</a></span><span class="line"><span class="mxinfo " id="T271:U14"><span class="var type1" id="S12T271U23">c0</span> = <span class="mxinfo " id="T271:U16">complex(<span class="mxinfo " id="T4:U17">0</span>,<span class="mxinfo " id="T4:U18">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,13" id="srcline13">13</a></span><span class="line"><span class="mxinfo " id="T271:U19"><span class="var type1" id="S14T271U30">c1</span> = <span class="mxinfo " id="T271:U21">complex(1,0)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,14" id="srcline14">14</a></span><span class="line"><span class="mxinfo " id="T271:U22"><span class="var type1" id="S15T271U37">ci</span> = <span class="mxinfo " id="T271:U24">complex(<span class="mxinfo " id="T4:U25">0</span>,<span class="mxinfo " id="T4:U26">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,15" id="srcline15">15</a></span><span class="line"><span class="mxinfo " id="T271:U27"><span class="var type1" id="S16T271U44">plast</span> = <span class="mxinfo " id="T271:U29">complex(<span class="mxinfo " id="T4:U30">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,16" id="srcline16">16</a></span><span class="line"><span class="mxinfo " id="T271:U31"><span class="var type1" id="S17T271U50">blast</span> = <span class="mxinfo " id="T271:U33">complex(<span class="mxinfo " id="T4:U34">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,17" id="srcline17">17</a></span><span class="line"><span class="mxinfo " id="T272:U35"><span class="var type1" id="S18T272U56">N</span> = <span class="mxinfo " id="T272:U37">[<span class="mxinfo " id="T273:U38"><span class="var type1" id="S12T271U59">c0</span> <span class="var type1" id="S12T271U60">c0</span></span>; <span class="mxinfo " id="T273:U41"><span class="var type1" id="S12T271U62">c0</span> <span class="var type1" id="S12T271U63">c0</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,18" id="srcline18">18</a></span><span class="line"><span class="mxinfo " id="T272:U44"><span class="var type1" id="S19T272U66">MI</span> = <span class="mxinfo " id="T272:U46">[<span class="mxinfo " id="T273:U47"><span class="var type1" id="S12T271U69">c0</span> <span class="var type1" id="S12T271U70">c0</span></span>; <span class="mxinfo " id="T273:U50"><span class="var type1" id="S12T271U72">c0</span> <span class="var type1" id="S12T271U73">c0</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,19" id="srcline19">19</a></span><span class="line"><span class="mxinfo " id="T272:U53"><span class="var type1" id="S20T272U76">M</span> = <span class="mxinfo " id="T272:U55">[<span class="mxinfo " id="T273:U56"><span class="var type1" id="S12T271U79">c0</span> <span class="var type1" id="S12T271U80">c0</span></span>; <span class="mxinfo " id="T273:U59"><span class="var type1" id="S12T271U82">c0</span> <span class="var type1" id="S12T271U83">c0</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,20" id="srcline20">20</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="93,21" id="srcline21">21</a></span><span class="line"><span class="mxinfo " id="T4:U62"><span class="var type1" id="S21T4U86">lam</span> = <span class="mxinfo " id="T4:U64">4.5</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,22" id="srcline22">22</a></span><span class="line"><span class="mxinfo " id="T4:U65"><span class="var type1" id="S22T4U90">rfac</span> = <span class="mxinfo " id="T4:U67">((4*pi)*(4*pi))/2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,23" id="srcline23">23</a></span><span class="line"><span class="mxinfo " id="T4:U68"><span class="var type1" id="S24T4U107">twopi</span> = <span class="mxinfo " id="T4:U70">2*pi</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,24" id="srcline24">24</a></span><span class="line"><span class="mxinfo " id="T4:U71"><span class="var type1" id="S25T4U114">snair</span> = (<span class="mxinfo " id="T4:U73"><span class="mxinfo " id="T4:U74">1.0</span> - (<span class="mxinfo " id="T4:U75"><span class="var type1" id="S5T4U120">nbair</span>*(<span class="mxinfo " id="T4:U77">(<span class="mxinfo " id="T4:U78"><span class="var type1" id="S21T4U125">lam</span>*<span class="var type1" id="S21T4U126">lam</span></span>) / <span class="var type1" id="S24T4U127">twopi</span></span>)</span>)</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,25" id="srcline25">25</a></span><span class="line"><span class="mxinfo " id="T4:U82"><span class="var type1" id="S26T4U130">snsub</span> = (<span class="mxinfo " id="T4:U84"><span class="mxinfo " id="T4:U85">1.0</span> - (<span class="mxinfo " id="T4:U86"><span class="var type1" id="S6T4U136">nbsub</span>*(<span class="mxinfo " id="T4:U88">(<span class="mxinfo " id="T4:U89"><span class="var type1" id="S21T4U141">lam</span>*<span class="var type1" id="S21T4U142">lam</span></span>) / <span class="var type1" id="S24T4U143">twopi</span></span>)</span>)</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,26" id="srcline26">26</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S27T4U146">loop</span> = <span class="mxinfo " id="T2:U94"><span class="mxinfo " id="T4:U95">1</span>:<span class="var type1" id="S10T4U149">points</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="93,27" id="srcline27">27</a></span><span class="line">    <span class="mxinfo " id="T4:U97"><span class="var type1" id="S28T4U152">q</span> = <span class="mxinfo " id="T4:U99"><span class="var type1" id="S3T213U154">x</span>(<span class="var type1" id="S27T4U155">loop</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,28" id="srcline28">28</a></span><span class="line">    <span class="mxinfo " id="T4:U102"><span class="var type1" id="S29T4U158">theta</span> = <span class="mxinfo " id="T4:U104">asin(<span class="mxinfo " id="T4:U105"><span class="mxinfo " id="T4:U106"><span class="var type1" id="S28T4U163">q</span>*<span class="var type1" id="S21T4U164">lam</span></span> / (<span class="mxinfo " id="T4:U109">4*pi</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,29" id="srcline29">29</a></span><span class="line">    <span class="mxinfo " id="T4:U110"><span class="var type1" id="S31T4U172">preal</span> = <span class="mxinfo " id="T4:U112">(<span class="mxinfo " id="T4:U113">(<span class="var type1" id="S26T4U177">snsub</span>)*(<span class="var type1" id="S26T4U179">snsub</span>)</span>) - <span class="mxinfo " id="T4:U116">(<span class="mxinfo " id="T4:U117">(<span class="var type1" id="S25T4U184">snair</span>)*(<span class="var type1" id="S25T4U186">snair</span>)</span>)*(<span class="mxinfo " id="T4:U120"><span class="mxinfo " id="T4:U121">cos(<span class="var type1" id="S29T4U191">theta</span>)</span>^2</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,30" id="srcline30">30</a></span><span class="line">    <span class="mxinfo " id="T271:U123"><span class="var type1" id="S33T271U195">psub</span> = <span class="mxinfo " id="T271:U125">sqrt(<span class="mxinfo " id="T271:U126"><span class="var type1" id="S31T4U199">preal</span>*<span class="var type1" id="S14T271U200">c1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,31" id="srcline31">31</a></span><span class="line">    <span class="mxinfo " id="T271:U129"><span class="var type1" id="S35T271U203">pair</span> = <span class="mxinfo " id="T271:U131"><span class="mxinfo " id="T4:U132"><span class="var type1" id="S25T4U206">snair</span>*<span class="mxinfo " id="T4:U134">sin(<span class="var type1" id="S29T4U209">theta</span>)</span></span>*<span class="var type1" id="S14T271U210">c1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,32" id="srcline32">32</a></span><span class="line">    <span class="mxinfo " id="T271:U137"><span class="var type1" id="S16T271U213">plast</span> = <span class="var type1" id="S35T271U214">pair</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,33" id="srcline33">33</a></span><span class="line">    <span class="mxinfo " id="T271:U140"><span class="var type1" id="S17T271U217">blast</span> = <span class="mxinfo " id="T4:U142">0.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,34" id="srcline34">34</a></span><span class="line">    <span class="mxinfo " id="T4:U143"><span class="var type1" id="S37T4U221">rlast</span> = <span class="mxinfo " id="T4:U145"><span class="var type1" id="S4T10U223">sld</span>(<span class="mxinfo " id="T4:U147">1</span>,<span class="mxinfo " id="T4:U148">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,35" id="srcline35">35</a></span><span class="line">    <span class="mxinfo " id="T271:U149"><span class="mxinfo " id="T271:U150"><span class="var type1" id="S19T272U229">MI</span>(<span class="mxinfo " id="T4:U152">1</span>,<span class="mxinfo " id="T4:U153">1</span>)</span> = <span class="var type1" id="S14T271U232">c1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,36" id="srcline36">36</a></span><span class="line">    <span class="mxinfo " id="T271:U155"><span class="mxinfo " id="T271:U156"><span class="var type1" id="S19T272U236">MI</span>(<span class="mxinfo " id="T4:U158">2</span>,<span class="mxinfo " id="T4:U159">2</span>)</span> = <span class="var type1" id="S14T271U239">c1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,37" id="srcline37">37</a></span><span class="line">    <span class="mxinfo " id="T271:U161"><span class="mxinfo " id="T271:U162"><span class="var type1" id="S19T272U243">MI</span>(<span class="mxinfo " id="T4:U164">1</span>,<span class="mxinfo " id="T4:U165">2</span>)</span> = <span class="var type1" id="S12T271U246">c0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,38" id="srcline38">38</a></span><span class="line">    <span class="mxinfo " id="T271:U167"><span class="mxinfo " id="T271:U168"><span class="var type1" id="S19T272U250">MI</span>(<span class="mxinfo " id="T4:U170">2</span>,<span class="mxinfo " id="T4:U171">1</span>)</span> = <span class="var type1" id="S12T271U253">c0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,39" id="srcline39">39</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S38T4U256">reploop</span> = <span class="mxinfo " id="T2:U174"><span class="mxinfo " id="T4:U175">1</span>:<span class="var type1" id="S7T4U259">nrepeats</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="93,40" id="srcline40">40</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S39T4U262">nl</span> = <span class="mxinfo " id="T2:U178"><span class="mxinfo " id="T4:U179">1</span>:<span class="var type1" id="S9T4U265">layers</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="93,41" id="srcline41">41</a></span><span class="line">            <span class="mxinfo " id="T4:U181"><span class="var type1" id="S40T4U268">thick</span> = <span class="mxinfo " id="T4:U183"><span class="var type1" id="S4T10U270">sld</span>(<span class="var type1" id="S39T4U271">nl</span>,<span class="mxinfo " id="T67:U186">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,42" id="srcline42">42</a></span><span class="line">            <span class="mxinfo " id="T4:U187"><span class="var type1" id="S41T4U275">rho</span> = <span class="mxinfo " id="T4:U189"><span class="var type1" id="S4T10U277">sld</span>(<span class="var type1" id="S39T4U278">nl</span>,<span class="mxinfo " id="T67:U192">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,43" id="srcline43">43</a></span><span class="line">            <span class="mxinfo " id="T4:U193"><span class="var type1" id="S42T4U282">rough</span> = <span class="mxinfo " id="T4:U195"><span class="var type1" id="S4T10U284">sld</span>(<span class="var type1" id="S39T4U285">nl</span>,<span class="mxinfo " id="T67:U198">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,44" id="srcline44">44</a></span><span class="line">            <span class="mxinfo " id="T4:U199"><span class="var type1" id="S43T4U289">snlay</span> = (<span class="mxinfo " id="T4:U201"><span class="mxinfo " id="T4:U202">1</span> - (<span class="mxinfo " id="T4:U203"><span class="var type1" id="S41T4U295">rho</span>*(<span class="mxinfo " id="T4:U205">(<span class="mxinfo " id="T4:U206"><span class="var type1" id="S21T4U300">lam</span>*<span class="var type1" id="S21T4U301">lam</span></span>) / <span class="var type1" id="S24T4U302">twopi</span></span>)</span>)</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,45" id="srcline45">45</a></span><span class="line">            <span class="mxinfo " id="T4:U210"><span class="var type1" id="S31T4U305">preal</span> = <span class="mxinfo " id="T4:U212">(<span class="mxinfo " id="T4:U213"><span class="var type1" id="S43T4U309">snlay</span>*<span class="var type1" id="S43T4U310">snlay</span></span>) - <span class="mxinfo " id="T4:U216">(<span class="mxinfo " id="T4:U217"><span class="var type1" id="S25T4U314">snair</span>*<span class="var type1" id="S25T4U315">snair</span></span>) *<span class="mxinfo " id="T4:U220"><span class="mxinfo " id="T4:U221">cos(<span class="var type1" id="S29T4U319">theta</span>)</span>^2</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,46" id="srcline46">46</a></span><span class="line">            <span class="mxinfo " id="T271:U223"><span class="var type1" id="S44T271U323">pimag</span> = <span class="mxinfo " id="T271:U225">sqrt(<span class="mxinfo " id="T271:U226"><span class="var type1" id="S31T4U327">preal</span>*<span class="var type1" id="S14T271U328">c1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,47" id="srcline47">47</a></span><span class="line">            <span class="mxinfo " id="T271:U229"><span class="var type1" id="S45T271U331">beta</span> = <span class="mxinfo " id="T271:U231"><span class="mxinfo " id="T4:U232">(<span class="mxinfo " id="T4:U233"><span class="var type1" id="S24T4U336">twopi</span> / <span class="var type1" id="S21T4U337">lam</span></span>)*<span class="var type1" id="S40T4U338">thick</span></span>*<span class="var type1" id="S44T271U339">pimag</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,48" id="srcline48">48</a></span><span class="line">            <span class="mxinfo " id="T271:U238"><span class="var type1" id="S46T271U342">rij</span> = <span class="mxinfo " id="T271:U240">complex(<span class="mxinfo " id="T271:U241"><span class="var type1" id="S16T271U347">plast</span> - <span class="var type1" id="S44T271U348">pimag</span></span>) / complex(<span class="mxinfo " id="T271:U244"><span class="var type1" id="S16T271U352">plast</span> + <span class="var type1" id="S44T271U353">pimag</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,49" id="srcline49">49</a></span><span class="line">            <span class="mxinfo " id="T271:U247"><span class="var type1" id="S46T271U356">rij</span> = <span class="mxinfo " id="T271:U249"><span class="var type1" id="S46T271U358">rij</span> * <span class="mxinfo " id="T271:U251">exp(<span class="mxinfo " id="T271:U252"><span class="mxinfo " id="T271:U253"><span class="mxinfo " id="T271:U254"><span class="mxinfo " id="T271:U255"><span class="mxinfo " id="T4:U256">-<span class="var type1" id="S22T4U366">rfac</span></span>*<span class="var type1" id="S16T271U367">plast</span></span>*<span class="var type1" id="S44T271U368">pimag</span></span>*(<span class="mxinfo " id="T4:U260"><span class="var type1" id="S42T4U371">rough</span>*<span class="var type1" id="S42T4U372">rough</span></span>)</span>/(<span class="var type1" id="S21T4U375">lam</span>*<span class="var type1" id="S21T4U376">lam</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,50" id="srcline50">50</a></span><span class="line">            <span class="mxinfo " id="T271:U265"><span class="mxinfo " id="T271:U266"><span class="var type1" id="S18T272U380">N</span>(<span class="mxinfo " id="T67:U268">1</span> , <span class="mxinfo " id="T67:U269">1</span>)</span> = <span class="mxinfo " id="T271:U270">exp(<span class="mxinfo " id="T271:U271"><span class="var type1" id="S17T271U386">blast</span>*<span class="var type1" id="S15T271U387">ci</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,51" id="srcline51">51</a></span><span class="line">            <span class="mxinfo " id="T271:U274"><span class="mxinfo " id="T271:U275"><span class="var type1" id="S18T272U391">N</span>(<span class="mxinfo " id="T67:U277">2</span> , <span class="mxinfo " id="T67:U278">1</span>)</span> = <span class="mxinfo " id="T271:U279"><span class="var type1" id="S46T271U395">rij</span> * <span class="mxinfo " id="T271:U281">exp( <span class="mxinfo " id="T271:U282"><span class="mxinfo " id="T271:U283">- <span class="var type1" id="S17T271U400">blast</span></span>*<span class="var type1" id="S15T271U401">ci</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,52" id="srcline52">52</a></span><span class="line">            <span class="mxinfo " id="T271:U286"><span class="mxinfo " id="T271:U287"><span class="var type1" id="S18T272U405">N</span>(<span class="mxinfo " id="T67:U289">2</span> , <span class="mxinfo " id="T67:U290">2</span>)</span> = <span class="mxinfo " id="T271:U291">exp( <span class="mxinfo " id="T271:U292"><span class="mxinfo " id="T271:U293">- <span class="var type1" id="S17T271U412">blast</span></span>*<span class="var type1" id="S15T271U413">ci</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,53" id="srcline53">53</a></span><span class="line">            <span class="mxinfo " id="T271:U296"><span class="mxinfo " id="T271:U297"><span class="var type1" id="S18T272U417">N</span>(<span class="mxinfo " id="T67:U299">1</span> , <span class="mxinfo " id="T67:U300">2</span>)</span> = <span class="mxinfo " id="T271:U301"><span class="var type1" id="S46T271U421">rij</span> * <span class="mxinfo " id="T271:U303">exp(<span class="mxinfo " id="T271:U304"><span class="var type1" id="S17T271U425">blast</span>*<span class="var type1" id="S15T271U426">ci</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,54" id="srcline54">54</a></span><span class="line">            <span class="mxinfo " id="T271:U307"><span class="var type1" id="S16T271U429">plast</span> = <span class="var type1" id="S44T271U430">pimag</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,55" id="srcline55">55</a></span><span class="line">            <span class="mxinfo " id="T271:U310"><span class="var type1" id="S17T271U433">blast</span> = <span class="var type1" id="S45T271U434">beta</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,56" id="srcline56">56</a></span><span class="line">            <span class="mxinfo " id="T272:U313"><span class="var type1" id="S20T272U437">M</span> = <span class="var type1" id="S19T272U438">MI</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,57" id="srcline57">57</a></span><span class="line">            <span class="mxinfo " id="T272:U316"><span class="var type1" id="S19T272U441">MI</span> = <span class="mxinfo " id="T272:U318"><span class="var type1" id="S20T272U443">M</span> * <span class="var type1" id="S18T272U444">N</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,58" id="srcline58">58</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,59" id="srcline59">59</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,60" id="srcline60">60</a></span><span class="line">    <span class="mxinfo " id="T271:U321"><span class="var type1" id="S46T271U447">rij</span> = <span class="mxinfo " id="T271:U323">(complex(<span class="mxinfo " id="T271:U324"><span class="var type1" id="S16T271U453">plast</span> - <span class="var type1" id="S33T271U454">psub</span></span>)) / (complex(<span class="mxinfo " id="T271:U327"><span class="var type1" id="S16T271U459">plast</span> + <span class="var type1" id="S33T271U460">psub</span></span>))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,61" id="srcline61">61</a></span><span class="line">    <span class="mxinfo " id="T271:U330"><span class="var type1" id="S46T271U463">rij</span> = <span class="mxinfo " id="T271:U332"><span class="var type1" id="S46T271U465">rij</span> * <span class="mxinfo " id="T271:U334">exp(<span class="mxinfo " id="T271:U335"><span class="mxinfo " id="T271:U336"><span class="mxinfo " id="T271:U337"><span class="mxinfo " id="T271:U338"><span class="mxinfo " id="T4:U339">-<span class="var type1" id="S22T4U473">rfac</span></span>*<span class="var type1" id="S16T271U474">plast</span></span>*<span class="var type1" id="S33T271U475">psub</span></span>*(<span class="mxinfo " id="T4:U343"><span class="var type1" id="S8T4U478">ssub</span>*<span class="var type1" id="S8T4U479">ssub</span></span>)</span>/(<span class="var type1" id="S21T4U482">lam</span>*<span class="var type1" id="S21T4U483">lam</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,62" id="srcline62">62</a></span><span class="line">    <span class="mxinfo " id="T271:U348"><span class="mxinfo " id="T271:U349"><span class="var type1" id="S18T272U487">N</span>(<span class="mxinfo " id="T67:U351">1</span>,<span class="mxinfo " id="T67:U352">1</span>)</span> = <span class="mxinfo " id="T271:U353">exp(<span class="mxinfo " id="T271:U354"><span class="var type1" id="S17T271U493">blast</span>*<span class="var type1" id="S15T271U494">ci</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,63" id="srcline63">63</a></span><span class="line">    <span class="mxinfo " id="T271:U357"><span class="mxinfo " id="T271:U358"><span class="var type1" id="S18T272U498">N</span>(<span class="mxinfo " id="T67:U360">2</span>,<span class="mxinfo " id="T67:U361">1</span>)</span> = <span class="mxinfo " id="T271:U362"><span class="var type1" id="S46T271U502">rij</span>*<span class="mxinfo " id="T271:U364">exp( <span class="mxinfo " id="T271:U365"><span class="mxinfo " id="T271:U366">- <span class="var type1" id="S17T271U507">blast</span></span>*<span class="var type1" id="S15T271U508">ci</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,64" id="srcline64">64</a></span><span class="line">    <span class="mxinfo " id="T271:U369"><span class="mxinfo " id="T271:U370"><span class="var type1" id="S18T272U512">N</span>(<span class="mxinfo " id="T67:U372">2</span>,<span class="mxinfo " id="T67:U373">2</span>)</span> = <span class="mxinfo " id="T271:U374">exp( <span class="mxinfo " id="T271:U375"><span class="mxinfo " id="T271:U376">- <span class="var type1" id="S17T271U519">blast</span></span>*<span class="var type1" id="S15T271U520">ci</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,65" id="srcline65">65</a></span><span class="line">    <span class="mxinfo " id="T271:U379"><span class="mxinfo " id="T271:U380"><span class="var type1" id="S18T272U524">N</span>(<span class="mxinfo " id="T67:U382">1</span>,<span class="mxinfo " id="T67:U383">2</span>)</span> = <span class="mxinfo " id="T271:U384"><span class="var type1" id="S46T271U528">rij</span>*<span class="mxinfo " id="T271:U386">exp(<span class="mxinfo " id="T271:U387"><span class="var type1" id="S17T271U532">blast</span>*<span class="var type1" id="S15T271U533">ci</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,66" id="srcline66">66</a></span><span class="line">    <span class="mxinfo " id="T272:U390"><span class="var type1" id="S20T272U536">M</span> = <span class="var type1" id="S19T272U537">MI</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,67" id="srcline67">67</a></span><span class="line">    <span class="mxinfo " id="T272:U393"><span class="var type1" id="S19T272U540">MI</span> = <span class="mxinfo " id="T272:U395"><span class="var type1" id="S20T272U542">M</span> * <span class="var type1" id="S18T272U543">N</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,68" id="srcline68">68</a></span><span class="line">    <span class="mxinfo " id="T271:U398"><span class="var type1" id="S48T271U546">num</span> = <span class="mxinfo " id="T271:U400"><span class="mxinfo " id="T271:U401"><span class="var type1" id="S19T272U549">MI</span>(<span class="mxinfo " id="T67:U403">2</span> , <span class="mxinfo " id="T67:U404">1</span>)</span>*<span class="mxinfo " id="T271:U405">conj(<span class="mxinfo " id="T271:U406"><span class="var type1" id="S19T272U555">MI</span>(<span class="mxinfo " id="T4:U408">2</span> , <span class="mxinfo " id="T4:U409">1</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,69" id="srcline69">69</a></span><span class="line">    <span class="mxinfo " id="T271:U410"><span class="var type1" id="S50T271U560">den</span> = <span class="mxinfo " id="T271:U412"><span class="mxinfo " id="T271:U413"><span class="var type1" id="S19T272U563">MI</span>(<span class="mxinfo " id="T67:U415">1</span> , <span class="mxinfo " id="T67:U416">1</span>)</span>*<span class="mxinfo " id="T271:U417">conj(<span class="mxinfo " id="T271:U418"><span class="var type1" id="S19T272U569">MI</span>(<span class="mxinfo " id="T4:U420">1</span> , <span class="mxinfo " id="T4:U421">1</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,70" id="srcline70">70</a></span><span class="line">    <span class="mxinfo " id="T271:U422"><span class="var type1" id="S51T271U574">quo</span> = <span class="mxinfo " id="T271:U424"><span class="var type1" id="S48T271U576">num</span>/<span class="var type1" id="S50T271U577">den</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,71" id="srcline71">71</a></span><span class="line">    <span class="mxinfo " id="T4:U427"><span class="mxinfo " id="T4:U428"><span class="var type1" id="S2T2U581">out</span>(<span class="var type1" id="S27T4U582">loop</span>)</span> = <span class="mxinfo " id="T4:U431">real(<span class="var type1" id="S51T271U585">quo</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,72" id="srcline72">72</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,73" id="srcline73">73</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="93,74" id="srcline74">74</a></span><span class="line"><span class="keyword">return</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,75" id="srcline75">75</a></span><span class="line"><span class="keyword">end</span> </span></span>
</pre>
