<pre class="code">
<span class="srcline"><span class="lineno"><a href="91,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T2U3">out</span> = abeles(<span class="var type1" id="S3T9U6">x</span>,<span class="var type1" id="S4T16U7">sld</span>,<span class="var type1" id="S5T4U8">nbair</span>,<span class="var type1" id="S6T4U9">nbsub</span>,<span class="var type1" id="S7T4U10">nrepeats</span>,<span class="var type1" id="S8T4U11">ssub</span>,<span class="var type1" id="S9T4U12">layers</span>,<span class="var type1" id="S10T4U13">points</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="91,2" id="srcline2"> 2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="91,3" id="srcline3"> 3</a></span><span class="line">	</span></span>
<span class="srcline"><span class="lineno"><a href="91,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">% nbair = nbairs(thisCont);</span></span></span>
<span class="srcline"><span class="lineno"><a href="91,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">% nbsub = nbsubs(thisCont);</span></span></span>
<span class="srcline"><span class="lineno"><a href="91,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">% ssub = ssubs(thisCont);</span></span></span>
<span class="srcline"><span class="lineno"><a href="91,7" id="srcline7"> 7</a></span><span class="line"><span class="comment">% nrepeats = nrepeatss(thisCont);</span></span></span>
<span class="srcline"><span class="lineno"><a href="91,8" id="srcline8"> 8</a></span><span class="line"><span class="comment">% resol = resols(thisCont);</span></span></span>
<span class="srcline"><span class="lineno"><a href="91,9" id="srcline9"> 9</a></span><span class="line"><span class="mxinfo " id="T2:U10"><span class="var type1" id="S2T2U16">out</span> = <span class="mxinfo " id="T2:U12">zeros(<span class="var type1" id="S10T4U19">points</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,10" id="srcline10">10</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="91,11" id="srcline11">11</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="91,12" id="srcline12">12</a></span><span class="line"><span class="mxinfo " id="T207:U14"><span class="var type1" id="S12T207U23">c0</span> = <span class="mxinfo " id="T207:U16">complex(<span class="mxinfo " id="T4:U17">0</span>,<span class="mxinfo " id="T4:U18">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,13" id="srcline13">13</a></span><span class="line"><span class="mxinfo " id="T207:U19"><span class="var type1" id="S14T207U30">c1</span> = <span class="mxinfo " id="T207:U21">complex(1,0)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,14" id="srcline14">14</a></span><span class="line"><span class="mxinfo " id="T207:U22"><span class="var type1" id="S15T207U37">ci</span> = <span class="mxinfo " id="T207:U24">complex(<span class="mxinfo " id="T4:U25">0</span>,<span class="mxinfo " id="T4:U26">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,15" id="srcline15">15</a></span><span class="line"><span class="mxinfo " id="T207:U27"><span class="var type1" id="S16T207U44">plast</span> = <span class="mxinfo " id="T207:U29">complex(<span class="mxinfo " id="T4:U30">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,16" id="srcline16">16</a></span><span class="line"><span class="mxinfo " id="T207:U31"><span class="var type1" id="S17T207U50">blast</span> = <span class="mxinfo " id="T207:U33">complex(<span class="mxinfo " id="T4:U34">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,17" id="srcline17">17</a></span><span class="line"><span class="mxinfo " id="T208:U35"><span class="var type1" id="S18T208U56">N</span> = <span class="mxinfo " id="T208:U37">[<span class="mxinfo " id="T209:U38"><span class="var type1" id="S12T207U59">c0</span> <span class="var type1" id="S12T207U60">c0</span></span>; <span class="mxinfo " id="T209:U41"><span class="var type1" id="S12T207U62">c0</span> <span class="var type1" id="S12T207U63">c0</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,18" id="srcline18">18</a></span><span class="line"><span class="mxinfo " id="T208:U44"><span class="var type1" id="S19T208U66">MI</span> = <span class="mxinfo " id="T208:U46">[<span class="mxinfo " id="T209:U47"><span class="var type1" id="S12T207U69">c0</span> <span class="var type1" id="S12T207U70">c0</span></span>; <span class="mxinfo " id="T209:U50"><span class="var type1" id="S12T207U72">c0</span> <span class="var type1" id="S12T207U73">c0</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,19" id="srcline19">19</a></span><span class="line"><span class="mxinfo " id="T208:U53"><span class="var type1" id="S20T208U76">M</span> = <span class="mxinfo " id="T208:U55">[<span class="mxinfo " id="T209:U56"><span class="var type1" id="S12T207U79">c0</span> <span class="var type1" id="S12T207U80">c0</span></span>; <span class="mxinfo " id="T209:U59"><span class="var type1" id="S12T207U82">c0</span> <span class="var type1" id="S12T207U83">c0</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,20" id="srcline20">20</a></span><span class="line"><span class="comment">%pi = 3.141592653589;</span></span></span>
<span class="srcline"><span class="lineno"><a href="91,21" id="srcline21">21</a></span><span class="line"><span class="mxinfo " id="T4:U62"><span class="var type1" id="S21T4U86">lam</span> = <span class="mxinfo " id="T4:U64">4.5</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,22" id="srcline22">22</a></span><span class="line"><span class="mxinfo " id="T4:U65"><span class="var type1" id="S22T4U90">rfac</span> = <span class="mxinfo " id="T4:U67">((4*pi)*(4*pi))/2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,23" id="srcline23">23</a></span><span class="line"><span class="mxinfo " id="T4:U68"><span class="var type1" id="S24T4U107">twopi</span> = <span class="mxinfo " id="T4:U70">2*pi</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,24" id="srcline24">24</a></span><span class="line"><span class="mxinfo " id="T4:U71"><span class="var type1" id="S25T4U114">snair</span> = (<span class="mxinfo " id="T4:U73"><span class="mxinfo " id="T4:U74">1.0</span> - (<span class="mxinfo " id="T4:U75"><span class="var type1" id="S5T4U120">nbair</span>*(<span class="mxinfo " id="T4:U77">(<span class="mxinfo " id="T4:U78"><span class="var type1" id="S21T4U125">lam</span>*<span class="var type1" id="S21T4U126">lam</span></span>) / <span class="var type1" id="S24T4U127">twopi</span></span>)</span>)</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,25" id="srcline25">25</a></span><span class="line"><span class="mxinfo " id="T4:U82"><span class="var type1" id="S26T4U130">snsub</span> = (<span class="mxinfo " id="T4:U84"><span class="mxinfo " id="T4:U85">1.0</span> - (<span class="mxinfo " id="T4:U86"><span class="var type1" id="S6T4U136">nbsub</span>*(<span class="mxinfo " id="T4:U88">(<span class="mxinfo " id="T4:U89"><span class="var type1" id="S21T4U141">lam</span>*<span class="var type1" id="S21T4U142">lam</span></span>) / <span class="var type1" id="S24T4U143">twopi</span></span>)</span>)</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,26" id="srcline26">26</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S27T4U146">loop</span> = <span class="mxinfo " id="T2:U94"><span class="mxinfo " id="T4:U95">1</span>:<span class="var type1" id="S10T4U149">points</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="91,27" id="srcline27">27</a></span><span class="line">    <span class="mxinfo " id="T4:U97"><span class="var type1" id="S28T4U152">q</span> = <span class="mxinfo " id="T4:U99"><span class="var type1" id="S3T9U154">x</span>(<span class="var type1" id="S27T4U155">loop</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,28" id="srcline28">28</a></span><span class="line">    <span class="mxinfo " id="T4:U102"><span class="var type1" id="S29T4U158">theta</span> = <span class="mxinfo " id="T4:U104">asin(<span class="mxinfo " id="T4:U105"><span class="mxinfo " id="T4:U106"><span class="var type1" id="S28T4U163">q</span>*<span class="var type1" id="S21T4U164">lam</span></span> / (<span class="mxinfo " id="T4:U109">4*pi</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,29" id="srcline29">29</a></span><span class="line">    <span class="mxinfo " id="T4:U110"><span class="var type1" id="S31T4U172">preal</span> = <span class="mxinfo " id="T4:U112">(<span class="mxinfo " id="T4:U113">(<span class="var type1" id="S26T4U177">snsub</span>)*(<span class="var type1" id="S26T4U179">snsub</span>)</span>) - <span class="mxinfo " id="T4:U116">(<span class="mxinfo " id="T4:U117">(<span class="var type1" id="S25T4U184">snair</span>)*(<span class="var type1" id="S25T4U186">snair</span>)</span>)*(<span class="mxinfo " id="T4:U120"><span class="mxinfo " id="T4:U121">cos(<span class="var type1" id="S29T4U191">theta</span>)</span>^2</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,30" id="srcline30">30</a></span><span class="line">    <span class="mxinfo " id="T207:U123"><span class="var type1" id="S33T207U195">psub</span> = <span class="mxinfo " id="T207:U125">sqrt(<span class="mxinfo " id="T207:U126"><span class="var type1" id="S31T4U199">preal</span>*<span class="var type1" id="S14T207U200">c1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,31" id="srcline31">31</a></span><span class="line">    <span class="mxinfo " id="T207:U129"><span class="var type1" id="S35T207U203">pair</span> = <span class="mxinfo " id="T207:U131"><span class="mxinfo " id="T4:U132"><span class="var type1" id="S25T4U206">snair</span>*<span class="mxinfo " id="T4:U134">sin(<span class="var type1" id="S29T4U209">theta</span>)</span></span>*<span class="var type1" id="S14T207U210">c1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,32" id="srcline32">32</a></span><span class="line">    <span class="mxinfo " id="T207:U137"><span class="var type1" id="S16T207U213">plast</span> = <span class="var type1" id="S35T207U214">pair</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,33" id="srcline33">33</a></span><span class="line">    <span class="mxinfo " id="T207:U140"><span class="var type1" id="S17T207U217">blast</span> = <span class="mxinfo " id="T4:U142">0.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,34" id="srcline34">34</a></span><span class="line">    <span class="mxinfo " id="T4:U143"><span class="var type1" id="S37T4U221">rlast</span> = <span class="mxinfo " id="T4:U145"><span class="var type1" id="S4T16U223">sld</span>(<span class="mxinfo " id="T4:U147">1</span>,<span class="mxinfo " id="T4:U148">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,35" id="srcline35">35</a></span><span class="line">    <span class="mxinfo " id="T207:U149"><span class="mxinfo " id="T207:U150"><span class="var type1" id="S19T208U229">MI</span>(<span class="mxinfo " id="T4:U152">1</span>,<span class="mxinfo " id="T4:U153">1</span>)</span> = <span class="var type1" id="S14T207U232">c1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,36" id="srcline36">36</a></span><span class="line">    <span class="mxinfo " id="T207:U155"><span class="mxinfo " id="T207:U156"><span class="var type1" id="S19T208U236">MI</span>(<span class="mxinfo " id="T4:U158">2</span>,<span class="mxinfo " id="T4:U159">2</span>)</span> = <span class="var type1" id="S14T207U239">c1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,37" id="srcline37">37</a></span><span class="line">    <span class="mxinfo " id="T207:U161"><span class="mxinfo " id="T207:U162"><span class="var type1" id="S19T208U243">MI</span>(<span class="mxinfo " id="T4:U164">1</span>,<span class="mxinfo " id="T4:U165">2</span>)</span> = <span class="var type1" id="S12T207U246">c0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,38" id="srcline38">38</a></span><span class="line">    <span class="mxinfo " id="T207:U167"><span class="mxinfo " id="T207:U168"><span class="var type1" id="S19T208U250">MI</span>(<span class="mxinfo " id="T4:U170">2</span>,<span class="mxinfo " id="T4:U171">1</span>)</span> = <span class="var type1" id="S12T207U253">c0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,39" id="srcline39">39</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S38T4U256">reploop</span> = <span class="mxinfo " id="T2:U174"><span class="mxinfo " id="T4:U175">1</span>:<span class="var type1" id="S7T4U259">nrepeats</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="91,40" id="srcline40">40</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S39T4U262">nl</span> = <span class="mxinfo " id="T2:U178"><span class="mxinfo " id="T4:U179">1</span>:<span class="var type1" id="S9T4U265">layers</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="91,41" id="srcline41">41</a></span><span class="line">            <span class="mxinfo " id="T4:U181"><span class="var type1" id="S40T4U268">thick</span> = <span class="mxinfo " id="T4:U183"><span class="var type1" id="S4T16U270">sld</span>(<span class="var type1" id="S39T4U271">nl</span>,<span class="mxinfo " id="T42:U186">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,42" id="srcline42">42</a></span><span class="line">            <span class="mxinfo " id="T4:U187"><span class="var type1" id="S41T4U275">rho</span> = <span class="mxinfo " id="T4:U189"><span class="var type1" id="S4T16U277">sld</span>(<span class="var type1" id="S39T4U278">nl</span>,<span class="mxinfo " id="T42:U192">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,43" id="srcline43">43</a></span><span class="line">            <span class="mxinfo " id="T4:U193"><span class="var type1" id="S42T4U282">rough</span> = <span class="mxinfo " id="T4:U195"><span class="var type1" id="S4T16U284">sld</span>(<span class="var type1" id="S39T4U285">nl</span>,<span class="mxinfo " id="T42:U198">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,44" id="srcline44">44</a></span><span class="line">            <span class="mxinfo " id="T4:U199"><span class="var type1" id="S43T4U289">snlay</span> = (<span class="mxinfo " id="T4:U201"><span class="mxinfo " id="T4:U202">1</span> - (<span class="mxinfo " id="T4:U203"><span class="var type1" id="S41T4U295">rho</span>*(<span class="mxinfo " id="T4:U205">(<span class="mxinfo " id="T4:U206"><span class="var type1" id="S21T4U300">lam</span>*<span class="var type1" id="S21T4U301">lam</span></span>) / <span class="var type1" id="S24T4U302">twopi</span></span>)</span>)</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,45" id="srcline45">45</a></span><span class="line">            <span class="mxinfo " id="T4:U210"><span class="var type1" id="S31T4U305">preal</span> = <span class="mxinfo " id="T4:U212">(<span class="mxinfo " id="T4:U213"><span class="var type1" id="S43T4U309">snlay</span>*<span class="var type1" id="S43T4U310">snlay</span></span>) - <span class="mxinfo " id="T4:U216">(<span class="mxinfo " id="T4:U217"><span class="var type1" id="S25T4U314">snair</span>*<span class="var type1" id="S25T4U315">snair</span></span>) *<span class="mxinfo " id="T4:U220"><span class="mxinfo " id="T4:U221">cos(<span class="var type1" id="S29T4U319">theta</span>)</span>^2</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,46" id="srcline46">46</a></span><span class="line">            <span class="mxinfo " id="T207:U223"><span class="var type1" id="S44T207U323">pimag</span> = <span class="mxinfo " id="T207:U225">sqrt(<span class="mxinfo " id="T207:U226"><span class="var type1" id="S31T4U327">preal</span>*<span class="var type1" id="S14T207U328">c1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,47" id="srcline47">47</a></span><span class="line">            <span class="mxinfo " id="T207:U229"><span class="var type1" id="S45T207U331">beta</span> = <span class="mxinfo " id="T207:U231"><span class="mxinfo " id="T4:U232">(<span class="mxinfo " id="T4:U233"><span class="var type1" id="S24T4U336">twopi</span> / <span class="var type1" id="S21T4U337">lam</span></span>)*<span class="var type1" id="S40T4U338">thick</span></span>*<span class="var type1" id="S44T207U339">pimag</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,48" id="srcline48">48</a></span><span class="line">            <span class="mxinfo " id="T207:U238"><span class="var type1" id="S46T207U342">rij</span> = <span class="mxinfo " id="T207:U240">complex(<span class="mxinfo " id="T207:U241"><span class="var type1" id="S16T207U347">plast</span> - <span class="var type1" id="S44T207U348">pimag</span></span>) / complex(<span class="mxinfo " id="T207:U244"><span class="var type1" id="S16T207U352">plast</span> + <span class="var type1" id="S44T207U353">pimag</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,49" id="srcline49">49</a></span><span class="line">            <span class="mxinfo " id="T207:U247"><span class="var type1" id="S46T207U356">rij</span> = <span class="mxinfo " id="T207:U249"><span class="var type1" id="S46T207U358">rij</span> * <span class="mxinfo " id="T207:U251">exp(<span class="mxinfo " id="T207:U252"><span class="mxinfo " id="T207:U253"><span class="mxinfo " id="T207:U254"><span class="mxinfo " id="T207:U255"><span class="mxinfo " id="T4:U256">-<span class="var type1" id="S22T4U366">rfac</span></span>*<span class="var type1" id="S16T207U367">plast</span></span>*<span class="var type1" id="S44T207U368">pimag</span></span>*(<span class="mxinfo " id="T4:U260"><span class="var type1" id="S42T4U371">rough</span>*<span class="var type1" id="S42T4U372">rough</span></span>)</span>/(<span class="var type1" id="S21T4U375">lam</span>*<span class="var type1" id="S21T4U376">lam</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,50" id="srcline50">50</a></span><span class="line">            <span class="mxinfo " id="T207:U265"><span class="mxinfo " id="T207:U266"><span class="var type1" id="S18T208U380">N</span>(<span class="mxinfo " id="T42:U268">1</span> , <span class="mxinfo " id="T42:U269">1</span>)</span> = <span class="mxinfo " id="T207:U270">exp(<span class="mxinfo " id="T207:U271"><span class="var type1" id="S17T207U386">blast</span>*<span class="var type1" id="S15T207U387">ci</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,51" id="srcline51">51</a></span><span class="line">            <span class="mxinfo " id="T207:U274"><span class="mxinfo " id="T207:U275"><span class="var type1" id="S18T208U391">N</span>(<span class="mxinfo " id="T42:U277">2</span> , <span class="mxinfo " id="T42:U278">1</span>)</span> = <span class="mxinfo " id="T207:U279"><span class="var type1" id="S46T207U395">rij</span> * <span class="mxinfo " id="T207:U281">exp( <span class="mxinfo " id="T207:U282"><span class="mxinfo " id="T207:U283">- <span class="var type1" id="S17T207U400">blast</span></span>*<span class="var type1" id="S15T207U401">ci</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,52" id="srcline52">52</a></span><span class="line">            <span class="mxinfo " id="T207:U286"><span class="mxinfo " id="T207:U287"><span class="var type1" id="S18T208U405">N</span>(<span class="mxinfo " id="T42:U289">2</span> , <span class="mxinfo " id="T42:U290">2</span>)</span> = <span class="mxinfo " id="T207:U291">exp( <span class="mxinfo " id="T207:U292"><span class="mxinfo " id="T207:U293">- <span class="var type1" id="S17T207U412">blast</span></span>*<span class="var type1" id="S15T207U413">ci</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,53" id="srcline53">53</a></span><span class="line">            <span class="mxinfo " id="T207:U296"><span class="mxinfo " id="T207:U297"><span class="var type1" id="S18T208U417">N</span>(<span class="mxinfo " id="T42:U299">1</span> , <span class="mxinfo " id="T42:U300">2</span>)</span> = <span class="mxinfo " id="T207:U301"><span class="var type1" id="S46T207U421">rij</span> * <span class="mxinfo " id="T207:U303">exp(<span class="mxinfo " id="T207:U304"><span class="var type1" id="S17T207U425">blast</span>*<span class="var type1" id="S15T207U426">ci</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,54" id="srcline54">54</a></span><span class="line">            <span class="mxinfo " id="T207:U307"><span class="var type1" id="S16T207U429">plast</span> = <span class="var type1" id="S44T207U430">pimag</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,55" id="srcline55">55</a></span><span class="line">            <span class="mxinfo " id="T207:U310"><span class="var type1" id="S17T207U433">blast</span> = <span class="var type1" id="S45T207U434">beta</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,56" id="srcline56">56</a></span><span class="line">            <span class="mxinfo " id="T4:U313"><span class="var type1" id="S37T4U437">rlast</span> = <span class="var type1" id="S42T4U438">rough</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,57" id="srcline57">57</a></span><span class="line">            <span class="mxinfo " id="T208:U316"><span class="var type1" id="S20T208U441">M</span> = <span class="var type1" id="S19T208U442">MI</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,58" id="srcline58">58</a></span><span class="line">            <span class="mxinfo " id="T208:U319"><span class="var type1" id="S19T208U445">MI</span> = <span class="mxinfo " id="T208:U321"><span class="var type1" id="S20T208U447">M</span> * <span class="var type1" id="S18T208U448">N</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,59" id="srcline59">59</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="91,60" id="srcline60">60</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="91,61" id="srcline61">61</a></span><span class="line">    <span class="mxinfo " id="T207:U324"><span class="var type1" id="S46T207U451">rij</span> = <span class="mxinfo " id="T207:U326">(complex(<span class="mxinfo " id="T207:U327"><span class="var type1" id="S16T207U457">plast</span> - <span class="var type1" id="S33T207U458">psub</span></span>)) / (complex(<span class="mxinfo " id="T207:U330"><span class="var type1" id="S16T207U463">plast</span> + <span class="var type1" id="S33T207U464">psub</span></span>))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,62" id="srcline62">62</a></span><span class="line">    <span class="mxinfo " id="T207:U333"><span class="var type1" id="S46T207U467">rij</span> = <span class="mxinfo " id="T207:U335"><span class="var type1" id="S46T207U469">rij</span> * <span class="mxinfo " id="T207:U337">exp(<span class="mxinfo " id="T207:U338"><span class="mxinfo " id="T207:U339"><span class="mxinfo " id="T207:U340"><span class="mxinfo " id="T207:U341"><span class="mxinfo " id="T4:U342">-<span class="var type1" id="S22T4U477">rfac</span></span>*<span class="var type1" id="S16T207U478">plast</span></span>*<span class="var type1" id="S33T207U479">psub</span></span>*(<span class="mxinfo " id="T4:U346"><span class="var type1" id="S8T4U482">ssub</span>*<span class="var type1" id="S8T4U483">ssub</span></span>)</span>/(<span class="var type1" id="S21T4U486">lam</span>*<span class="var type1" id="S21T4U487">lam</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,63" id="srcline63">63</a></span><span class="line">    <span class="mxinfo " id="T207:U351"><span class="mxinfo " id="T207:U352"><span class="var type1" id="S18T208U491">N</span>(<span class="mxinfo " id="T42:U354">1</span>,<span class="mxinfo " id="T42:U355">1</span>)</span> = <span class="mxinfo " id="T207:U356">exp(<span class="mxinfo " id="T207:U357"><span class="var type1" id="S17T207U497">blast</span>*<span class="var type1" id="S15T207U498">ci</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,64" id="srcline64">64</a></span><span class="line">    <span class="mxinfo " id="T207:U360"><span class="mxinfo " id="T207:U361"><span class="var type1" id="S18T208U502">N</span>(<span class="mxinfo " id="T42:U363">2</span>,<span class="mxinfo " id="T42:U364">1</span>)</span> = <span class="mxinfo " id="T207:U365"><span class="var type1" id="S46T207U506">rij</span>*<span class="mxinfo " id="T207:U367">exp( <span class="mxinfo " id="T207:U368"><span class="mxinfo " id="T207:U369">- <span class="var type1" id="S17T207U511">blast</span></span>*<span class="var type1" id="S15T207U512">ci</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,65" id="srcline65">65</a></span><span class="line">    <span class="mxinfo " id="T207:U372"><span class="mxinfo " id="T207:U373"><span class="var type1" id="S18T208U516">N</span>(<span class="mxinfo " id="T42:U375">2</span>,<span class="mxinfo " id="T42:U376">2</span>)</span> = <span class="mxinfo " id="T207:U377">exp( <span class="mxinfo " id="T207:U378"><span class="mxinfo " id="T207:U379">- <span class="var type1" id="S17T207U523">blast</span></span>*<span class="var type1" id="S15T207U524">ci</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,66" id="srcline66">66</a></span><span class="line">    <span class="mxinfo " id="T207:U382"><span class="mxinfo " id="T207:U383"><span class="var type1" id="S18T208U528">N</span>(<span class="mxinfo " id="T42:U385">1</span>,<span class="mxinfo " id="T42:U386">2</span>)</span> = <span class="mxinfo " id="T207:U387"><span class="var type1" id="S46T207U532">rij</span>*<span class="mxinfo " id="T207:U389">exp(<span class="mxinfo " id="T207:U390"><span class="var type1" id="S17T207U536">blast</span>*<span class="var type1" id="S15T207U537">ci</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,67" id="srcline67">67</a></span><span class="line">    <span class="mxinfo " id="T208:U393"><span class="var type1" id="S20T208U540">M</span> = <span class="var type1" id="S19T208U541">MI</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,68" id="srcline68">68</a></span><span class="line">    <span class="mxinfo " id="T208:U396"><span class="var type1" id="S19T208U544">MI</span> = <span class="mxinfo " id="T208:U398"><span class="var type1" id="S20T208U546">M</span> * <span class="var type1" id="S18T208U547">N</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,69" id="srcline69">69</a></span><span class="line">    <span class="mxinfo " id="T207:U401"><span class="var type1" id="S48T207U550">num</span> = <span class="mxinfo " id="T207:U403"><span class="mxinfo " id="T207:U404"><span class="var type1" id="S19T208U553">MI</span>(<span class="mxinfo " id="T42:U406">2</span> , <span class="mxinfo " id="T42:U407">1</span>)</span>*<span class="mxinfo " id="T207:U408">conj(<span class="mxinfo " id="T207:U409"><span class="var type1" id="S19T208U559">MI</span>(<span class="mxinfo " id="T4:U411">2</span> , <span class="mxinfo " id="T4:U412">1</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,70" id="srcline70">70</a></span><span class="line">    <span class="mxinfo " id="T207:U413"><span class="var type1" id="S50T207U564">den</span> = <span class="mxinfo " id="T207:U415"><span class="mxinfo " id="T207:U416"><span class="var type1" id="S19T208U567">MI</span>(<span class="mxinfo " id="T42:U418">1</span> , <span class="mxinfo " id="T42:U419">1</span>)</span>*<span class="mxinfo " id="T207:U420">conj(<span class="mxinfo " id="T207:U421"><span class="var type1" id="S19T208U573">MI</span>(<span class="mxinfo " id="T4:U423">1</span> , <span class="mxinfo " id="T4:U424">1</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,71" id="srcline71">71</a></span><span class="line">    <span class="mxinfo " id="T207:U425"><span class="var type1" id="S51T207U578">quo</span> = <span class="mxinfo " id="T207:U427"><span class="var type1" id="S48T207U580">num</span>/<span class="var type1" id="S50T207U581">den</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,72" id="srcline72">72</a></span><span class="line">    <span class="mxinfo " id="T4:U430"><span class="mxinfo " id="T4:U431"><span class="var type1" id="S2T2U585">out</span>(<span class="var type1" id="S27T4U586">loop</span>)</span> = <span class="mxinfo " id="T4:U434">abs(<span class="var type1" id="S51T207U589">quo</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="91,73" id="srcline73">73</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="91,74" id="srcline74">74</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="91,75" id="srcline75">75</a></span><span class="line"><span class="keyword">return</span></span></span>
<span class="srcline"><span class="lineno"><a href="91,76" id="srcline76">76</a></span><span class="line"><span class="keyword">end</span> </span></span>
</pre>
