<pre class="code">
<span class="srcline"><span class="lineno"><a href="66,1" id="srcline1">  1</a></span><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,2" id="srcline2">  2</a></span><span class="line"><span class="comment">% Function:         [FVr_bestmem,S_bestval,I_nfeval] = deopt(fname,S_struct)</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,3" id="srcline3">  3</a></span><span class="line"><span class="comment">%                    </span></span></span>
<span class="srcline"><span class="lineno"><a href="66,4" id="srcline4">  4</a></span><span class="line"><span class="comment">% Author:           Rainer Storn, Ken Price, Arnold Neumaier, Jim Van Zandt</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,5" id="srcline5">  5</a></span><span class="line"><span class="comment">% Description:      Minimization of a user-supplied function with respect to x(1:I_D),</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,6" id="srcline6">  6</a></span><span class="line"><span class="comment">%                   using the differential evolution (DE) algorithm.</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,7" id="srcline7">  7</a></span><span class="line"><span class="comment">%                   DE works best if [FVr_minbound,FVr_maxbound] covers the region where the</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,8" id="srcline8">  8</a></span><span class="line"><span class="comment">%                   global minimum is expected. DE is also somewhat sensitive to</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,9" id="srcline9">  9</a></span><span class="line"><span class="comment">%                   the choice of the stepsize F_weight. A good initial guess is to</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">%                   choose F_weight from interval [0.5, 1], e.g. 0.8. F_CR, the crossover</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,11" id="srcline11"> 11</a></span><span class="line"><span class="comment">%                   probability constant from interval [0, 1] helps to maintain</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,12" id="srcline12"> 12</a></span><span class="line"><span class="comment">%                   the diversity of the population but should be close to 1 for most. </span></span></span>
<span class="srcline"><span class="lineno"><a href="66,13" id="srcline13"> 13</a></span><span class="line"><span class="comment">%                   practical cases. Only separable problems do better with CR close to 0.</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,14" id="srcline14"> 14</a></span><span class="line"><span class="comment">%                   If the parameters are correlated, high values of F_CR work better.</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,15" id="srcline15"> 15</a></span><span class="line"><span class="comment">%                   The reverse is true for no correlation.</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,16" id="srcline16"> 16</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,17" id="srcline17"> 17</a></span><span class="line"><span class="comment">%                   The number of population members I_NP is also not very critical. A</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,18" id="srcline18"> 18</a></span><span class="line"><span class="comment">%                   good initial guess is 10*I_D. Depending on the difficulty of the</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,19" id="srcline19"> 19</a></span><span class="line"><span class="comment">%                   problem I_NP can be lower than 10*I_D or must be higher than 10*I_D</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,20" id="srcline20"> 20</a></span><span class="line"><span class="comment">%                   to achieve convergence.</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,21" id="srcline21"> 21</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,22" id="srcline22"> 22</a></span><span class="line"><span class="comment">%                   deopt is a vectorized variant of DE which, however, has a</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,23" id="srcline23"> 23</a></span><span class="line"><span class="comment">%                   property which differs from the original version of DE:</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,24" id="srcline24"> 24</a></span><span class="line"><span class="comment">%                   The random selection of vectors is performed by shuffling the</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,25" id="srcline25"> 25</a></span><span class="line"><span class="comment">%                   population array. Hence a certain vector can't be chosen twice</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,26" id="srcline26"> 26</a></span><span class="line"><span class="comment">%                   in the same term of the perturbation expression.</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,27" id="srcline27"> 27</a></span><span class="line"><span class="comment">%                   Due to the vectorized expressions deopt executes fairly fast</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,28" id="srcline28"> 28</a></span><span class="line"><span class="comment">%                   in MATLAB's interpreter environment.</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,29" id="srcline29"> 29</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,30" id="srcline30"> 30</a></span><span class="line"><span class="comment">% Parameters:       fname        (I)    String naming a function f(x,y) to minimize.</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,31" id="srcline31"> 31</a></span><span class="line"><span class="comment">%                   S_struct     (I)    Problem data vector (must remain fixed during the</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,32" id="srcline32"> 32</a></span><span class="line"><span class="comment">%                                       minimization). For details see Rundeopt.m.</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,33" id="srcline33"> 33</a></span><span class="line"><span class="comment">%                   ---------members of S_struct----------------------------------------------------</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,34" id="srcline34"> 34</a></span><span class="line"><span class="comment">%                   F_VTR        (I)    "Value To Reach". deopt will stop its minimization</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,35" id="srcline35"> 35</a></span><span class="line"><span class="comment">%                                       if either the maximum number of iterations "I_itermax"</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,36" id="srcline36"> 36</a></span><span class="line"><span class="comment">%                                       is reached or the best parameter vector "FVr_bestmem" </span></span></span>
<span class="srcline"><span class="lineno"><a href="66,37" id="srcline37"> 37</a></span><span class="line"><span class="comment">%                                       has found a value f(FVr_bestmem,y) &lt;= F_VTR.</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,38" id="srcline38"> 38</a></span><span class="line"><span class="comment">%                   FVr_minbound (I)    Vector of lower bounds FVr_minbound(1) <span class="keyword">...</span><span class="comment"> FVr_minbound(I_D)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="66,39" id="srcline39"> 39</a></span><span class="line"><span class="comment">%                                       of initial population.</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,40" id="srcline40"> 40</a></span><span class="line"><span class="comment">%                                       *** note: these are not bound constraints!! ***</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,41" id="srcline41"> 41</a></span><span class="line"><span class="comment">%                   FVr_maxbound (I)    Vector of upper bounds FVr_maxbound(1) <span class="keyword">...</span><span class="comment"> FVr_maxbound(I_D)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="66,42" id="srcline42"> 42</a></span><span class="line"><span class="comment">%                                       of initial population.</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,43" id="srcline43"> 43</a></span><span class="line"><span class="comment">%                   I_D          (I)    Number of parameters of the objective function. </span></span></span>
<span class="srcline"><span class="lineno"><a href="66,44" id="srcline44"> 44</a></span><span class="line"><span class="comment">%                   I_NP         (I)    Number of population members.</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,45" id="srcline45"> 45</a></span><span class="line"><span class="comment">%                   I_itermax    (I)    Maximum number of iterations (generations).</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,46" id="srcline46"> 46</a></span><span class="line"><span class="comment">%                   F_weight     (I)    DE-stepsize F_weight from interval [0, 2].</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,47" id="srcline47"> 47</a></span><span class="line"><span class="comment">%                   F_CR         (I)    Crossover probability constant from interval [0, 1].</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,48" id="srcline48"> 48</a></span><span class="line"><span class="comment">%                   I_strategy   (I)    1 --&gt; DE/rand/1             </span></span></span>
<span class="srcline"><span class="lineno"><a href="66,49" id="srcline49"> 49</a></span><span class="line"><span class="comment">%                                       2 --&gt; DE/local-to-best/1             </span></span></span>
<span class="srcline"><span class="lineno"><a href="66,50" id="srcline50"> 50</a></span><span class="line"><span class="comment">%                                       3 --&gt; DE/best/1 with jitter  </span></span></span>
<span class="srcline"><span class="lineno"><a href="66,51" id="srcline51"> 51</a></span><span class="line"><span class="comment">%                                       4 --&gt; DE/rand/1 with per-vector-dither           </span></span></span>
<span class="srcline"><span class="lineno"><a href="66,52" id="srcline52"> 52</a></span><span class="line"><span class="comment">%                                       5 --&gt; DE/rand/1 with per-generation-dither</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,53" id="srcline53"> 53</a></span><span class="line"><span class="comment">%                                       6 --&gt; DE/rand/1 either-or-algorithm</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,54" id="srcline54"> 54</a></span><span class="line"><span class="comment">%                   I_refresh     (I)   Intermediate output will be produced after "I_refresh"</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,55" id="srcline55"> 55</a></span><span class="line"><span class="comment">%                                       iterations. No intermediate output will be produced</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,56" id="srcline56"> 56</a></span><span class="line"><span class="comment">%                                       if I_refresh is &lt; 1.</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,57" id="srcline57"> 57</a></span><span class="line"><span class="comment">%                                       </span></span></span>
<span class="srcline"><span class="lineno"><a href="66,58" id="srcline58"> 58</a></span><span class="line"><span class="comment">% Return value:     FVr_bestmem      (O)    Best parameter vector.</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,59" id="srcline59"> 59</a></span><span class="line"><span class="comment">%                   S_bestval.I_nc   (O)    Number of constraints</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,60" id="srcline60"> 60</a></span><span class="line"><span class="comment">%                   S_bestval.FVr_ca (O)    Constraint values. 0 means the constraints</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,61" id="srcline61"> 61</a></span><span class="line"><span class="comment">%                                           are met. Values &gt; 0 measure the distance</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,62" id="srcline62"> 62</a></span><span class="line"><span class="comment">%                                           to a particular constraint.</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,63" id="srcline63"> 63</a></span><span class="line"><span class="comment">%                   S_bestval.I_no   (O)    Number of objectives.</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,64" id="srcline64"> 64</a></span><span class="line"><span class="comment">%                   S_bestval.FVr_oa (O)    Objective function values.</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,65" id="srcline65"> 65</a></span><span class="line"><span class="comment">%                   I_nfeval         (O)    Number of function evaluations.</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,66" id="srcline66"> 66</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,67" id="srcline67"> 67</a></span><span class="line"><span class="comment">% Note:</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,68" id="srcline68"> 68</a></span><span class="line"><span class="comment">% This program is free software; you can redistribute it and/or modify</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,69" id="srcline69"> 69</a></span><span class="line"><span class="comment">% it under the terms of the GNU General Public License as published by</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,70" id="srcline70"> 70</a></span><span class="line"><span class="comment">% the Free Software Foundation; either version 1, or (at your option)</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,71" id="srcline71"> 71</a></span><span class="line"><span class="comment">% any later version.</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,72" id="srcline72"> 72</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,73" id="srcline73"> 73</a></span><span class="line"><span class="comment">% This program is distributed in the hope that it will be useful,</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,74" id="srcline74"> 74</a></span><span class="line"><span class="comment">% but WITHOUT ANY WARRANTY; without even the implied warranty of</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,75" id="srcline75"> 75</a></span><span class="line"><span class="comment">% MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,76" id="srcline76"> 76</a></span><span class="line"><span class="comment">% GNU General Public License for more details. A copy of the GNU </span></span></span>
<span class="srcline"><span class="lineno"><a href="66,77" id="srcline77"> 77</a></span><span class="line"><span class="comment">% General Public License can be obtained from the </span></span></span>
<span class="srcline"><span class="lineno"><a href="66,78" id="srcline78"> 78</a></span><span class="line"><span class="comment">% Free Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,79" id="srcline79"> 79</a></span><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,80" id="srcline80"> 80</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T3U3">FVr_bestmem</span> = rascal_deopt(<span class="var type1" id="S3T69U6">fname</span>,<span class="var type1" id="S4T1U7">problem</span>,<span class="var type1" id="S5T70U8">PlotIt</span>,<span class="var type1" id="S6T4U9">controls</span>,<span class="var type1" id="S7T13U10">S_struct</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="66,81" id="srcline81"> 81</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="66,82" id="srcline82"> 82</a></span><span class="line"><span class="comment">%[FVr_bestmem,S_bestval,I_nfeval]</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,83" id="srcline83"> 83</a></span><span class="line"><span class="mxinfo " id="T32:U7"><span class="var type1" id="S8T32U13">str</span> = <span class="mxinfo " id="T32:U9">struct(<span class="string">'I_nc'</span>,0,<span class="string">'FVr_ca'</span>,0,<span class="string">'I_no'</span>,0,<span class="string">'FVr_oa'</span>,0)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,84" id="srcline84"> 84</a></span><span class="line"><span class="mxinfo " id="T31:U10"><span class="var type1" id="S10T31U26">S_val</span> = <span class="mxinfo " id="T31:U12">repmat(<span class="var type1" id="S8T32U29">str</span>,<span class="mxinfo " id="T7:U14"><span class="var type1" id="S7T13U31">S_struct</span>.I_NP</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,85" id="srcline85"> 85</a></span><span class="line"><span class="comment">%coder.varsize(S_val(:),[Inf 1],[1 0]);</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,86" id="srcline86"> 86</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="66,87" id="srcline87"> 87</a></span><span class="line"><span class="comment">%-----This is just for notational convenience and to keep the code uncluttered.--------</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,88" id="srcline88"> 88</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="66,89" id="srcline89"> 89</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="66,90" id="srcline90"> 90</a></span><span class="line">coder.varsize(<span class="string">'problemDef.resample'</span>,[Inf,1],[1 0]);          </span></span>
<span class="srcline"><span class="lineno"><a href="66,91" id="srcline91"> 91</a></span><span class="line">coder.varsize(<span class="string">'FVr_bestmem'</span>,[1 2],[0 0]);</span></span>
<span class="srcline"><span class="lineno"><a href="66,92" id="srcline92"> 92</a></span><span class="line">coder.varsize(<span class="string">'FVr_bestmemit'</span>,[1 2],[0 0]);</span></span>
<span class="srcline"><span class="lineno"><a href="66,93" id="srcline93"> 93</a></span><span class="line"><span class="comment">%coder.varsize('FM_pop',[S_struct.I_NP,2],[1 0]);</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,94" id="srcline94"> 94</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="66,95" id="srcline95"> 95</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="66,96" id="srcline96"> 96</a></span><span class="line"><span class="mxinfo " id="T7:U16"><span class="var type1" id="S14T7U79">stopflag</span> = <span class="mxinfo " id="T7:U18">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,97" id="srcline97"> 97</a></span><span class="line"><span class="mxinfo " id="T7:U19"><span class="var type1" id="S15T7U83">I_best_index</span> = <span class="mxinfo " id="T7:U21">1</span></span>;      </span></span>
<span class="srcline"><span class="lineno"><a href="66,98" id="srcline98"> 98</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="66,99" id="srcline99"> 99</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="66,100" id="srcline100">100</a></span><span class="line"><span class="comment">%S_val = [0 0];</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,101" id="srcline101">101</a></span><span class="line"><span class="mxinfo " id="T40:U22"><span class="autoExtrinsicFcn" id="F228N5:B87">disp</span>(<span class="mxinfo " id="T71:U23"><span class="string">'***Starting Differential Evolution***'</span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,102" id="srcline102">102</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="66,103" id="srcline103">103</a></span><span class="line"><span class="mxinfo " id="T7:U24"><span class="var type1" id="S17T7U91">I_NP</span>         = <span class="mxinfo " id="T7:U26"><span class="var type1" id="S7T13U93">S_struct</span>.I_NP</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,104" id="srcline104">104</a></span><span class="line"><span class="mxinfo " id="T7:U28"><span class="var type1" id="S18T7U97">F_weight</span>     = <span class="mxinfo " id="T7:U30"><span class="var type1" id="S7T13U99">S_struct</span>.F_weight</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,105" id="srcline105">105</a></span><span class="line"><span class="mxinfo " id="T7:U32"><span class="var type1" id="S19T7U103">F_CR</span>         = <span class="mxinfo " id="T7:U34"><span class="var type1" id="S7T13U105">S_struct</span>.F_CR</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,106" id="srcline106">106</a></span><span class="line"><span class="mxinfo " id="T7:U36"><span class="var type1" id="S20T7U109">I_D</span>          = <span class="mxinfo " id="T7:U38"><span class="var type1" id="S7T13U111">S_struct</span>.I_D</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,107" id="srcline107">107</a></span><span class="line"><span class="mxinfo " id="T3:U40"><span class="var type1" id="S21T3U115">FVr_minbound</span> = <span class="mxinfo " id="T3:U42"><span class="var type1" id="S7T13U117">S_struct</span>.FVr_minbound</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,108" id="srcline108">108</a></span><span class="line"><span class="mxinfo " id="T3:U44"><span class="var type1" id="S22T3U121">FVr_maxbound</span> = <span class="mxinfo " id="T3:U46"><span class="var type1" id="S7T13U123">S_struct</span>.FVr_maxbound</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,109" id="srcline109">109</a></span><span class="line"><span class="mxinfo " id="T7:U48"><span class="var type1" id="S23T7U127">I_bnd_constr</span> = <span class="mxinfo " id="T7:U50"><span class="var type1" id="S7T13U129">S_struct</span>.I_bnd_constr</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,110" id="srcline110">110</a></span><span class="line"><span class="mxinfo " id="T7:U52"><span class="var type1" id="S24T7U133">I_itermax</span>    = <span class="mxinfo " id="T7:U54"><span class="var type1" id="S7T13U135">S_struct</span>.I_itermax</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,111" id="srcline111">111</a></span><span class="line"><span class="mxinfo " id="T7:U56"><span class="var type1" id="S25T7U139">F_VTR</span>        = <span class="mxinfo " id="T7:U58"><span class="var type1" id="S7T13U141">S_struct</span>.F_VTR</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,112" id="srcline112">112</a></span><span class="line"><span class="mxinfo " id="T7:U60"><span class="var type1" id="S26T7U145">I_strategy</span>   = <span class="mxinfo " id="T7:U62"><span class="var type1" id="S7T13U147">S_struct</span>.I_strategy</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,113" id="srcline113">113</a></span><span class="line"><span class="mxinfo " id="T7:U64"><span class="var type1" id="S27T7U151">I_refresh</span>    = <span class="mxinfo " id="T7:U66"><span class="var type1" id="S7T13U153">S_struct</span>.I_refresh</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,114" id="srcline114">114</a></span><span class="line"><span class="mxinfo " id="T7:U68"><span class="var type1" id="S28T7U157">I_plotting</span>   = <span class="mxinfo " id="T7:U70"><span class="var type1" id="S7T13U159">S_struct</span>.I_plotting</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,115" id="srcline115">115</a></span><span class="line"><span class="comment">%coder.varsize('FM_pop',[20,2],[0 0]);</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,116" id="srcline116">116</a></span><span class="line"><span class="comment">%FM_pop = zeros(I_NP,2);</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,117" id="srcline117">117</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="66,118" id="srcline118">118</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="66,119" id="srcline119">119</a></span><span class="line"><span class="comment">%-----Check input variables---------------------------------------------</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,120" id="srcline120">120</a></span><span class="line"><span class="keyword">if</span> (<span class="mxinfo " id="T18:U72"><span class="var type1" id="S17T7U165">I_NP</span> &lt; <span class="mxinfo " id="T7:U74">5</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="66,121" id="srcline121">121</a></span><span class="line">   <span class="var type1" id="S17T7U169">I_NP</span>=5;</span></span>
<span class="srcline"><span class="lineno"><a href="66,122" id="srcline122">122</a></span><span class="line">   fprintf(1,<span class="string">' I_NP increased to minimal value 5\n'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="66,123" id="srcline123">123</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,124" id="srcline124">124</a></span><span class="line"><span class="mxinfo " id="T18:U76"><span class="keyword">if</span> (<span class="mxinfo " id="T18:U77">(<span class="mxinfo " id="T18:U78"><span class="var type1" id="S19T7U182">F_CR</span> &lt; <span class="mxinfo " id="T7:U80">0</span></span>) | (<span class="mxinfo " id="T18:U81"><span class="var type1" id="S19T7U186">F_CR</span> &gt; <span class="mxinfo " id="T7:U83">1</span></span>)</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="66,125" id="srcline125">125</a></span><span class="line">   <span class="var type1" id="S19T7U190">F_CR</span>=0.5;</span></span>
<span class="srcline"><span class="lineno"><a href="66,126" id="srcline126">126</a></span><span class="line">   fprintf(1,<span class="string">'F_CR should be from interval [0,1]; set to default value 0.5\n'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="66,127" id="srcline127">127</a></span><span class="line"><span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="66,128" id="srcline128">128</a></span><span class="line"><span class="keyword">if</span> (<span class="mxinfo " id="T18:U85"><span class="var type1" id="S24T7U201">I_itermax</span> &lt;= <span class="mxinfo " id="T7:U87">0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="66,129" id="srcline129">129</a></span><span class="line">   <span class="var type1" id="S24T7U205">I_itermax</span> = 200;</span></span>
<span class="srcline"><span class="lineno"><a href="66,130" id="srcline130">130</a></span><span class="line">   fprintf(1,<span class="string">'I_itermax should be &gt; 0; set to default value 200\n'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="66,131" id="srcline131">131</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,132" id="srcline132">132</a></span><span class="line"><span class="mxinfo " id="T7:U89"><span class="var type1" id="S27T7U214">I_refresh</span> = <span class="mxinfo " id="T7:U91">floor(<span class="var type1" id="S27T7U217">I_refresh</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,133" id="srcline133">133</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="66,134" id="srcline134">134</a></span><span class="line"><span class="comment">%-----Initialize population and some arrays-------------------------------</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,135" id="srcline135">135</a></span><span class="line"><span class="mxinfo " id="T15:U93"><span class="var type1" id="S31T15U220">FM_pop</span> = <span class="mxinfo " id="T15:U95">zeros(<span class="var type1" id="S17T7U223">I_NP</span>,<span class="var type1" id="S20T7U224">I_D</span>)</span></span>; <span class="comment">%initialize FM_pop to gain speed</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,136" id="srcline136">136</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="66,137" id="srcline137">137</a></span><span class="line"><span class="comment">%----FM_pop is a matrix of size I_NPx(I_D+1). It will be initialized------</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,138" id="srcline138">138</a></span><span class="line"><span class="comment">%----with random values between the min and max values of the-------------</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,139" id="srcline139">139</a></span><span class="line"><span class="comment">%----parameters-----------------------------------------------------------</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,140" id="srcline140">140</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="66,141" id="srcline141">141</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S33T7U227">k</span>=<span class="mxinfo " id="T7:U99">1</span>:<span class="var type1" id="S17T7U230">I_NP</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,142" id="srcline142">142</a></span><span class="line">   <span class="mxinfo " id="T51:U101"><span class="mxinfo " id="T51:U102"><span class="var type1" id="S31T15U234">FM_pop</span>(<span class="var type1" id="S33T7U235">k</span>,<span class="mxinfo " id="T72:U105">:</span>)</span> = <span class="mxinfo " id="T3:U106"><span class="var type1" id="S21T3U238">FVr_minbound</span> + <span class="mxinfo " id="T3:U108"><span class="mxinfo " id="T44:U109">rand(1,<span class="var type1" id="S20T7U243">I_D</span>)</span>.*(<span class="mxinfo " id="T3:U111"><span class="var type1" id="S22T3U246">FVr_maxbound</span> - <span class="var type1" id="S21T3U247">FVr_minbound</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,143" id="srcline143">143</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,144" id="srcline144">144</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="66,145" id="srcline145">145</a></span><span class="line"><span class="comment">%FM_popold     = zeros(size(FM_pop));  % toggle population</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,146" id="srcline146">146</a></span><span class="line"><span class="mxinfo " id="T3:U114"><span class="var type1" id="S2T3U250">FVr_bestmem</span>   = <span class="mxinfo " id="T3:U116">zeros(<span class="mxinfo " id="T7:U117">1</span>,<span class="mxinfo " id="T7:U118">2</span>)</span></span>;<span class="comment">% best population member ever</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,147" id="srcline147">147</a></span><span class="line"><span class="mxinfo " id="T3:U119"><span class="var type1" id="S35T3U257">FVr_bestmemit</span> = <span class="mxinfo " id="T3:U121">zeros(<span class="mxinfo " id="T7:U122">1</span>,<span class="mxinfo " id="T7:U123">2</span>)</span></span>;<span class="comment">% best population member in iteration</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,148" id="srcline148">148</a></span><span class="line"><span class="mxinfo " id="T7:U124"><span class="var type1" id="S36T7U264">I_nfeval</span>      = <span class="mxinfo " id="T7:U126">0</span></span>;                    <span class="comment">% number of function evaluations</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,149" id="srcline149">149</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="66,150" id="srcline150">150</a></span><span class="line"><span class="comment">%------Evaluate the best member after initialization----------------------</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,151" id="srcline151">151</a></span><span class="line"><span class="comment">%str = struct('I_nc',0,'FVr_ca',0,'I_no',0,'FVr_oa',0);</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,152" id="srcline152">152</a></span><span class="line"><span class="comment">% S_MSE.FVr_ca    = [];</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,153" id="srcline153">153</a></span><span class="line"><span class="comment">% S_MSE.I_no      = [];</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,154" id="srcline154">154</a></span><span class="line"><span class="comment">% S_MSE.FVr_oa(1) = [];</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,155" id="srcline155">155</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="66,156" id="srcline156">156</a></span><span class="line"><span class="mxinfo " id="T32:U127"><span class="var type1" id="S8T32U268">str</span> = <span class="mxinfo " id="T32:U129">struct(<span class="string">'I_nc'</span>,0,<span class="string">'FVr_ca'</span>,0,<span class="string">'I_no'</span>,0,<span class="string">'FVr_oa'</span>,0)</span></span>;      </span></span>
<span class="srcline"><span class="lineno"><a href="66,157" id="srcline157">157</a></span><span class="line"><span class="mxinfo " id="T31:U130"><span class="var type1" id="S10T31U281">S_val</span> = <span class="mxinfo " id="T31:U132">repmat(<span class="var type1" id="S8T32U284">str</span>,<span class="var type1" id="S17T7U285">I_NP</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,158" id="srcline158">158</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="66,159" id="srcline159">159</a></span><span class="line">coder.varsize(<span class="string">'I_best_index'</span>,[1 1],[0 0]);</span></span>
<span class="srcline"><span class="lineno"><a href="66,160" id="srcline160">160</a></span><span class="line"><span class="mxinfo " id="T7:U135"><span class="var type1" id="S15T7U303">I_best_index</span>   = <span class="mxinfo " id="T7:U137">1</span></span>;                   <span class="comment">% start with first population member</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,161" id="srcline161">161</a></span><span class="line"><span class="mxinfo " id="T32:U138"><span class="mxinfo " id="T32:U139"><span class="var type1" id="S10T31U308">S_val</span>(<span class="mxinfo " id="T7:U141">1</span>)</span>       = <span class="mxinfo " id="T32:U142"><span class="mxinfo " id="T69:U143"><span class="fcn" id="F153N14:B69">fname</span></span>(<span class="mxinfo " id="T51:U144"><span class="var type1" id="S31T15U313">FM_pop</span>(<span class="var type1" id="S15T7U314">I_best_index</span>,<span class="mxinfo " id="T72:U147">:</span>)</span>,<span class="var type1" id="S4T1U316">problem</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,162" id="srcline162">162</a></span><span class="line"><span class="mxinfo " id="T32:U149"><span class="var type1" id="S37T32U319">S_bestval</span> = <span class="mxinfo " id="T32:U151"><span class="var type1" id="S10T31U321">S_val</span>(<span class="mxinfo " id="T7:U153">1</span>)</span></span>;                 <span class="comment">% best objective function value so far</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,163" id="srcline163">163</a></span><span class="line"><span class="mxinfo " id="T7:U154"><span class="var type1" id="S36T7U325">I_nfeval</span>  = <span class="mxinfo " id="T7:U156"><span class="var type1" id="S36T7U327">I_nfeval</span> + <span class="mxinfo " id="T7:U158">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,164" id="srcline164">164</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S33T7U331">k</span>=<span class="mxinfo " id="T7:U160">2</span>:<span class="var type1" id="S17T7U334">I_NP</span>                          <span class="comment">% check the remaining members</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,165" id="srcline165">165</a></span><span class="line">  <span class="mxinfo " id="T32:U162"><span class="mxinfo " id="T32:U163"><span class="var type1" id="S10T31U338">S_val</span>(<span class="var type1" id="S33T7U339">k</span>)</span>  = <span class="mxinfo " id="T32:U166"><span class="mxinfo " id="T69:U167"><span class="fcn" id="F153N14:B69">fname</span></span>(<span class="mxinfo " id="T51:U168"><span class="var type1" id="S31T15U343">FM_pop</span>(<span class="var type1" id="S33T7U344">k</span>,<span class="mxinfo " id="T72:U171">:</span>)</span>,<span class="var type1" id="S4T1U346">problem</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,166" id="srcline166">166</a></span><span class="line">  <span class="mxinfo " id="T7:U173"><span class="var type1" id="S36T7U349">I_nfeval</span>  = <span class="mxinfo " id="T7:U175"><span class="var type1" id="S36T7U351">I_nfeval</span> + <span class="mxinfo " id="T7:U177">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,167" id="srcline167">167</a></span><span class="line">  <span class="keyword">if</span> (<span class="mxinfo " id="T18:U178"><span class="mxinfo " id="T7:U179"><span class="fcn" id="F154N11:B358">left_win</span>(<span class="mxinfo " id="T32:U180"><span class="var type1" id="S10T31U360">S_val</span>(<span class="var type1" id="S33T7U361">k</span>)</span>,<span class="var type1" id="S37T32U362">S_bestval</span>)</span> == <span class="mxinfo " id="T7:U184">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="66,168" id="srcline168">168</a></span><span class="line">     <span class="mxinfo " id="T7:U185"><span class="var type1" id="S15T7U366">I_best_index</span>   = <span class="var type1" id="S33T7U367">k</span></span>;              <span class="comment">% save its location</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,169" id="srcline169">169</a></span><span class="line">     <span class="mxinfo " id="T32:U188"><span class="var type1" id="S37T32U370">S_bestval</span>      = <span class="mxinfo " id="T32:U190"><span class="var type1" id="S10T31U372">S_val</span>(<span class="var type1" id="S33T7U373">k</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,170" id="srcline170">170</a></span><span class="line">  <span class="keyword">end</span>   </span></span>
<span class="srcline"><span class="lineno"><a href="66,171" id="srcline171">171</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,172" id="srcline172">172</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="66,173" id="srcline173">173</a></span><span class="line"><span class="mxinfo " id="T3:U193"><span class="var type1" id="S39T3U376">val</span> = <span class="mxinfo " id="T3:U195">[<span class="mxinfo " id="T7:U196">0</span> <span class="mxinfo " id="T7:U197">0</span>]</span></span>;                                            </span></span>
<span class="srcline"><span class="lineno"><a href="66,174" id="srcline174">174</a></span><span class="line"><span class="mxinfo " id="T3:U198"><span class="var type1" id="S39T3U383">val</span> = <span class="mxinfo " id="T3:U200"><span class="var type1" id="S31T15U385">FM_pop</span>(<span class="var type1" id="S15T7U386">I_best_index</span>,<span class="mxinfo " id="T3:U203">[<span class="mxinfo " id="T7:U204">1</span> <span class="mxinfo " id="T7:U205">2</span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,175" id="srcline175">175</a></span><span class="line"><span class="mxinfo " id="T3:U206"><span class="var type1" id="S35T3U393">FVr_bestmemit</span> = <span class="var type1" id="S39T3U394">val</span></span>; <span class="comment">% best member of current iteration</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,176" id="srcline176">176</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="66,177" id="srcline177">177</a></span><span class="line"><span class="comment">% FVr_bestmemit = FM_pop(I_best_index,:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,178" id="srcline178">178</a></span><span class="line"><span class="comment">% S_bestvalit   = S_bestval;              % best value of current iteration</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,179" id="srcline179">179</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="66,180" id="srcline180">180</a></span><span class="line"><span class="mxinfo " id="T3:U209"><span class="var type1" id="S2T3U397">FVr_bestmem</span> = <span class="var type1" id="S35T3U398">FVr_bestmemit</span></span>;            <span class="comment">% best member ever</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,181" id="srcline181">181</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="66,182" id="srcline182">182</a></span><span class="line"><span class="comment">%------DE-Minimization---------------------------------------------</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,183" id="srcline183">183</a></span><span class="line"><span class="comment">%------FM_popold is the population which has to compete. It is--------</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,184" id="srcline184">184</a></span><span class="line"><span class="comment">%------static through one iteration. FM_pop is the newly--------------</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,185" id="srcline185">185</a></span><span class="line"><span class="comment">%------emerging population.----------------------------------------</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,186" id="srcline186">186</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="66,187" id="srcline187">187</a></span><span class="line"><span class="mxinfo " id="T15:U212"><span class="var type1" id="S40T15U401">FM_pm1</span>   = <span class="mxinfo " id="T15:U214">zeros(<span class="var type1" id="S17T7U404">I_NP</span>,<span class="var type1" id="S20T7U405">I_D</span>)</span></span>;   <span class="comment">% initialize population matrix 1</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,188" id="srcline188">188</a></span><span class="line"><span class="mxinfo " id="T73:U217"><span class="var type1" id="S41T73U408">FM_pm2</span>   = <span class="mxinfo " id="T15:U219">zeros(<span class="var type1" id="S17T7U411">I_NP</span>,<span class="var type1" id="S20T7U412">I_D</span>)</span></span>;   <span class="comment">% initialize population matrix 2</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,189" id="srcline189">189</a></span><span class="line"><span class="mxinfo " id="T73:U222"><span class="var type1" id="S42T73U415">FM_pm3</span>   = <span class="mxinfo " id="T15:U224">zeros(<span class="var type1" id="S17T7U418">I_NP</span>,<span class="var type1" id="S20T7U419">I_D</span>)</span></span>;   <span class="comment">% initialize population matrix 3</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,190" id="srcline190">190</a></span><span class="line"><span class="mxinfo " id="T73:U227"><span class="var type1" id="S43T73U422">FM_pm4</span>   = <span class="mxinfo " id="T15:U229">zeros(<span class="var type1" id="S17T7U425">I_NP</span>,<span class="var type1" id="S20T7U426">I_D</span>)</span></span>;   <span class="comment">% initialize population matrix 4</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,191" id="srcline191">191</a></span><span class="line"><span class="mxinfo " id="T73:U232"><span class="var type1" id="S44T73U429">FM_pm5</span>   = <span class="mxinfo " id="T15:U234">zeros(<span class="var type1" id="S17T7U432">I_NP</span>,<span class="var type1" id="S20T7U433">I_D</span>)</span></span>;   <span class="comment">% initialize population matrix 5</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,192" id="srcline192">192</a></span><span class="line"><span class="mxinfo " id="T15:U237"><span class="var type1" id="S45T15U436">FM_bm</span>    = <span class="mxinfo " id="T15:U239">zeros(<span class="var type1" id="S17T7U439">I_NP</span>,<span class="var type1" id="S20T7U440">I_D</span>)</span></span>;   <span class="comment">% initialize FVr_bestmember  matrix</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,193" id="srcline193">193</a></span><span class="line"><span class="mxinfo " id="T15:U242"><span class="var type1" id="S46T15U443">FM_ui</span>    = <span class="mxinfo " id="T15:U244">zeros(<span class="var type1" id="S17T7U446">I_NP</span>,<span class="var type1" id="S20T7U447">I_D</span>)</span></span>;   <span class="comment">% intermediate population of perturbed vectors</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,194" id="srcline194">194</a></span><span class="line"><span class="mxinfo " id="T15:U247"><span class="var type1" id="S47T15U450">FM_mui</span>   = <span class="mxinfo " id="T15:U249">zeros(<span class="var type1" id="S17T7U453">I_NP</span>,<span class="var type1" id="S20T7U454">I_D</span>)</span></span>;   <span class="comment">% mask for intermediate population</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,195" id="srcline195">195</a></span><span class="line"><span class="mxinfo " id="T15:U252"><span class="var type1" id="S48T15U457">FM_mpo</span>   = <span class="mxinfo " id="T15:U254">zeros(<span class="var type1" id="S17T7U460">I_NP</span>,<span class="var type1" id="S20T7U461">I_D</span>)</span></span>;   <span class="comment">% mask for old population</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,196" id="srcline196">196</a></span><span class="line"><span class="mxinfo " id="T44:U257"><span class="var type1" id="S49T44U464">FVr_rot</span>  = (<span class="mxinfo " id="T44:U259">0:1:<span class="mxinfo " id="T7:U260"><span class="var type1" id="S17T7U471">I_NP</span>-<span class="mxinfo " id="T7:U262">1</span></span></span>)</span>;               <span class="comment">% rotating index array (size I_NP)</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,197" id="srcline197">197</a></span><span class="line"><span class="mxinfo " id="T74:U263"><span class="var type1" id="S50T74U475">FVr_rotd</span> = (<span class="mxinfo " id="T44:U265">0:1:<span class="mxinfo " id="T7:U266"><span class="var type1" id="S20T7U482">I_D</span>-<span class="mxinfo " id="T7:U268">1</span></span></span>)</span>;       <span class="comment">% rotating index array (size I_D)</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,198" id="srcline198">198</a></span><span class="line"><span class="mxinfo " id="T75:U269"><span class="var type1" id="S51T75U486">FVr_rt</span>   = <span class="mxinfo " id="T76:U271">zeros(<span class="var type1" id="S17T7U489">I_NP</span>)</span></span>;                <span class="comment">% another rotating index array</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,199" id="srcline199">199</a></span><span class="line"><span class="mxinfo " id="T77:U273"><span class="var type1" id="S52T77U492">FVr_rtd</span>  = <span class="mxinfo " id="T77:U275">zeros(<span class="var type1" id="S20T7U495">I_D</span>)</span></span>;                 <span class="comment">% rotating index array for exponential crossover</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,200" id="srcline200">200</a></span><span class="line"><span class="mxinfo " id="T78:U277"><span class="var type1" id="S53T78U498">FVr_a1</span>   = <span class="mxinfo " id="T76:U279">zeros(<span class="var type1" id="S17T7U501">I_NP</span>)</span></span>;                <span class="comment">% index array</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,201" id="srcline201">201</a></span><span class="line"><span class="mxinfo " id="T75:U281"><span class="var type1" id="S54T75U504">FVr_a2</span>   = <span class="mxinfo " id="T76:U283">zeros(<span class="var type1" id="S17T7U507">I_NP</span>)</span></span>;                <span class="comment">% index array</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,202" id="srcline202">202</a></span><span class="line"><span class="mxinfo " id="T75:U285"><span class="var type1" id="S55T75U510">FVr_a3</span>   = <span class="mxinfo " id="T76:U287">zeros(<span class="var type1" id="S17T7U513">I_NP</span>)</span></span>;                <span class="comment">% index array</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,203" id="srcline203">203</a></span><span class="line"><span class="mxinfo " id="T75:U289"><span class="var type1" id="S56T75U516">FVr_a4</span>   = <span class="mxinfo " id="T76:U291">zeros(<span class="var type1" id="S17T7U519">I_NP</span>)</span></span>;                <span class="comment">% index array</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,204" id="srcline204">204</a></span><span class="line"><span class="mxinfo " id="T75:U293"><span class="var type1" id="S57T75U522">FVr_a5</span>   = <span class="mxinfo " id="T76:U295">zeros(<span class="var type1" id="S17T7U525">I_NP</span>)</span></span>;                <span class="comment">% index array</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,205" id="srcline205">205</a></span><span class="line"><span class="mxinfo " id="T79:U297"><span class="var type1" id="S58T79U528">FVr_ind</span>  = <span class="mxinfo " id="T79:U299">zeros(<span class="mxinfo " id="T7:U300">4</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,206" id="srcline206">206</a></span><span class="line"><span class="mxinfo " id="T3:U301"><span class="var type1" id="S2T3U534">FVr_bestmem</span> = <span class="mxinfo " id="T3:U303">zeros(<span class="mxinfo " id="T7:U304">1</span>,<span class="mxinfo " id="T7:U305">2</span>)</span></span>;            </span></span>
<span class="srcline"><span class="lineno"><a href="66,207" id="srcline207">207</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,208" id="srcline208">208</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="66,209" id="srcline209">209</a></span><span class="line"><span class="mxinfo " id="T15:U306"><span class="var type1" id="S59T15U541">FM_meanv</span> = <span class="mxinfo " id="T15:U308">ones(<span class="var type1" id="S17T7U544">I_NP</span>,<span class="var type1" id="S20T7U545">I_D</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,210" id="srcline210">210</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="66,211" id="srcline211">211</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,212" id="srcline212">212</a></span><span class="line"><span class="comment">%FM_pop = zeros(I_NP,2);</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,213" id="srcline213">213</a></span><span class="line"><span class="mxinfo " id="T7:U311"><span class="var type1" id="S61T7U548">I_iter</span> = <span class="mxinfo " id="T7:U313">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,214" id="srcline214">214</a></span><span class="line"><span class="mxinfo " id="T18:U314"><span class="keyword">while</span> ((<span class="mxinfo " id="T18:U315"><span class="var type1" id="S61T7U555">I_iter</span> &lt; <span class="var type1" id="S24T7U556">I_itermax</span></span>) &amp; (<span class="mxinfo " id="T18:U318"><span class="mxinfo " id="T7:U319"><span class="var type1" id="S37T32U561">S_bestval</span>.FVr_oa</span>(1) &gt; <span class="var type1" id="S25T7U564">F_VTR</span></span>))</span></span>
<span class="srcline"><span class="lineno"><a href="66,215" id="srcline215">215</a></span><span class="line">  <span class="mxinfo " id="T15:U322"><span class="var type1" id="S62T15U567">FM_popold</span> = <span class="var type1" id="S31T15U568">FM_pop</span></span>;                  <span class="comment">% save the old population</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,216" id="srcline216">216</a></span><span class="line">  <span class="comment">%S_struct.FM_pop = FM_pop;</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,217" id="srcline217">217</a></span><span class="line">  <span class="mxinfo " id="T3:U325"><span class="mxinfo " id="T3:U326"><span class="var type1" id="S7T13U572">S_struct</span>.FVr_bestmem</span> = <span class="var type1" id="S2T3U574">FVr_bestmem</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,218" id="srcline218">218</a></span><span class="line">  </span></span>
<span class="srcline"><span class="lineno"><a href="66,219" id="srcline219">219</a></span><span class="line">  <span class="mxinfo " id="T80:U329"><span class="var type1" id="S58T80U577">FVr_ind</span> = <span class="mxinfo " id="T54:U331">randperm(4)</span></span>;               <span class="comment">% index pointer array</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,220" id="srcline220">220</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="66,221" id="srcline221">221</a></span><span class="line">  <span class="mxinfo " id="T78:U332"><span class="var type1" id="S53T78U583">FVr_a1</span>  = <span class="mxinfo " id="T60:U334">randperm(<span class="var type1" id="S17T7U586">I_NP</span>)</span></span>;                   <span class="comment">% shuffle locations of vectors</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,222" id="srcline222">222</a></span><span class="line">  <span class="mxinfo " id="T75:U336"><span class="var type1" id="S51T75U589">FVr_rt</span>  = <span class="mxinfo " id="T44:U338">rem(<span class="mxinfo " id="T44:U339"><span class="var type1" id="S49T44U593">FVr_rot</span>+<span class="mxinfo " id="T7:U341"><span class="var type1" id="S58T80U595">FVr_ind</span>(<span class="mxinfo " id="T7:U343">1</span>)</span></span>,<span class="var type1" id="S17T7U597">I_NP</span>)</span></span>;     <span class="comment">% rotate indices by ind(1) positions</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,223" id="srcline223">223</a></span><span class="line">  <span class="mxinfo " id="T75:U345"><span class="var type1" id="S54T75U600">FVr_a2</span>  = <span class="mxinfo " id="T44:U347"><span class="var type1" id="S53T78U602">FVr_a1</span>(<span class="mxinfo " id="T44:U349"><span class="var type1" id="S51T75U604">FVr_rt</span>+<span class="mxinfo " id="T7:U351">1</span></span>)</span></span>;                 <span class="comment">% rotate vector locations</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,224" id="srcline224">224</a></span><span class="line">  <span class="mxinfo " id="T44:U352"><span class="var type1" id="S51T44U608">FVr_rt</span>  = <span class="mxinfo " id="T44:U354">rem(<span class="mxinfo " id="T44:U355"><span class="var type1" id="S49T44U612">FVr_rot</span>+<span class="mxinfo " id="T7:U357"><span class="var type1" id="S58T80U614">FVr_ind</span>(<span class="mxinfo " id="T7:U359">2</span>)</span></span>,<span class="var type1" id="S17T7U616">I_NP</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,225" id="srcline225">225</a></span><span class="line">  <span class="mxinfo " id="T75:U361"><span class="var type1" id="S55T75U619">FVr_a3</span>  = <span class="mxinfo " id="T44:U363"><span class="var type1" id="S54T75U621">FVr_a2</span>(<span class="mxinfo " id="T44:U365"><span class="var type1" id="S51T44U623">FVr_rt</span>+<span class="mxinfo " id="T7:U367">1</span></span>)</span></span>;                </span></span>
<span class="srcline"><span class="lineno"><a href="66,226" id="srcline226">226</a></span><span class="line">  <span class="mxinfo " id="T44:U368"><span class="var type1" id="S51T44U627">FVr_rt</span>  = <span class="mxinfo " id="T44:U370">rem(<span class="mxinfo " id="T44:U371"><span class="var type1" id="S49T44U631">FVr_rot</span>+<span class="mxinfo " id="T7:U373"><span class="var type1" id="S58T80U633">FVr_ind</span>(<span class="mxinfo " id="T7:U375">3</span>)</span></span>,<span class="var type1" id="S17T7U635">I_NP</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,227" id="srcline227">227</a></span><span class="line">  <span class="mxinfo " id="T75:U377"><span class="var type1" id="S56T75U638">FVr_a4</span>  = <span class="mxinfo " id="T44:U379"><span class="var type1" id="S55T75U640">FVr_a3</span>(<span class="mxinfo " id="T44:U381"><span class="var type1" id="S51T44U642">FVr_rt</span>+<span class="mxinfo " id="T7:U383">1</span></span>)</span></span>;               </span></span>
<span class="srcline"><span class="lineno"><a href="66,228" id="srcline228">228</a></span><span class="line">  <span class="mxinfo " id="T44:U384"><span class="var type1" id="S51T44U646">FVr_rt</span>  = <span class="mxinfo " id="T44:U386">rem(<span class="mxinfo " id="T44:U387"><span class="var type1" id="S49T44U650">FVr_rot</span>+<span class="mxinfo " id="T7:U389"><span class="var type1" id="S58T80U652">FVr_ind</span>(<span class="mxinfo " id="T7:U391">4</span>)</span></span>,<span class="var type1" id="S17T7U654">I_NP</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,229" id="srcline229">229</a></span><span class="line">  <span class="mxinfo " id="T75:U393"><span class="var type1" id="S57T75U657">FVr_a5</span>  = <span class="mxinfo " id="T44:U395"><span class="var type1" id="S56T75U659">FVr_a4</span>(<span class="mxinfo " id="T44:U397"><span class="var type1" id="S51T44U661">FVr_rt</span>+<span class="mxinfo " id="T7:U399">1</span></span>)</span></span>;                </span></span>
<span class="srcline"><span class="lineno"><a href="66,230" id="srcline230">230</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="66,231" id="srcline231">231</a></span><span class="line">  <span class="mxinfo " id="T15:U400"><span class="var type1" id="S40T15U665">FM_pm1</span> = <span class="mxinfo " id="T15:U402"><span class="var type1" id="S62T15U667">FM_popold</span>(<span class="var type1" id="S53T78U668">FVr_a1</span>,<span class="mxinfo " id="T72:U405">:</span>)</span></span>;             <span class="comment">% shuffled population 1</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,232" id="srcline232">232</a></span><span class="line">  <span class="mxinfo " id="T73:U406"><span class="var type1" id="S41T73U672">FM_pm2</span> = <span class="mxinfo " id="T73:U408"><span class="var type1" id="S62T15U674">FM_popold</span>(<span class="var type1" id="S54T75U675">FVr_a2</span>,<span class="mxinfo " id="T72:U411">:</span>)</span></span>;             <span class="comment">% shuffled population 2</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,233" id="srcline233">233</a></span><span class="line">  <span class="mxinfo " id="T73:U412"><span class="var type1" id="S42T73U679">FM_pm3</span> = <span class="mxinfo " id="T73:U414"><span class="var type1" id="S62T15U681">FM_popold</span>(<span class="var type1" id="S55T75U682">FVr_a3</span>,<span class="mxinfo " id="T72:U417">:</span>)</span></span>;             <span class="comment">% shuffled population 3</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,234" id="srcline234">234</a></span><span class="line">  <span class="mxinfo " id="T73:U418"><span class="var type1" id="S43T73U686">FM_pm4</span> = <span class="mxinfo " id="T73:U420"><span class="var type1" id="S62T15U688">FM_popold</span>(<span class="var type1" id="S56T75U689">FVr_a4</span>,<span class="mxinfo " id="T72:U423">:</span>)</span></span>;             <span class="comment">% shuffled population 4</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,235" id="srcline235">235</a></span><span class="line">  <span class="mxinfo " id="T73:U424"><span class="var type1" id="S44T73U693">FM_pm5</span> = <span class="mxinfo " id="T73:U426"><span class="var type1" id="S62T15U695">FM_popold</span>(<span class="var type1" id="S57T75U696">FVr_a5</span>,<span class="mxinfo " id="T72:U429">:</span>)</span></span>;             <span class="comment">% shuffled population 5</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,236" id="srcline236">236</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="66,237" id="srcline237">237</a></span><span class="line">  <span class="keyword">for</span> <span class="var type1" id="S33T7U700">k</span>=<span class="mxinfo " id="T7:U431">1</span>:<span class="var type1" id="S17T7U703">I_NP</span>                              <span class="comment">% population filled with the best member</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,238" id="srcline238">238</a></span><span class="line">    <span class="mxinfo " id="T51:U433"><span class="mxinfo " id="T51:U434"><span class="var type1" id="S45T15U707">FM_bm</span>(<span class="var type1" id="S33T7U708">k</span>,<span class="mxinfo " id="T72:U437">:</span>)</span> = <span class="var type1" id="S35T3U710">FVr_bestmemit</span></span>;             <span class="comment">% of the last iteration</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,239" id="srcline239">239</a></span><span class="line">  <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,240" id="srcline240">240</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="66,241" id="srcline241">241</a></span><span class="line">  <span class="mxinfo " id="T81:U439"><span class="var type1" id="S47T81U713">FM_mui</span> = <span class="mxinfo " id="T81:U441"><span class="mxinfo " id="T15:U442">rand(<span class="var type1" id="S17T7U717">I_NP</span>,<span class="var type1" id="S20T7U718">I_D</span>)</span> &lt; <span class="var type1" id="S19T7U719">F_CR</span></span></span>;  <span class="comment">% all random numbers &lt; F_CR are 1, 0 otherwise</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,242" id="srcline242">242</a></span><span class="line">  </span></span>
<span class="srcline"><span class="lineno"><a href="66,243" id="srcline243">243</a></span><span class="line">  <span class="comment">%----Insert this if you want exponential crossover.----------------</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,244" id="srcline244">244</a></span><span class="line">  <span class="comment">%FM_mui = sort(FM_mui');	  % transpose, collect 1's in each column</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,245" id="srcline245">245</a></span><span class="line">  <span class="comment">%for k  = 1:I_NP</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,246" id="srcline246">246</a></span><span class="line">  <span class="comment">%  n = floor(rand*I_D);</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,247" id="srcline247">247</a></span><span class="line">  <span class="comment">%  if (n &gt; 0)</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,248" id="srcline248">248</a></span><span class="line">  <span class="comment">%     FVr_rtd     = rem(FVr_rotd+n,I_D);</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,249" id="srcline249">249</a></span><span class="line">  <span class="comment">%     FM_mui(:,k) = FM_mui(FVr_rtd+1,k); %rotate column k by n</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,250" id="srcline250">250</a></span><span class="line">  <span class="comment">%  end</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,251" id="srcline251">251</a></span><span class="line">  <span class="comment">%end</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,252" id="srcline252">252</a></span><span class="line">  <span class="comment">%FM_mui = FM_mui';			  % transpose back</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,253" id="srcline253">253</a></span><span class="line">  <span class="comment">%----End: exponential crossover------------------------------------</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,254" id="srcline254">254</a></span><span class="line">  </span></span>
<span class="srcline"><span class="lineno"><a href="66,255" id="srcline255">255</a></span><span class="line">  <span class="mxinfo " id="T81:U446"><span class="var type1" id="S48T81U722">FM_mpo</span> = <span class="mxinfo " id="T81:U448"><span class="var type1" id="S47T81U724">FM_mui</span> &lt; <span class="mxinfo " id="T7:U450">0.5</span></span></span>;    <span class="comment">% inverse mask to FM_mui</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,256" id="srcline256">256</a></span><span class="line">  <span class="mxinfo " id="T73:U451"><span class="var type1" id="S65T73U728">FM_origin</span> = <span class="mxinfo " id="T15:U453">zeros(<span class="var type1" id="S17T7U731">I_NP</span>,<span class="mxinfo " id="T7:U455">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,257" id="srcline257">257</a></span><span class="line">  <span class="keyword">if</span> (<span class="mxinfo " id="T18:U456"><span class="var type1" id="S26T7U737">I_strategy</span> == <span class="mxinfo " id="T7:U458">1</span></span>)                             <span class="comment">% DE/rand/1</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,258" id="srcline258">258</a></span><span class="line">    <span class="var type1" id="S46T15U741">FM_ui</span> = <span class="var type1" id="S42T73U743">FM_pm3</span> + <span class="var type1" id="S18T7U745">F_weight</span>*(<span class="var type1" id="S40T15U748">FM_pm1</span> - <span class="var type1" id="S41T73U749">FM_pm2</span>);   <span class="comment">% differential variation</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,259" id="srcline259">259</a></span><span class="line">    <span class="var type1" id="S46T15U752">FM_ui</span> = <span class="var type1" id="S62T15U755">FM_popold</span>.*<span class="var type1" id="S48T81U756">FM_mpo</span> + <span class="var type1" id="S46T15U758">FM_ui</span>.*<span class="var type1" id="S47T81U759">FM_mui</span>;     <span class="comment">% crossover</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,260" id="srcline260">260</a></span><span class="line">    <span class="var type1" id="S65T73U762">FM_origin</span> = <span class="var type1" id="S42T73U763">FM_pm3</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,261" id="srcline261">261</a></span><span class="line">  <span class="keyword">elseif</span> (<span class="mxinfo " id="T18:U471"><span class="var type1" id="S26T7U767">I_strategy</span> == <span class="mxinfo " id="T7:U473">2</span></span>)                         <span class="comment">% DE/local-to-best/1</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,262" id="srcline262">262</a></span><span class="line">    <span class="var type1" id="S46T15U771">FM_ui</span> = <span class="var type1" id="S62T15U774">FM_popold</span> + <span class="var type1" id="S18T7U776">F_weight</span>*(<span class="var type1" id="S45T15U779">FM_bm</span>-<span class="var type1" id="S62T15U780">FM_popold</span>) + <span class="var type1" id="S18T7U782">F_weight</span>*(<span class="var type1" id="S40T15U785">FM_pm1</span> - <span class="var type1" id="S41T73U786">FM_pm2</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="66,263" id="srcline263">263</a></span><span class="line">    <span class="var type1" id="S46T15U789">FM_ui</span> = <span class="var type1" id="S62T15U792">FM_popold</span>.*<span class="var type1" id="S48T81U793">FM_mpo</span> + <span class="var type1" id="S46T15U795">FM_ui</span>.*<span class="var type1" id="S47T81U796">FM_mui</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,264" id="srcline264">264</a></span><span class="line">    <span class="var type1" id="S65T73U799">FM_origin</span> = <span class="var type1" id="S62T15U800">FM_popold</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,265" id="srcline265">265</a></span><span class="line">  <span class="keyword">elseif</span> (<span class="mxinfo " id="T18:U489"><span class="var type1" id="S26T7U804">I_strategy</span> == <span class="mxinfo " id="T7:U491">3</span></span>)                         <span class="comment">% DE/best/1 with jitter</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,266" id="srcline266">266</a></span><span class="line">    <span class="var type1" id="S46T15U808">FM_ui</span> = <span class="var type1" id="S45T15U810">FM_bm</span> + (<span class="var type1" id="S40T15U814">FM_pm1</span> - <span class="var type1" id="S41T73U815">FM_pm2</span>).*((1-0.9999)*rand(<span class="var type1" id="S17T7U825">I_NP</span>,<span class="var type1" id="S20T7U826">I_D</span>)+<span class="var type1" id="S18T7U827">F_weight</span>);               </span></span>
<span class="srcline"><span class="lineno"><a href="66,267" id="srcline267">267</a></span><span class="line">    <span class="var type1" id="S46T15U830">FM_ui</span> = <span class="var type1" id="S62T15U833">FM_popold</span>.*<span class="var type1" id="S48T81U834">FM_mpo</span> + <span class="var type1" id="S46T15U836">FM_ui</span>.*<span class="var type1" id="S47T81U837">FM_mui</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,268" id="srcline268">268</a></span><span class="line">    <span class="var type1" id="S65T73U840">FM_origin</span> = <span class="var type1" id="S45T15U841">FM_bm</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,269" id="srcline269">269</a></span><span class="line">  <span class="keyword">elseif</span> (<span class="mxinfo " id="T18:U506"><span class="var type1" id="S26T7U845">I_strategy</span> == <span class="mxinfo " id="T7:U508">4</span></span>)                         <span class="comment">% DE/rand/1 with per-vector-dither</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,270" id="srcline270">270</a></span><span class="line">     <span class="var type1" id="S66T66U849">f1</span> = ((1-<span class="var type1" id="S18T7U856">F_weight</span>)*rand(<span class="var type1" id="S17T7U859">I_NP</span>,1)+<span class="var type1" id="S18T7U861">F_weight</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="66,271" id="srcline271">271</a></span><span class="line">     <span class="keyword">for</span> <span class="var type1" id="S33T7U864">k</span>=1:<span class="var type1" id="S20T7U867">I_D</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,272" id="srcline272">272</a></span><span class="line">        <span class="var type1" id="S44T73U871">FM_pm5</span>(:,<span class="var type1" id="S33T7U873">k</span>)=<span class="var type1" id="S66T66U874">f1</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,273" id="srcline273">273</a></span><span class="line">     <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,274" id="srcline274">274</a></span><span class="line">     <span class="var type1" id="S46T15U877">FM_ui</span> = <span class="var type1" id="S42T73U879">FM_pm3</span> + (<span class="var type1" id="S40T15U883">FM_pm1</span> - <span class="var type1" id="S41T73U884">FM_pm2</span>).*<span class="var type1" id="S44T73U885">FM_pm5</span>;    <span class="comment">% differential variation</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,275" id="srcline275">275</a></span><span class="line">     <span class="var type1" id="S65T73U888">FM_origin</span> = <span class="var type1" id="S42T73U889">FM_pm3</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,276" id="srcline276">276</a></span><span class="line">     <span class="var type1" id="S46T15U892">FM_ui</span> = <span class="var type1" id="S62T15U895">FM_popold</span>.*<span class="var type1" id="S48T81U896">FM_mpo</span> + <span class="var type1" id="S46T15U898">FM_ui</span>.*<span class="var type1" id="S47T81U899">FM_mui</span>;     <span class="comment">% crossover</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,277" id="srcline277">277</a></span><span class="line">  <span class="keyword">elseif</span> (<span class="mxinfo " id="T18:U530"><span class="var type1" id="S26T7U903">I_strategy</span> == <span class="mxinfo " id="T7:U532">5</span></span>)                          <span class="comment">% DE/rand/1 with per-vector-dither</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,278" id="srcline278">278</a></span><span class="line">     <span class="mxinfo " id="T7:U533"><span class="var type1" id="S66T7U907">f1</span> = (<span class="mxinfo " id="T7:U535"><span class="mxinfo " id="T7:U536">(<span class="mxinfo " id="T7:U537"><span class="mxinfo " id="T7:U538">1</span>-<span class="var type1" id="S18T7U914">F_weight</span></span>)*<span class="mxinfo " id="T7:U540">rand</span></span>+<span class="var type1" id="S18T7U917">F_weight</span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,279" id="srcline279">279</a></span><span class="line">     <span class="mxinfo " id="T15:U542"><span class="var type1" id="S46T15U920">FM_ui</span> = <span class="mxinfo " id="T15:U544"><span class="var type1" id="S42T73U922">FM_pm3</span> + <span class="mxinfo " id="T15:U546">(<span class="mxinfo " id="T15:U547"><span class="var type1" id="S40T15U926">FM_pm1</span> - <span class="var type1" id="S41T73U927">FM_pm2</span></span>)*<span class="var type1" id="S66T7U928">f1</span></span></span></span>;         <span class="comment">% differential variation</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,280" id="srcline280">280</a></span><span class="line">     <span class="mxinfo " id="T73:U551"><span class="var type1" id="S65T73U931">FM_origin</span> = <span class="var type1" id="S42T73U932">FM_pm3</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,281" id="srcline281">281</a></span><span class="line">     <span class="mxinfo " id="T15:U554"><span class="var type1" id="S46T15U935">FM_ui</span> = <span class="mxinfo " id="T15:U556"><span class="mxinfo " id="T15:U557"><span class="var type1" id="S62T15U938">FM_popold</span>.*<span class="var type1" id="S48T81U939">FM_mpo</span></span> + <span class="mxinfo " id="T15:U560"><span class="var type1" id="S46T15U941">FM_ui</span>.*<span class="var type1" id="S47T81U942">FM_mui</span></span></span></span>;     <span class="comment">% crossover</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,282" id="srcline282">282</a></span><span class="line">  <span class="keyword">else</span>                                              <span class="comment">% either-or-algorithm</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,283" id="srcline283">283</a></span><span class="line">     <span class="keyword">if</span> (rand &lt; 0.5);                               <span class="comment">% Pmu = 0.5</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,284" id="srcline284">284</a></span><span class="line">        <span class="var type1" id="S46T15U953">FM_ui</span> = <span class="var type1" id="S42T73U955">FM_pm3</span> + <span class="var type1" id="S18T7U957">F_weight</span>*(<span class="var type1" id="S40T15U960">FM_pm1</span> - <span class="var type1" id="S41T73U961">FM_pm2</span>);<span class="comment">% differential variation</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,285" id="srcline285">285</a></span><span class="line">        <span class="var type1" id="S65T73U964">FM_origin</span> = <span class="var type1" id="S42T73U965">FM_pm3</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,286" id="srcline286">286</a></span><span class="line">     <span class="keyword">else</span>                                           <span class="comment">% use F-K-Rule: K = 0.5(F+1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,287" id="srcline287">287</a></span><span class="line">        <span class="var type1" id="S46T15U969">FM_ui</span> = <span class="var type1" id="S42T73U971">FM_pm3</span> + 0.5*(<span class="var type1" id="S18T7U977">F_weight</span>+1.0)*(<span class="var type1" id="S40T15U982">FM_pm1</span> + <span class="var type1" id="S41T73U983">FM_pm2</span> - 2*<span class="var type1" id="S42T73U986">FM_pm3</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="66,288" id="srcline288">288</a></span><span class="line">     <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,289" id="srcline289">289</a></span><span class="line">     <span class="var type1" id="S46T15U989">FM_ui</span> = <span class="var type1" id="S62T15U992">FM_popold</span>.*<span class="var type1" id="S48T81U993">FM_mpo</span> + <span class="var type1" id="S46T15U995">FM_ui</span>.*<span class="var type1" id="S47T81U996">FM_mui</span>;     <span class="comment">% crossover     </span></span></span>
<span class="srcline"><span class="lineno"><a href="66,290" id="srcline290">290</a></span><span class="line">  <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,291" id="srcline291">291</a></span><span class="line">  </span></span>
<span class="srcline"><span class="lineno"><a href="66,292" id="srcline292">292</a></span><span class="line"><span class="comment">%-----Optional parent+child selection-----------------------------------------</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,293" id="srcline293">293</a></span><span class="line">  </span></span>
<span class="srcline"><span class="lineno"><a href="66,294" id="srcline294">294</a></span><span class="line"><span class="comment">%-----Select which vectors are allowed to enter the new population------------</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,295" id="srcline295">295</a></span><span class="line">  <span class="keyword">for</span> <span class="var type1" id="S33T7U999">k</span>=<span class="mxinfo " id="T7:U582">1</span>:<span class="var type1" id="S17T7U1002">I_NP</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,296" id="srcline296">296</a></span><span class="line">   </span></span>
<span class="srcline"><span class="lineno"><a href="66,297" id="srcline297">297</a></span><span class="line">      <span class="comment">%=====Only use this if boundary constraints are needed==================</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,298" id="srcline298">298</a></span><span class="line">      <span class="keyword">if</span> (<span class="mxinfo " id="T18:U584"><span class="var type1" id="S23T7U1007">I_bnd_constr</span> == <span class="mxinfo " id="T7:U586">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="66,299" id="srcline299">299</a></span><span class="line">         <span class="keyword">for</span> <span class="var type1" id="S67T7U1011">j</span>=<span class="mxinfo " id="T7:U588">1</span>:<span class="var type1" id="S20T7U1014">I_D</span> <span class="comment">%----boundary constraints via bounce back-------</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,300" id="srcline300">300</a></span><span class="line">            <span class="keyword">if</span> (<span class="mxinfo " id="T18:U590"><span class="mxinfo " id="T7:U591"><span class="var type1" id="S46T15U1020">FM_ui</span>(<span class="var type1" id="S33T7U1021">k</span>,<span class="var type1" id="S67T7U1022">j</span>)</span> &gt; <span class="mxinfo " id="T7:U595"><span class="var type1" id="S22T3U1024">FVr_maxbound</span>(<span class="var type1" id="S67T7U1025">j</span>)</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="66,301" id="srcline301">301</a></span><span class="line">               <span class="mxinfo " id="T7:U598"><span class="mxinfo " id="T7:U599"><span class="var type1" id="S46T15U1029">FM_ui</span>(<span class="var type1" id="S33T7U1030">k</span>,<span class="var type1" id="S67T7U1031">j</span>)</span> = <span class="mxinfo " id="T7:U603"><span class="mxinfo " id="T7:U604"><span class="var type1" id="S22T3U1034">FVr_maxbound</span>(<span class="var type1" id="S67T7U1035">j</span>)</span> + <span class="mxinfo " id="T7:U607"><span class="mxinfo " id="T7:U608">rand</span>*(<span class="mxinfo " id="T7:U609"><span class="mxinfo " id="T7:U610"><span class="var type1" id="S65T73U1042">FM_origin</span>(<span class="var type1" id="S33T7U1043">k</span>,<span class="var type1" id="S67T7U1044">j</span>)</span> - <span class="mxinfo " id="T7:U614"><span class="var type1" id="S22T3U1046">FVr_maxbound</span>(<span class="var type1" id="S67T7U1047">j</span>)</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,302" id="srcline302">302</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,303" id="srcline303">303</a></span><span class="line">            <span class="keyword">if</span> (<span class="mxinfo " id="T18:U617"><span class="mxinfo " id="T7:U618"><span class="var type1" id="S46T15U1053">FM_ui</span>(<span class="var type1" id="S33T7U1054">k</span>,<span class="var type1" id="S67T7U1055">j</span>)</span> &lt; <span class="mxinfo " id="T7:U622"><span class="var type1" id="S21T3U1057">FVr_minbound</span>(<span class="var type1" id="S67T7U1058">j</span>)</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="66,304" id="srcline304">304</a></span><span class="line">               <span class="mxinfo " id="T7:U625"><span class="mxinfo " id="T7:U626"><span class="var type1" id="S46T15U1062">FM_ui</span>(<span class="var type1" id="S33T7U1063">k</span>,<span class="var type1" id="S67T7U1064">j</span>)</span> = <span class="mxinfo " id="T7:U630"><span class="mxinfo " id="T7:U631"><span class="var type1" id="S21T3U1067">FVr_minbound</span>(<span class="var type1" id="S67T7U1068">j</span>)</span> + <span class="mxinfo " id="T7:U634"><span class="mxinfo " id="T7:U635">rand</span>*(<span class="mxinfo " id="T7:U636"><span class="mxinfo " id="T7:U637"><span class="var type1" id="S65T73U1075">FM_origin</span>(<span class="var type1" id="S33T7U1076">k</span>,<span class="var type1" id="S67T7U1077">j</span>)</span> - <span class="mxinfo " id="T7:U641"><span class="var type1" id="S21T3U1079">FVr_minbound</span>(<span class="var type1" id="S67T7U1080">j</span>)</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,305" id="srcline305">305</a></span><span class="line">            <span class="keyword">end</span>   </span></span>
<span class="srcline"><span class="lineno"><a href="66,306" id="srcline306">306</a></span><span class="line">         <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,307" id="srcline307">307</a></span><span class="line">      <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,308" id="srcline308">308</a></span><span class="line">      <span class="comment">%=====End boundary constraints==========================================</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,309" id="srcline309">309</a></span><span class="line">  </span></span>
<span class="srcline"><span class="lineno"><a href="66,310" id="srcline310">310</a></span><span class="line">      <span class="mxinfo " id="T32:U644"><span class="var type1" id="S68T32U1083">S_tempval</span> = <span class="mxinfo " id="T32:U646"><span class="mxinfo " id="T69:U647"><span class="fcn" id="F153N14:B69">fname</span></span>(<span class="mxinfo " id="T51:U648"><span class="var type1" id="S46T15U1087">FM_ui</span>(<span class="var type1" id="S33T7U1088">k</span>,<span class="mxinfo " id="T72:U651">:</span>)</span>,<span class="var type1" id="S4T1U1090">problem</span>)</span></span>;   <span class="comment">% check cost of competitor</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,311" id="srcline311">311</a></span><span class="line">      <span class="mxinfo " id="T7:U653"><span class="var type1" id="S36T7U1093">I_nfeval</span>  = <span class="mxinfo " id="T7:U655"><span class="var type1" id="S36T7U1095">I_nfeval</span> + <span class="mxinfo " id="T7:U657">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,312" id="srcline312">312</a></span><span class="line">      <span class="keyword">if</span> (<span class="mxinfo " id="T18:U658"><span class="mxinfo " id="T7:U659"><span class="fcn" id="F154N11:B1102">left_win</span>(<span class="var type1" id="S68T32U1103">S_tempval</span>,<span class="mxinfo " id="T32:U661"><span class="var type1" id="S10T31U1105">S_val</span>(<span class="var type1" id="S33T7U1106">k</span>)</span>)</span> == <span class="mxinfo " id="T7:U664">1</span></span>)   </span></span>
<span class="srcline"><span class="lineno"><a href="66,313" id="srcline313">313</a></span><span class="line">         <span class="mxinfo " id="T51:U665"><span class="mxinfo " id="T51:U666"><span class="var type1" id="S31T15U1111">FM_pop</span>(<span class="var type1" id="S33T7U1112">k</span>,<span class="mxinfo " id="T72:U669">:</span>)</span> = <span class="mxinfo " id="T51:U670"><span class="var type1" id="S46T15U1115">FM_ui</span>(<span class="var type1" id="S33T7U1116">k</span>,<span class="mxinfo " id="T72:U673">:</span>)</span></span>;                    <span class="comment">% replace old vector with new one (for new iteration)</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,314" id="srcline314">314</a></span><span class="line">         <span class="mxinfo " id="T32:U674"><span class="mxinfo " id="T32:U675"><span class="var type1" id="S10T31U1121">S_val</span>(<span class="var type1" id="S33T7U1122">k</span>)</span>   = <span class="var type1" id="S68T32U1123">S_tempval</span></span>;                      <span class="comment">% save value in "cost array"</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,315" id="srcline315">315</a></span><span class="line">      </span></span>
<span class="srcline"><span class="lineno"><a href="66,316" id="srcline316">316</a></span><span class="line">         <span class="comment">%----we update S_bestval only in case of success to save time-----------</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,317" id="srcline317">317</a></span><span class="line">         <span class="keyword">if</span> (<span class="mxinfo " id="T18:U679"><span class="mxinfo " id="T7:U680"><span class="fcn" id="F154N11:B1129">left_win</span>(<span class="var type1" id="S68T32U1130">S_tempval</span>,<span class="var type1" id="S37T32U1131">S_bestval</span>)</span> == <span class="mxinfo " id="T7:U683">1</span></span>)   </span></span>
<span class="srcline"><span class="lineno"><a href="66,318" id="srcline318">318</a></span><span class="line">            <span class="mxinfo " id="T32:U684"><span class="var type1" id="S37T32U1135">S_bestval</span> = <span class="var type1" id="S68T32U1136">S_tempval</span></span>;                    <span class="comment">% new best value</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,319" id="srcline319">319</a></span><span class="line">            <span class="mxinfo " id="T3:U687"><span class="var type1" id="S2T3U1139">FVr_bestmem</span> = <span class="mxinfo " id="T3:U689"><span class="var type1" id="S46T15U1141">FM_ui</span>(<span class="var type1" id="S33T7U1142">k</span>,<span class="mxinfo " id="T3:U692">[<span class="mxinfo " id="T7:U693">1</span> <span class="mxinfo " id="T7:U694">2</span>]</span>)</span></span>;                 <span class="comment">% new best parameter vector ever</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,320" id="srcline320">320</a></span><span class="line">         <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,321" id="srcline321">321</a></span><span class="line">      <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,322" id="srcline322">322</a></span><span class="line">   <span class="keyword">end</span> <span class="comment">% for k = 1:NP</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,323" id="srcline323">323</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="66,324" id="srcline324">324</a></span><span class="line">  <span class="mxinfo " id="T3:U695"><span class="var type1" id="S35T3U1149">FVr_bestmemit</span> = <span class="var type1" id="S2T3U1150">FVr_bestmem</span></span>;       <span class="comment">% freeze the best member of this iteration for the coming </span></span></span>
<span class="srcline"><span class="lineno"><a href="66,325" id="srcline325">325</a></span><span class="line">                                     <span class="comment">% iteration. This is needed for some of the strategies.</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,326" id="srcline326">326</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="66,327" id="srcline327">327</a></span><span class="line"><span class="comment">%----Output section----------------------------------------------------------</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,328" id="srcline328">328</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="66,329" id="srcline329">329</a></span><span class="line">  <span class="keyword">if</span> (<span class="mxinfo " id="T18:U698"><span class="var type1" id="S27T7U1155">I_refresh</span> &gt; <span class="mxinfo " id="T7:U700">0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="66,330" id="srcline330">330</a></span><span class="line">     <span class="mxinfo " id="T18:U701"><span class="keyword">if</span> (<span class="mxinfo " id="T18:U702">(<span class="mxinfo " id="T18:U703"><span class="mxinfo " id="T7:U704">rem(<span class="var type1" id="S61T7U1165">I_iter</span>,<span class="var type1" id="S27T7U1166">I_refresh</span>)</span> == <span class="mxinfo " id="T7:U707">0</span></span>) | <span class="mxinfo " id="T18:U708"><span class="var type1" id="S61T7U1169">I_iter</span> == <span class="mxinfo " id="T7:U710">1</span></span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="66,331" id="srcline331">331</a></span><span class="line">       <span class="comment">%addInfoText(sprintf('Iteration: %d,  Best: %f,  F_weight: %f,  F_CR: %f,  I_NP: %d\n',I_iter,S_bestval.FVr_oa(1),F_weight,F_CR,I_NP));</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,332" id="srcline332">332</a></span><span class="line">       <span class="mxinfo " id="T40:U711"><span class="autoExtrinsicFcn" id="F237N5:B1173">disp</span>(<span class="var type1" id="S37T32U1174">S_bestval</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,333" id="srcline333">333</a></span><span class="line">       <span class="comment">%var(FM_pop)</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,334" id="srcline334">334</a></span><span class="line"><span class="comment">%        format long e;</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,335" id="srcline335">335</a></span><span class="line"><span class="comment">%        for n=1:I_D</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,336" id="srcline336">336</a></span><span class="line"><span class="comment">%           addInfoText(sprintf('best(%d) = %g\n',n,FVr_bestmem(n)));</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,337" id="srcline337">337</a></span><span class="line"><span class="comment">%        end</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,338" id="srcline338">338</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo " id="T18:U713"><span class="var type1" id="S28T7U1179">I_plotting</span> == <span class="mxinfo " id="T7:U715">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="66,339" id="srcline339">339</a></span><span class="line">           <span class="mxinfo " id="T70:U716"><span class="fcn" id="F224N13:B70">PlotIt</span></span>(<span class="var type1" id="S2T3U1184">FVr_bestmem</span>,<span class="var type1" id="S4T1U1185">problem</span>); </span></span>
<span class="srcline"><span class="lineno"><a href="66,340" id="srcline340">340</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,341" id="srcline341">341</a></span><span class="line">        <span class="mxinfo " id="T7:U719"><span class="var type1" id="S14T7U1188">stopflag</span> = <span class="mxinfo " id="T7:U721"><span class="fcn" id="F225N9:B1190">getStopFlag</span>()</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,342" id="srcline342">342</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="66,343" id="srcline343">343</a></span><span class="line">    <span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="66,344" id="srcline344">344</a></span><span class="line">  <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,345" id="srcline345">345</a></span><span class="line">  <span class="keyword">if</span> <span class="mxinfo " id="T18:U722"><span class="var type1" id="S14T7U1194">stopflag</span> == <span class="mxinfo " id="T7:U724">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="66,346" id="srcline346">346</a></span><span class="line">    <span class="mxinfo " id="T7:U725"><span class="var type1" id="S61T7U1198">I_iter</span> = <span class="mxinfo " id="T7:U727"><span class="var type1" id="S61T7U1200">I_iter</span> + <span class="mxinfo " id="T7:U729">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="66,347" id="srcline347">347</a></span><span class="line">  <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,348" id="srcline348">348</a></span><span class="line">      <span class="var type1" id="S61T7U1205">I_iter</span> = <span class="var type1" id="S24T7U1207">I_itermax</span> + 1;</span></span>
<span class="srcline"><span class="lineno"><a href="66,349" id="srcline349">349</a></span><span class="line">  <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="66,350" id="srcline350">350</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span> <span class="comment">%---end while ((I_iter &lt; I_itermax) <span class="keyword">...</span></span></span></span>
</pre>
