<pre class="code">
<span class="srcline"><span class="lineno"><a href="59,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T5U3">out</span> = abeles(<span class="var type1" id="S3T12U6">x</span>,<span class="var type1" id="S4T4U7">sld</span>,<span class="var type1" id="S5T2U8">nbair</span>,<span class="var type1" id="S6T2U9">nbsub</span>,<span class="var type1" id="S7T2U10">nrepeats</span>,<span class="var type1" id="S8T2U11">ssub</span>,<span class="var type1" id="S9T2U12">layers</span>,<span class="var type1" id="S10T2U13">points</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="59,2" id="srcline2"> 2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="59,3" id="srcline3"> 3</a></span><span class="line">	</span></span>
<span class="srcline"><span class="lineno"><a href="59,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">% nbair = nbairs(thisCont);</span></span></span>
<span class="srcline"><span class="lineno"><a href="59,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">% nbsub = nbsubs(thisCont);</span></span></span>
<span class="srcline"><span class="lineno"><a href="59,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">% ssub = ssubs(thisCont);</span></span></span>
<span class="srcline"><span class="lineno"><a href="59,7" id="srcline7"> 7</a></span><span class="line"><span class="comment">% nrepeats = nrepeatss(thisCont);</span></span></span>
<span class="srcline"><span class="lineno"><a href="59,8" id="srcline8"> 8</a></span><span class="line"><span class="comment">% resol = resols(thisCont);</span></span></span>
<span class="srcline"><span class="lineno"><a href="59,9" id="srcline9"> 9</a></span><span class="line"><span class="mxinfo " id="T5:U10"><span class="var type1" id="S2T5U16">out</span> = <span class="mxinfo " id="T5:U12">zeros(<span class="var type1" id="S10T2U19">points</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,10" id="srcline10">10</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="59,11" id="srcline11">11</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="59,12" id="srcline12">12</a></span><span class="line"><span class="mxinfo " id="T37:U14"><span class="var type1" id="S12T37U23">c0</span> = <span class="mxinfo " id="T37:U16">complex(<span class="mxinfo " id="T2:U17">0</span>,<span class="mxinfo " id="T2:U18">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,13" id="srcline13">13</a></span><span class="line"><span class="mxinfo " id="T37:U19"><span class="var type1" id="S14T37U30">c1</span> = <span class="mxinfo " id="T37:U21">complex(1,0)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,14" id="srcline14">14</a></span><span class="line"><span class="mxinfo " id="T37:U22"><span class="var type1" id="S15T37U37">ci</span> = <span class="mxinfo " id="T37:U24">complex(<span class="mxinfo " id="T2:U25">0</span>,<span class="mxinfo " id="T2:U26">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,15" id="srcline15">15</a></span><span class="line"><span class="mxinfo " id="T37:U27"><span class="var type1" id="S16T37U44">plast</span> = <span class="mxinfo " id="T37:U29">complex(<span class="mxinfo " id="T2:U30">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,16" id="srcline16">16</a></span><span class="line"><span class="mxinfo " id="T37:U31"><span class="var type1" id="S17T37U50">blast</span> = <span class="mxinfo " id="T37:U33">complex(<span class="mxinfo " id="T2:U34">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,17" id="srcline17">17</a></span><span class="line"><span class="mxinfo " id="T41:U35"><span class="var type1" id="S18T41U56">N</span> = <span class="mxinfo " id="T41:U37">[<span class="mxinfo " id="T44:U38"><span class="var type1" id="S12T37U59">c0</span> <span class="var type1" id="S12T37U60">c0</span></span>; <span class="mxinfo " id="T44:U41"><span class="var type1" id="S12T37U62">c0</span> <span class="var type1" id="S12T37U63">c0</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,18" id="srcline18">18</a></span><span class="line"><span class="mxinfo " id="T41:U44"><span class="var type1" id="S19T41U66">MI</span> = <span class="mxinfo " id="T41:U46">[<span class="mxinfo " id="T44:U47"><span class="var type1" id="S12T37U69">c0</span> <span class="var type1" id="S12T37U70">c0</span></span>; <span class="mxinfo " id="T44:U50"><span class="var type1" id="S12T37U72">c0</span> <span class="var type1" id="S12T37U73">c0</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,19" id="srcline19">19</a></span><span class="line"><span class="mxinfo " id="T41:U53"><span class="var type1" id="S20T41U76">M</span> = <span class="mxinfo " id="T41:U55">[<span class="mxinfo " id="T44:U56"><span class="var type1" id="S12T37U79">c0</span> <span class="var type1" id="S12T37U80">c0</span></span>; <span class="mxinfo " id="T44:U59"><span class="var type1" id="S12T37U82">c0</span> <span class="var type1" id="S12T37U83">c0</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,20" id="srcline20">20</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="59,21" id="srcline21">21</a></span><span class="line"><span class="mxinfo " id="T2:U62"><span class="var type1" id="S21T2U86">lam</span> = <span class="mxinfo " id="T2:U64">4.5</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,22" id="srcline22">22</a></span><span class="line"><span class="mxinfo " id="T2:U65"><span class="var type1" id="S22T2U90">rfac</span> = <span class="mxinfo " id="T2:U67">((4*pi)*(4*pi))/2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,23" id="srcline23">23</a></span><span class="line"><span class="mxinfo " id="T2:U68"><span class="var type1" id="S24T2U107">twopi</span> = <span class="mxinfo " id="T2:U70">2*pi</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,24" id="srcline24">24</a></span><span class="line"><span class="mxinfo " id="T2:U71"><span class="var type1" id="S25T2U114">snair</span> = (<span class="mxinfo " id="T2:U73"><span class="mxinfo " id="T2:U74">1.0</span> - (<span class="mxinfo " id="T2:U75"><span class="var type1" id="S5T2U120">nbair</span>*(<span class="mxinfo " id="T2:U77">(<span class="mxinfo " id="T2:U78"><span class="var type1" id="S21T2U125">lam</span>*<span class="var type1" id="S21T2U126">lam</span></span>) / <span class="var type1" id="S24T2U127">twopi</span></span>)</span>)</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,25" id="srcline25">25</a></span><span class="line"><span class="mxinfo " id="T2:U82"><span class="var type1" id="S26T2U130">snsub</span> = (<span class="mxinfo " id="T2:U84"><span class="mxinfo " id="T2:U85">1.0</span> - (<span class="mxinfo " id="T2:U86"><span class="var type1" id="S6T2U136">nbsub</span>*(<span class="mxinfo " id="T2:U88">(<span class="mxinfo " id="T2:U89"><span class="var type1" id="S21T2U141">lam</span>*<span class="var type1" id="S21T2U142">lam</span></span>) / <span class="var type1" id="S24T2U143">twopi</span></span>)</span>)</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,26" id="srcline26">26</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S27T2U146">loop</span> = <span class="mxinfo " id="T2:U94">1</span>:<span class="var type1" id="S10T2U149">points</span></span></span>
<span class="srcline"><span class="lineno"><a href="59,27" id="srcline27">27</a></span><span class="line">    <span class="mxinfo " id="T2:U96"><span class="var type1" id="S28T2U152">q</span> = <span class="mxinfo " id="T2:U98"><span class="var type1" id="S3T12U154">x</span>(<span class="var type1" id="S27T2U155">loop</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,28" id="srcline28">28</a></span><span class="line">    <span class="mxinfo " id="T2:U101"><span class="var type1" id="S29T2U158">theta</span> = <span class="mxinfo " id="T2:U103">asin(<span class="mxinfo " id="T2:U104"><span class="mxinfo " id="T2:U105"><span class="var type1" id="S28T2U163">q</span>*<span class="var type1" id="S21T2U164">lam</span></span> / (<span class="mxinfo " id="T2:U108">4*pi</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,29" id="srcline29">29</a></span><span class="line">    <span class="mxinfo " id="T2:U109"><span class="var type1" id="S31T2U172">preal</span> = <span class="mxinfo " id="T2:U111">(<span class="mxinfo " id="T2:U112">(<span class="var type1" id="S26T2U177">snsub</span>)*(<span class="var type1" id="S26T2U179">snsub</span>)</span>) - <span class="mxinfo " id="T2:U115">(<span class="mxinfo " id="T2:U116">(<span class="var type1" id="S25T2U184">snair</span>)*(<span class="var type1" id="S25T2U186">snair</span>)</span>)*(<span class="mxinfo " id="T2:U119"><span class="mxinfo " id="T2:U120">cos(<span class="var type1" id="S29T2U191">theta</span>)</span>^2</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,30" id="srcline30">30</a></span><span class="line">    <span class="mxinfo " id="T37:U122"><span class="var type1" id="S33T37U195">psub</span> = <span class="mxinfo " id="T37:U124">sqrt(<span class="mxinfo " id="T37:U125"><span class="var type1" id="S31T2U199">preal</span>*<span class="var type1" id="S14T37U200">c1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,31" id="srcline31">31</a></span><span class="line">    <span class="mxinfo " id="T37:U128"><span class="var type1" id="S35T37U203">pair</span> = <span class="mxinfo " id="T37:U130"><span class="mxinfo " id="T2:U131"><span class="var type1" id="S25T2U206">snair</span>*<span class="mxinfo " id="T2:U133">sin(<span class="var type1" id="S29T2U209">theta</span>)</span></span>*<span class="var type1" id="S14T37U210">c1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,32" id="srcline32">32</a></span><span class="line">    <span class="mxinfo " id="T37:U136"><span class="var type1" id="S16T37U213">plast</span> = <span class="var type1" id="S35T37U214">pair</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,33" id="srcline33">33</a></span><span class="line">    <span class="mxinfo " id="T37:U139"><span class="var type1" id="S17T37U217">blast</span> = <span class="mxinfo " id="T2:U141">0.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,34" id="srcline34">34</a></span><span class="line">    <span class="mxinfo " id="T2:U142"><span class="var type1" id="S37T2U221">rlast</span> = <span class="mxinfo " id="T2:U144"><span class="var type1" id="S4T4U223">sld</span>(<span class="mxinfo " id="T2:U146">1</span>,<span class="mxinfo " id="T2:U147">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,35" id="srcline35">35</a></span><span class="line">    <span class="mxinfo " id="T37:U148"><span class="mxinfo " id="T37:U149"><span class="var type1" id="S19T41U229">MI</span>(<span class="mxinfo " id="T2:U151">1</span>,<span class="mxinfo " id="T2:U152">1</span>)</span> = <span class="var type1" id="S14T37U232">c1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,36" id="srcline36">36</a></span><span class="line">    <span class="mxinfo " id="T37:U154"><span class="mxinfo " id="T37:U155"><span class="var type1" id="S19T41U236">MI</span>(<span class="mxinfo " id="T2:U157">2</span>,<span class="mxinfo " id="T2:U158">2</span>)</span> = <span class="var type1" id="S14T37U239">c1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,37" id="srcline37">37</a></span><span class="line">    <span class="mxinfo " id="T37:U160"><span class="mxinfo " id="T37:U161"><span class="var type1" id="S19T41U243">MI</span>(<span class="mxinfo " id="T2:U163">1</span>,<span class="mxinfo " id="T2:U164">2</span>)</span> = <span class="var type1" id="S12T37U246">c0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,38" id="srcline38">38</a></span><span class="line">    <span class="mxinfo " id="T37:U166"><span class="mxinfo " id="T37:U167"><span class="var type1" id="S19T41U250">MI</span>(<span class="mxinfo " id="T2:U169">2</span>,<span class="mxinfo " id="T2:U170">1</span>)</span> = <span class="var type1" id="S12T37U253">c0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,39" id="srcline39">39</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S38T2U256">reploop</span> = <span class="mxinfo " id="T2:U173">1</span>:<span class="var type1" id="S7T2U259">nrepeats</span></span></span>
<span class="srcline"><span class="lineno"><a href="59,40" id="srcline40">40</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S39T2U262">nl</span> = <span class="mxinfo " id="T2:U176">1</span>:<span class="var type1" id="S9T2U265">layers</span></span></span>
<span class="srcline"><span class="lineno"><a href="59,41" id="srcline41">41</a></span><span class="line">            <span class="mxinfo " id="T2:U178"><span class="var type1" id="S40T2U268">thick</span> = <span class="mxinfo " id="T2:U180"><span class="var type1" id="S4T4U270">sld</span>(<span class="var type1" id="S39T2U271">nl</span>,<span class="mxinfo " id="T7:U183">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,42" id="srcline42">42</a></span><span class="line">            <span class="mxinfo " id="T2:U184"><span class="var type1" id="S41T2U275">rho</span> = <span class="mxinfo " id="T2:U186"><span class="var type1" id="S4T4U277">sld</span>(<span class="var type1" id="S39T2U278">nl</span>,<span class="mxinfo " id="T7:U189">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,43" id="srcline43">43</a></span><span class="line">            <span class="mxinfo " id="T2:U190"><span class="var type1" id="S42T2U282">rough</span> = <span class="mxinfo " id="T2:U192"><span class="var type1" id="S4T4U284">sld</span>(<span class="var type1" id="S39T2U285">nl</span>,<span class="mxinfo " id="T7:U195">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,44" id="srcline44">44</a></span><span class="line">            <span class="mxinfo " id="T2:U196"><span class="var type1" id="S43T2U289">snlay</span> = (<span class="mxinfo " id="T2:U198"><span class="mxinfo " id="T2:U199">1</span> - (<span class="mxinfo " id="T2:U200"><span class="var type1" id="S41T2U295">rho</span>*(<span class="mxinfo " id="T2:U202">(<span class="mxinfo " id="T2:U203"><span class="var type1" id="S21T2U300">lam</span>*<span class="var type1" id="S21T2U301">lam</span></span>) / <span class="var type1" id="S24T2U302">twopi</span></span>)</span>)</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,45" id="srcline45">45</a></span><span class="line">            <span class="mxinfo " id="T2:U207"><span class="var type1" id="S31T2U305">preal</span> = <span class="mxinfo " id="T2:U209">(<span class="mxinfo " id="T2:U210"><span class="var type1" id="S43T2U309">snlay</span>*<span class="var type1" id="S43T2U310">snlay</span></span>) - <span class="mxinfo " id="T2:U213">(<span class="mxinfo " id="T2:U214"><span class="var type1" id="S25T2U314">snair</span>*<span class="var type1" id="S25T2U315">snair</span></span>) *<span class="mxinfo " id="T2:U217"><span class="mxinfo " id="T2:U218">cos(<span class="var type1" id="S29T2U319">theta</span>)</span>^2</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,46" id="srcline46">46</a></span><span class="line">            <span class="mxinfo " id="T37:U220"><span class="var type1" id="S44T37U323">pimag</span> = <span class="mxinfo " id="T37:U222">sqrt(<span class="mxinfo " id="T37:U223"><span class="var type1" id="S31T2U327">preal</span>*<span class="var type1" id="S14T37U328">c1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,47" id="srcline47">47</a></span><span class="line">            <span class="mxinfo " id="T37:U226"><span class="var type1" id="S45T37U331">beta</span> = <span class="mxinfo " id="T37:U228"><span class="mxinfo " id="T2:U229">(<span class="mxinfo " id="T2:U230"><span class="var type1" id="S24T2U336">twopi</span> / <span class="var type1" id="S21T2U337">lam</span></span>)*<span class="var type1" id="S40T2U338">thick</span></span>*<span class="var type1" id="S44T37U339">pimag</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,48" id="srcline48">48</a></span><span class="line">            <span class="mxinfo " id="T37:U235"><span class="var type1" id="S46T37U342">rij</span> = <span class="mxinfo " id="T37:U237">complex(<span class="mxinfo " id="T37:U238"><span class="var type1" id="S16T37U347">plast</span> - <span class="var type1" id="S44T37U348">pimag</span></span>) / complex(<span class="mxinfo " id="T37:U241"><span class="var type1" id="S16T37U352">plast</span> + <span class="var type1" id="S44T37U353">pimag</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,49" id="srcline49">49</a></span><span class="line">            <span class="mxinfo " id="T37:U244"><span class="var type1" id="S46T37U356">rij</span> = <span class="mxinfo " id="T37:U246"><span class="var type1" id="S46T37U358">rij</span> * <span class="mxinfo " id="T37:U248">exp(<span class="mxinfo " id="T37:U249"><span class="mxinfo " id="T37:U250"><span class="mxinfo " id="T37:U251"><span class="mxinfo " id="T37:U252"><span class="mxinfo " id="T2:U253">-<span class="var type1" id="S22T2U366">rfac</span></span>*<span class="var type1" id="S16T37U367">plast</span></span>*<span class="var type1" id="S44T37U368">pimag</span></span>*(<span class="mxinfo " id="T2:U257"><span class="var type1" id="S42T2U371">rough</span>*<span class="var type1" id="S42T2U372">rough</span></span>)</span>/(<span class="var type1" id="S21T2U375">lam</span>*<span class="var type1" id="S21T2U376">lam</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,50" id="srcline50">50</a></span><span class="line">            <span class="mxinfo " id="T37:U262"><span class="mxinfo " id="T37:U263"><span class="var type1" id="S18T41U380">N</span>(<span class="mxinfo " id="T7:U265">1</span> , <span class="mxinfo " id="T7:U266">1</span>)</span> = <span class="mxinfo " id="T37:U267">exp(<span class="mxinfo " id="T37:U268"><span class="var type1" id="S17T37U386">blast</span>*<span class="var type1" id="S15T37U387">ci</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,51" id="srcline51">51</a></span><span class="line">            <span class="mxinfo " id="T37:U271"><span class="mxinfo " id="T37:U272"><span class="var type1" id="S18T41U391">N</span>(<span class="mxinfo " id="T7:U274">2</span> , <span class="mxinfo " id="T7:U275">1</span>)</span> = <span class="mxinfo " id="T37:U276"><span class="var type1" id="S46T37U395">rij</span> * <span class="mxinfo " id="T37:U278">exp( <span class="mxinfo " id="T37:U279"><span class="mxinfo " id="T37:U280">- <span class="var type1" id="S17T37U400">blast</span></span>*<span class="var type1" id="S15T37U401">ci</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,52" id="srcline52">52</a></span><span class="line">            <span class="mxinfo " id="T37:U283"><span class="mxinfo " id="T37:U284"><span class="var type1" id="S18T41U405">N</span>(<span class="mxinfo " id="T7:U286">2</span> , <span class="mxinfo " id="T7:U287">2</span>)</span> = <span class="mxinfo " id="T37:U288">exp( <span class="mxinfo " id="T37:U289"><span class="mxinfo " id="T37:U290">- <span class="var type1" id="S17T37U412">blast</span></span>*<span class="var type1" id="S15T37U413">ci</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,53" id="srcline53">53</a></span><span class="line">            <span class="mxinfo " id="T37:U293"><span class="mxinfo " id="T37:U294"><span class="var type1" id="S18T41U417">N</span>(<span class="mxinfo " id="T7:U296">1</span> , <span class="mxinfo " id="T7:U297">2</span>)</span> = <span class="mxinfo " id="T37:U298"><span class="var type1" id="S46T37U421">rij</span> * <span class="mxinfo " id="T37:U300">exp(<span class="mxinfo " id="T37:U301"><span class="var type1" id="S17T37U425">blast</span>*<span class="var type1" id="S15T37U426">ci</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,54" id="srcline54">54</a></span><span class="line">            <span class="mxinfo " id="T37:U304"><span class="var type1" id="S16T37U429">plast</span> = <span class="var type1" id="S44T37U430">pimag</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,55" id="srcline55">55</a></span><span class="line">            <span class="mxinfo " id="T37:U307"><span class="var type1" id="S17T37U433">blast</span> = <span class="var type1" id="S45T37U434">beta</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,56" id="srcline56">56</a></span><span class="line">            <span class="mxinfo " id="T41:U310"><span class="var type1" id="S20T41U437">M</span> = <span class="var type1" id="S19T41U438">MI</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,57" id="srcline57">57</a></span><span class="line">            <span class="mxinfo " id="T41:U313"><span class="var type1" id="S19T41U441">MI</span> = <span class="mxinfo " id="T41:U315"><span class="var type1" id="S20T41U443">M</span> * <span class="var type1" id="S18T41U444">N</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,58" id="srcline58">58</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="59,59" id="srcline59">59</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="59,60" id="srcline60">60</a></span><span class="line">    <span class="mxinfo " id="T37:U318"><span class="var type1" id="S46T37U447">rij</span> = <span class="mxinfo " id="T37:U320">(complex(<span class="mxinfo " id="T37:U321"><span class="var type1" id="S16T37U453">plast</span> - <span class="var type1" id="S33T37U454">psub</span></span>)) / (complex(<span class="mxinfo " id="T37:U324"><span class="var type1" id="S16T37U459">plast</span> + <span class="var type1" id="S33T37U460">psub</span></span>))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,61" id="srcline61">61</a></span><span class="line">    <span class="mxinfo " id="T37:U327"><span class="var type1" id="S46T37U463">rij</span> = <span class="mxinfo " id="T37:U329"><span class="var type1" id="S46T37U465">rij</span> * <span class="mxinfo " id="T37:U331">exp(<span class="mxinfo " id="T37:U332"><span class="mxinfo " id="T37:U333"><span class="mxinfo " id="T37:U334"><span class="mxinfo " id="T37:U335"><span class="mxinfo " id="T2:U336">-<span class="var type1" id="S22T2U473">rfac</span></span>*<span class="var type1" id="S16T37U474">plast</span></span>*<span class="var type1" id="S33T37U475">psub</span></span>*(<span class="mxinfo " id="T2:U340"><span class="var type1" id="S8T2U478">ssub</span>*<span class="var type1" id="S8T2U479">ssub</span></span>)</span>/(<span class="var type1" id="S21T2U482">lam</span>*<span class="var type1" id="S21T2U483">lam</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,62" id="srcline62">62</a></span><span class="line">    <span class="mxinfo " id="T37:U345"><span class="mxinfo " id="T37:U346"><span class="var type1" id="S18T41U487">N</span>(<span class="mxinfo " id="T7:U348">1</span>,<span class="mxinfo " id="T7:U349">1</span>)</span> = <span class="mxinfo " id="T37:U350">exp(<span class="mxinfo " id="T37:U351"><span class="var type1" id="S17T37U493">blast</span>*<span class="var type1" id="S15T37U494">ci</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,63" id="srcline63">63</a></span><span class="line">    <span class="mxinfo " id="T37:U354"><span class="mxinfo " id="T37:U355"><span class="var type1" id="S18T41U498">N</span>(<span class="mxinfo " id="T7:U357">2</span>,<span class="mxinfo " id="T7:U358">1</span>)</span> = <span class="mxinfo " id="T37:U359"><span class="var type1" id="S46T37U502">rij</span>*<span class="mxinfo " id="T37:U361">exp( <span class="mxinfo " id="T37:U362"><span class="mxinfo " id="T37:U363">- <span class="var type1" id="S17T37U507">blast</span></span>*<span class="var type1" id="S15T37U508">ci</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,64" id="srcline64">64</a></span><span class="line">    <span class="mxinfo " id="T37:U366"><span class="mxinfo " id="T37:U367"><span class="var type1" id="S18T41U512">N</span>(<span class="mxinfo " id="T7:U369">2</span>,<span class="mxinfo " id="T7:U370">2</span>)</span> = <span class="mxinfo " id="T37:U371">exp( <span class="mxinfo " id="T37:U372"><span class="mxinfo " id="T37:U373">- <span class="var type1" id="S17T37U519">blast</span></span>*<span class="var type1" id="S15T37U520">ci</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,65" id="srcline65">65</a></span><span class="line">    <span class="mxinfo " id="T37:U376"><span class="mxinfo " id="T37:U377"><span class="var type1" id="S18T41U524">N</span>(<span class="mxinfo " id="T7:U379">1</span>,<span class="mxinfo " id="T7:U380">2</span>)</span> = <span class="mxinfo " id="T37:U381"><span class="var type1" id="S46T37U528">rij</span>*<span class="mxinfo " id="T37:U383">exp(<span class="mxinfo " id="T37:U384"><span class="var type1" id="S17T37U532">blast</span>*<span class="var type1" id="S15T37U533">ci</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,66" id="srcline66">66</a></span><span class="line">    <span class="mxinfo " id="T41:U387"><span class="var type1" id="S20T41U536">M</span> = <span class="var type1" id="S19T41U537">MI</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,67" id="srcline67">67</a></span><span class="line">    <span class="mxinfo " id="T41:U390"><span class="var type1" id="S19T41U540">MI</span> = <span class="mxinfo " id="T41:U392"><span class="var type1" id="S20T41U542">M</span> * <span class="var type1" id="S18T41U543">N</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,68" id="srcline68">68</a></span><span class="line">    <span class="mxinfo " id="T37:U395"><span class="var type1" id="S48T37U546">num</span> = <span class="mxinfo " id="T37:U397"><span class="mxinfo " id="T37:U398"><span class="var type1" id="S19T41U549">MI</span>(<span class="mxinfo " id="T7:U400">2</span> , <span class="mxinfo " id="T7:U401">1</span>)</span>*<span class="mxinfo " id="T37:U402">conj(<span class="mxinfo " id="T37:U403"><span class="var type1" id="S19T41U555">MI</span>(<span class="mxinfo " id="T2:U405">2</span> , <span class="mxinfo " id="T2:U406">1</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,69" id="srcline69">69</a></span><span class="line">    <span class="mxinfo " id="T37:U407"><span class="var type1" id="S50T37U560">den</span> = <span class="mxinfo " id="T37:U409"><span class="mxinfo " id="T37:U410"><span class="var type1" id="S19T41U563">MI</span>(<span class="mxinfo " id="T7:U412">1</span> , <span class="mxinfo " id="T7:U413">1</span>)</span>*<span class="mxinfo " id="T37:U414">conj(<span class="mxinfo " id="T37:U415"><span class="var type1" id="S19T41U569">MI</span>(<span class="mxinfo " id="T2:U417">1</span> , <span class="mxinfo " id="T2:U418">1</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,70" id="srcline70">70</a></span><span class="line">    <span class="mxinfo " id="T37:U419"><span class="var type1" id="S51T37U574">quo</span> = <span class="mxinfo " id="T37:U421"><span class="var type1" id="S48T37U576">num</span>/<span class="var type1" id="S50T37U577">den</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,71" id="srcline71">71</a></span><span class="line">    <span class="mxinfo " id="T2:U424"><span class="mxinfo " id="T2:U425"><span class="var type1" id="S2T5U581">out</span>(<span class="var type1" id="S27T2U582">loop</span>)</span> = <span class="mxinfo " id="T2:U428">real(<span class="var type1" id="S51T37U585">quo</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="59,72" id="srcline72">72</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="59,73" id="srcline73">73</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="59,74" id="srcline74">74</a></span><span class="line"><span class="keyword">return</span></span></span>
<span class="srcline"><span class="lineno"><a href="59,75" id="srcline75">75</a></span><span class="line"><span class="keyword">end</span> </span></span>
</pre>
