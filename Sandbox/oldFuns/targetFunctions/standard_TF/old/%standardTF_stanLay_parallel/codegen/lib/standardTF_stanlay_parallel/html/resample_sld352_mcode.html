<pre class="code">
<span class="srcline"><span class="lineno"><a href="81,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">x_new_tot</span>,<span class="var type1" id="S3T1U4">y_new_tot</span>] = resample_sld(<span class="var type1" id="S4T3U7">sld</span>,<span class="var type2" id="S5T11V2U8">y_min_step</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="81,2" id="srcline2"> 2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="81,3" id="srcline3"> 3</a></span><span class="line"><span class="mxinfo " id="T1:U5"><span class="var type1" id="S6T1U11">x</span> = <span class="mxinfo " id="T1:U7"><span class="var type1" id="S4T3U13">sld</span>(<span class="mxinfo " id="T85:U9">:</span>,<span class="mxinfo " id="T29:U10">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,4" id="srcline4"> 4</a></span><span class="line"><span class="mxinfo " id="T1:U11"><span class="var type1" id="S7T1U18">prof</span> = <span class="mxinfo " id="T1:U13"><span class="var type1" id="S4T3U20">sld</span>(<span class="mxinfo " id="T85:U15">:</span>,<span class="mxinfo " id="T29:U16">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,5" id="srcline5"> 5</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="81,6" id="srcline6"> 6</a></span><span class="line"><span class="mxinfo " id="T98:U17"><span class="var type1" id="S8T98U25">x_new</span> = <span class="mxinfo " id="T109:U19">zeros(<span class="mxinfo " id="T11:U20">1e4</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,7" id="srcline7"> 7</a></span><span class="line"><span class="mxinfo " id="T98:U21"><span class="var type1" id="S10T98U32">y_new</span> = <span class="mxinfo " id="T109:U23">zeros(<span class="mxinfo " id="T11:U24">1e4</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,8" id="srcline8"> 8</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="81,9" id="srcline9"> 9</a></span><span class="line"><span class="mxinfo " id="T11:U25"><span class="var type1" id="S11T11U39">thisx</span> = <span class="mxinfo " id="T11:U27"><span class="var type1" id="S6T1U41">x</span>(<span class="mxinfo " id="T11:U29">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,10" id="srcline10">10</a></span><span class="line"><span class="mxinfo " id="T11:U30"><span class="var type1" id="S12T11U45">count</span> = <span class="mxinfo " id="T11:U32">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,11" id="srcline11">11</a></span><span class="line"><span class="mxinfo " id="T11:U33"><span class="var type1" id="S13T11U49">i</span> = <span class="mxinfo " id="T11:U35">2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,12" id="srcline12">12</a></span><span class="line"><span class="keyword">while</span> <span class="mxinfo " id="T27:U36"><span class="var type1" id="S13T11U53">i</span> &lt; <span class="mxinfo " id="T11:U38">length(<span class="var type1" id="S6T1U56">x</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="81,13" id="srcline13">13</a></span><span class="line">    <span class="mxinfo " id="T11:U40"><span class="var type1" id="S15T11U59">this_step</span> = <span class="mxinfo " id="T11:U42"><span class="mxinfo " id="T11:U43"><span class="var type1" id="S7T1U62">prof</span>(<span class="var type1" id="S13T11U63">i</span>)</span> - <span class="mxinfo " id="T11:U46"><span class="var type1" id="S7T1U65">prof</span>(<span class="mxinfo " id="T11:U48"><span class="var type1" id="S13T11U67">i</span>-<span class="mxinfo " id="T11:U50">1</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,14" id="srcline14">14</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T27:U51"><span class="mxinfo " id="T11:U52">abs(<span class="var type1" id="S15T11U74">this_step</span>)</span> &lt; <span class="var type1" id="S5T11U75">y_min_step</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="81,15" id="srcline15">15</a></span><span class="line">        <span class="comment">%Keep original points</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,16" id="srcline16">16</a></span><span class="line">        <span class="mxinfo " id="T11:U55"><span class="mxinfo " id="T11:U56"><span class="var type1" id="S8T98U79">x_new</span>(<span class="var type1" id="S12T11U80">count</span>)</span> = <span class="mxinfo " id="T11:U59"><span class="var type1" id="S6T1U82">x</span>(<span class="var type1" id="S13T11U83">i</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,17" id="srcline17">17</a></span><span class="line">        <span class="mxinfo " id="T11:U62"><span class="mxinfo " id="T11:U63"><span class="var type1" id="S10T98U87">y_new</span>(<span class="var type1" id="S12T11U88">count</span>)</span> = <span class="mxinfo " id="T11:U66"><span class="var type1" id="S7T1U90">prof</span>(<span class="var type1" id="S13T11U91">i</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,18" id="srcline18">18</a></span><span class="line">        <span class="mxinfo " id="T11:U69"><span class="var type1" id="S12T11U94">count</span> = <span class="mxinfo " id="T11:U71"><span class="var type1" id="S12T11U96">count</span> + <span class="mxinfo " id="T11:U73">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,19" id="srcline19">19</a></span><span class="line">        <span class="mxinfo " id="T11:U74"><span class="var type1" id="S13T11U100">i</span> = <span class="mxinfo " id="T11:U76"><span class="var type1" id="S13T11U102">i</span> + <span class="mxinfo " id="T11:U78">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,20" id="srcline20">20</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,21" id="srcline21">21</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo " id="T27:U79"><span class="var type1" id="S15T11U108">this_step</span> &gt; <span class="mxinfo " id="T11:U81">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="81,22" id="srcline22">22</a></span><span class="line">            <span class="mxinfo " id="T13:U82"><span class="var type1" id="S17T13U112">newsteps</span> = <span class="mxinfo " id="T13:U84"><span class="mxinfo " id="T11:U85"><span class="var type1" id="S7T1U116">prof</span>(<span class="mxinfo " id="T11:U87"><span class="var type1" id="S13T11U118">i</span>-<span class="mxinfo " id="T11:U89">1</span></span>)</span>:<span class="var type1" id="S5T11U120">y_min_step</span>:<span class="mxinfo " id="T11:U91"><span class="var type1" id="S7T1U122">prof</span>(<span class="var type1" id="S13T11U123">i</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,23" id="srcline23">23</a></span><span class="line">        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,24" id="srcline24">24</a></span><span class="line">            <span class="mxinfo " id="T13:U94"><span class="var type1" id="S17T13U127">newsteps</span> = <span class="mxinfo " id="T13:U96"><span class="mxinfo " id="T11:U97"><span class="var type1" id="S7T1U131">prof</span>(<span class="mxinfo " id="T11:U99"><span class="var type1" id="S13T11U133">i</span>-<span class="mxinfo " id="T11:U101">1</span></span>)</span>:-<span class="var type1" id="S5T11U136">y_min_step</span>:<span class="mxinfo " id="T11:U103"><span class="var type1" id="S7T1U138">prof</span>(<span class="var type1" id="S13T11U139">i</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,25" id="srcline25">25</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,26" id="srcline26">26</a></span><span class="line">        <span class="mxinfo " id="T13:U106"><span class="var type1" id="S18T13U142">new_xs</span> = <span class="mxinfo " id="T13:U108">interp1(<span class="mxinfo " id="T93:U109"><span class="var type1" id="S7T1U146">prof</span>(<span class="mxinfo " id="T93:U111"><span class="mxinfo " id="T11:U112"><span class="var type1" id="S13T11U149">i</span>-1</span>:<span class="var type1" id="S13T11U151">i</span></span>)</span>,<span class="mxinfo " id="T93:U115"><span class="var type1" id="S6T1U153">x</span>(<span class="mxinfo " id="T93:U117"><span class="mxinfo " id="T11:U118"><span class="var type1" id="S13T11U156">i</span>-1</span>:<span class="var type1" id="S13T11U158">i</span></span>)</span>,<span class="var type1" id="S17T13U159">newsteps</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,27" id="srcline27">27</a></span><span class="line">        <span class="mxinfo " id="T98:U122"><span class="var type1" id="S8T98U162">x_new</span> = <span class="mxinfo " id="T98:U124">[<span class="var type1" id="S8T98U165">x_new</span> <span class="var type1" id="S18T13U166">new_xs</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,28" id="srcline28">28</a></span><span class="line">        <span class="mxinfo " id="T98:U127"><span class="var type1" id="S10T98U169">y_new</span> = <span class="mxinfo " id="T98:U129">[<span class="var type1" id="S10T98U172">y_new</span> <span class="var type1" id="S17T13U173">newsteps</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,29" id="srcline29">29</a></span><span class="line">        <span class="mxinfo " id="T11:U132"><span class="var type1" id="S12T11U176">count</span> = <span class="mxinfo " id="T11:U134">length(<span class="var type1" id="S8T98U179">x_new</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,30" id="srcline30">30</a></span><span class="line">        <span class="mxinfo " id="T11:U136"><span class="var type1" id="S13T11U182">i</span> = <span class="mxinfo " id="T11:U138"><span class="var type1" id="S13T11U184">i</span> + <span class="mxinfo " id="T11:U140">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,31" id="srcline31">31</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,32" id="srcline32">32</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,33" id="srcline33">33</a></span><span class="line"><span class="comment">%x_new_tot = x_new(:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,34" id="srcline34">34</a></span><span class="line"><span class="comment">%y_new_tot = y_new(:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,35" id="srcline35">35</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="81,36" id="srcline36">36</a></span><span class="line"><span class="mxinfo " id="T110:U141"><span class="var type1" id="S8T110U188">x_new</span> = <span class="mxinfo " id="T110:U143"><span class="var type1" id="S8T98U190">x_new</span>(<span class="mxinfo " id="T111:U145"><span class="mxinfo " id="T11:U146">1</span>:<span class="var type1" id="S12T11U193">count</span></span>,<span class="mxinfo " id="T11:U148">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,37" id="srcline37">37</a></span><span class="line"><span class="mxinfo " id="T110:U149"><span class="var type1" id="S10T110U197">y_new</span> = <span class="mxinfo " id="T110:U151"><span class="var type1" id="S10T98U199">y_new</span>(<span class="mxinfo " id="T111:U153"><span class="mxinfo " id="T11:U154">1</span>:<span class="var type1" id="S12T11U202">count</span></span>,<span class="mxinfo " id="T11:U156">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,38" id="srcline38">38</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="81,39" id="srcline39">39</a></span><span class="line"><span class="comment">%Make it into a 'histogram'</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,40" id="srcline40">40</a></span><span class="line"><span class="mxinfo " id="T1:U157"><span class="var type1" id="S2T1U206">x_new_tot</span> = <span class="mxinfo " id="T1:U159">zeros(<span class="var type1" id="S12T11U209">count</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,41" id="srcline41">41</a></span><span class="line"><span class="mxinfo " id="T1:U161"><span class="var type1" id="S3T1U213">y_new_tot</span> = <span class="mxinfo " id="T1:U163">zeros(<span class="var type1" id="S12T11U216">count</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,42" id="srcline42">42</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S13T11U220">i</span> =<span class="mxinfo " id="T11:U166">1</span>:<span class="mxinfo " id="T11:U167"><span class="mxinfo " id="T11:U168">length(<span class="var type1" id="S8T110U226">x_new</span>)</span>-<span class="mxinfo " id="T11:U170">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,43" id="srcline43">43</a></span><span class="line">    <span class="mxinfo " id="T11:U171"><span class="mxinfo " id="T11:U172"><span class="var type1" id="S2T1U231">x_new_tot</span>(<span class="var type1" id="S13T11U232">i</span>)</span> = <span class="mxinfo " id="T11:U175"><span class="mxinfo " id="T11:U176"><span class="var type1" id="S8T110U235">x_new</span>(<span class="mxinfo " id="T11:U178"><span class="var type1" id="S13T11U237">i</span> + <span class="mxinfo " id="T11:U180">1</span></span>)</span> - <span class="mxinfo " id="T11:U181"><span class="var type1" id="S8T110U240">x_new</span>(<span class="var type1" id="S13T11U241">i</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,44" id="srcline44">44</a></span><span class="line">    <span class="mxinfo " id="T11:U184"><span class="mxinfo " id="T11:U185"><span class="var type1" id="S3T1U245">y_new_tot</span>(<span class="var type1" id="S13T11U246">i</span>)</span> = <span class="mxinfo " id="T11:U188"><span class="var type1" id="S10T110U248">y_new</span>(<span class="var type1" id="S13T11U249">i</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,45" id="srcline45">45</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,46" id="srcline46">46</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="81,47" id="srcline47">47</a></span><span class="line"><span class="comment">%Remove any zero thickness layers<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="81,48" id="srcline48">48</a></span><span class="line"><span class="mxinfo " id="T1:U191"><span class="var type1" id="S20T1U252">good_layers</span> = <span class="mxinfo " id="T1:U193">find(<span class="mxinfo " id="T102:U194"><span class="var type1" id="S2T1U256">x_new_tot</span> ~= <span class="mxinfo " id="T11:U196">0</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,49" id="srcline49">49</a></span><span class="line"><span class="mxinfo " id="T1:U197"><span class="var type1" id="S2T1U260">x_new_tot</span> = <span class="mxinfo " id="T1:U199"><span class="var type1" id="S2T1U262">x_new_tot</span>(<span class="var type1" id="S20T1U263">good_layers</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,50" id="srcline50">50</a></span><span class="line"><span class="mxinfo " id="T1:U202"><span class="var type1" id="S3T1U266">y_new_tot</span> = <span class="mxinfo " id="T1:U204"><span class="var type1" id="S3T1U268">y_new_tot</span>(<span class="var type1" id="S20T1U269">good_layers</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,51" id="srcline51">51</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="81,52" id="srcline52">52</a></span><span class="line"></span></span>
</pre>
