<pre class="code">
<span class="srcline"><span class="lineno"><a href="101,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T1U3">out</span> = abeles(<span class="var type1" id="S3T13U6">x</span>,<span class="var type1" id="S4T6U7">sld</span>,<span class="var type1" id="S5T11U8">nbair</span>,<span class="var type1" id="S6T11U9">nbsub</span>,<span class="var type1" id="S7T11U10">nrepeats</span>,<span class="var type1" id="S8T11U11">ssub</span>,<span class="var type1" id="S9T11U12">layers</span>,<span class="var type1" id="S10T11U13">points</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="101,2" id="srcline2"> 2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="101,3" id="srcline3"> 3</a></span><span class="line">	</span></span>
<span class="srcline"><span class="lineno"><a href="101,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">% nbair = nbairs(thisCont);</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">% nbsub = nbsubs(thisCont);</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">% ssub = ssubs(thisCont);</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,7" id="srcline7"> 7</a></span><span class="line"><span class="comment">% nrepeats = nrepeatss(thisCont);</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,8" id="srcline8"> 8</a></span><span class="line"><span class="comment">% resol = resols(thisCont);</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,9" id="srcline9"> 9</a></span><span class="line"><span class="mxinfo " id="T1:U10"><span class="var type1" id="S2T1U16">out</span> = <span class="mxinfo " id="T1:U12">zeros(<span class="var type1" id="S10T11U19">points</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,10" id="srcline10">10</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="101,11" id="srcline11">11</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="101,12" id="srcline12">12</a></span><span class="line"><span class="mxinfo " id="T111:U14"><span class="var type1" id="S12T111U23">c0</span> = <span class="mxinfo " id="T111:U16">complex(<span class="mxinfo " id="T11:U17">0</span>,<span class="mxinfo " id="T11:U18">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,13" id="srcline13">13</a></span><span class="line"><span class="mxinfo " id="T111:U19"><span class="var type1" id="S14T111U30">c1</span> = <span class="mxinfo " id="T111:U21">complex(1,0)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,14" id="srcline14">14</a></span><span class="line"><span class="mxinfo " id="T111:U22"><span class="var type1" id="S15T111U37">ci</span> = <span class="mxinfo " id="T111:U24">complex(<span class="mxinfo " id="T11:U25">0</span>,<span class="mxinfo " id="T11:U26">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,15" id="srcline15">15</a></span><span class="line"><span class="mxinfo " id="T111:U27"><span class="var type1" id="S16T111U44">plast</span> = <span class="mxinfo " id="T111:U29">complex(<span class="mxinfo " id="T11:U30">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,16" id="srcline16">16</a></span><span class="line"><span class="mxinfo " id="T111:U31"><span class="var type1" id="S17T111U50">blast</span> = <span class="mxinfo " id="T111:U33">complex(<span class="mxinfo " id="T11:U34">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,17" id="srcline17">17</a></span><span class="line"><span class="mxinfo " id="T113:U35"><span class="var type1" id="S18T113U56">N</span> = <span class="mxinfo " id="T113:U37">[<span class="mxinfo " id="T114:U38"><span class="var type1" id="S12T111U59">c0</span> <span class="var type1" id="S12T111U60">c0</span></span>; <span class="mxinfo " id="T114:U41"><span class="var type1" id="S12T111U62">c0</span> <span class="var type1" id="S12T111U63">c0</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,18" id="srcline18">18</a></span><span class="line"><span class="mxinfo " id="T113:U44"><span class="var type1" id="S19T113U66">MI</span> = <span class="mxinfo " id="T113:U46">[<span class="mxinfo " id="T114:U47"><span class="var type1" id="S12T111U69">c0</span> <span class="var type1" id="S12T111U70">c0</span></span>; <span class="mxinfo " id="T114:U50"><span class="var type1" id="S12T111U72">c0</span> <span class="var type1" id="S12T111U73">c0</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,19" id="srcline19">19</a></span><span class="line"><span class="mxinfo " id="T113:U53"><span class="var type1" id="S20T113U76">M</span> = <span class="mxinfo " id="T113:U55">[<span class="mxinfo " id="T114:U56"><span class="var type1" id="S12T111U79">c0</span> <span class="var type1" id="S12T111U80">c0</span></span>; <span class="mxinfo " id="T114:U59"><span class="var type1" id="S12T111U82">c0</span> <span class="var type1" id="S12T111U83">c0</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,20" id="srcline20">20</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="101,21" id="srcline21">21</a></span><span class="line"><span class="mxinfo " id="T11:U62"><span class="var type1" id="S21T11U86">lam</span> = <span class="mxinfo " id="T11:U64">4.5</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,22" id="srcline22">22</a></span><span class="line"><span class="mxinfo " id="T11:U65"><span class="var type1" id="S22T11U90">rfac</span> = <span class="mxinfo " id="T11:U67">((4*pi)*(4*pi))/2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,23" id="srcline23">23</a></span><span class="line"><span class="mxinfo " id="T11:U68"><span class="var type1" id="S24T11U107">twopi</span> = <span class="mxinfo " id="T11:U70">2*pi</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,24" id="srcline24">24</a></span><span class="line"><span class="mxinfo " id="T11:U71"><span class="var type1" id="S25T11U114">snair</span> = (<span class="mxinfo " id="T11:U73"><span class="mxinfo " id="T11:U74">1.0</span> - (<span class="mxinfo " id="T11:U75"><span class="var type1" id="S5T11U120">nbair</span>*(<span class="mxinfo " id="T11:U77">(<span class="mxinfo " id="T11:U78"><span class="var type1" id="S21T11U125">lam</span>*<span class="var type1" id="S21T11U126">lam</span></span>) / <span class="var type1" id="S24T11U127">twopi</span></span>)</span>)</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,25" id="srcline25">25</a></span><span class="line"><span class="mxinfo " id="T11:U82"><span class="var type1" id="S26T11U130">snsub</span> = (<span class="mxinfo " id="T11:U84"><span class="mxinfo " id="T11:U85">1.0</span> - (<span class="mxinfo " id="T11:U86"><span class="var type1" id="S6T11U136">nbsub</span>*(<span class="mxinfo " id="T11:U88">(<span class="mxinfo " id="T11:U89"><span class="var type1" id="S21T11U141">lam</span>*<span class="var type1" id="S21T11U142">lam</span></span>) / <span class="var type1" id="S24T11U143">twopi</span></span>)</span>)</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,26" id="srcline26">26</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S27T11U146">loop</span> = <span class="mxinfo " id="T11:U94">1</span>:<span class="var type1" id="S10T11U149">points</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,27" id="srcline27">27</a></span><span class="line">    <span class="mxinfo " id="T11:U96"><span class="var type1" id="S28T11U152">q</span> = <span class="mxinfo " id="T11:U98"><span class="var type1" id="S3T13U154">x</span>(<span class="var type1" id="S27T11U155">loop</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,28" id="srcline28">28</a></span><span class="line">    <span class="mxinfo " id="T11:U101"><span class="var type1" id="S29T11U158">theta</span> = <span class="mxinfo " id="T11:U103">asin(<span class="mxinfo " id="T11:U104"><span class="mxinfo " id="T11:U105"><span class="var type1" id="S28T11U163">q</span>*<span class="var type1" id="S21T11U164">lam</span></span> / (<span class="mxinfo " id="T11:U108">4*pi</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,29" id="srcline29">29</a></span><span class="line">    <span class="mxinfo " id="T11:U109"><span class="var type1" id="S31T11U172">preal</span> = <span class="mxinfo " id="T11:U111">(<span class="mxinfo " id="T11:U112">(<span class="var type1" id="S26T11U177">snsub</span>)*(<span class="var type1" id="S26T11U179">snsub</span>)</span>) - <span class="mxinfo " id="T11:U115">(<span class="mxinfo " id="T11:U116">(<span class="var type1" id="S25T11U184">snair</span>)*(<span class="var type1" id="S25T11U186">snair</span>)</span>)*(<span class="mxinfo " id="T11:U119"><span class="mxinfo " id="T11:U120">cos(<span class="var type1" id="S29T11U191">theta</span>)</span>^2</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,30" id="srcline30">30</a></span><span class="line">    <span class="mxinfo " id="T111:U122"><span class="var type1" id="S33T111U195">psub</span> = <span class="mxinfo " id="T111:U124">sqrt(<span class="mxinfo " id="T111:U125"><span class="var type1" id="S31T11U199">preal</span>*<span class="var type1" id="S14T111U200">c1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,31" id="srcline31">31</a></span><span class="line">    <span class="mxinfo " id="T111:U128"><span class="var type1" id="S35T111U203">pair</span> = <span class="mxinfo " id="T111:U130"><span class="mxinfo " id="T11:U131"><span class="var type1" id="S25T11U206">snair</span>*<span class="mxinfo " id="T11:U133">sin(<span class="var type1" id="S29T11U209">theta</span>)</span></span>*<span class="var type1" id="S14T111U210">c1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,32" id="srcline32">32</a></span><span class="line">    <span class="mxinfo " id="T111:U136"><span class="var type1" id="S16T111U213">plast</span> = <span class="var type1" id="S35T111U214">pair</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,33" id="srcline33">33</a></span><span class="line">    <span class="mxinfo " id="T111:U139"><span class="var type1" id="S17T111U217">blast</span> = <span class="mxinfo " id="T11:U141">0.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,34" id="srcline34">34</a></span><span class="line">    <span class="mxinfo " id="T11:U142"><span class="var type1" id="S37T11U221">rlast</span> = <span class="mxinfo " id="T11:U144"><span class="var type1" id="S4T6U223">sld</span>(<span class="mxinfo " id="T11:U146">1</span>,<span class="mxinfo " id="T11:U147">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,35" id="srcline35">35</a></span><span class="line">    <span class="mxinfo " id="T111:U148"><span class="mxinfo " id="T111:U149"><span class="var type1" id="S19T113U229">MI</span>(<span class="mxinfo " id="T11:U151">1</span>,<span class="mxinfo " id="T11:U152">1</span>)</span> = <span class="var type1" id="S14T111U232">c1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,36" id="srcline36">36</a></span><span class="line">    <span class="mxinfo " id="T111:U154"><span class="mxinfo " id="T111:U155"><span class="var type1" id="S19T113U236">MI</span>(<span class="mxinfo " id="T11:U157">2</span>,<span class="mxinfo " id="T11:U158">2</span>)</span> = <span class="var type1" id="S14T111U239">c1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,37" id="srcline37">37</a></span><span class="line">    <span class="mxinfo " id="T111:U160"><span class="mxinfo " id="T111:U161"><span class="var type1" id="S19T113U243">MI</span>(<span class="mxinfo " id="T11:U163">1</span>,<span class="mxinfo " id="T11:U164">2</span>)</span> = <span class="var type1" id="S12T111U246">c0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,38" id="srcline38">38</a></span><span class="line">    <span class="mxinfo " id="T111:U166"><span class="mxinfo " id="T111:U167"><span class="var type1" id="S19T113U250">MI</span>(<span class="mxinfo " id="T11:U169">2</span>,<span class="mxinfo " id="T11:U170">1</span>)</span> = <span class="var type1" id="S12T111U253">c0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,39" id="srcline39">39</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S38T11U256">reploop</span> = <span class="mxinfo " id="T11:U173">1</span>:<span class="var type1" id="S7T11U259">nrepeats</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,40" id="srcline40">40</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S39T11U262">nl</span> = <span class="mxinfo " id="T11:U176">1</span>:<span class="var type1" id="S9T11U265">layers</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,41" id="srcline41">41</a></span><span class="line">            <span class="mxinfo " id="T11:U178"><span class="var type1" id="S40T11U268">thick</span> = <span class="mxinfo " id="T11:U180"><span class="var type1" id="S4T6U270">sld</span>(<span class="var type1" id="S39T11U271">nl</span>,<span class="mxinfo " id="T28:U183">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,42" id="srcline42">42</a></span><span class="line">            <span class="mxinfo " id="T11:U184"><span class="var type1" id="S41T11U275">rho</span> = <span class="mxinfo " id="T11:U186"><span class="var type1" id="S4T6U277">sld</span>(<span class="var type1" id="S39T11U278">nl</span>,<span class="mxinfo " id="T28:U189">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,43" id="srcline43">43</a></span><span class="line">            <span class="mxinfo " id="T11:U190"><span class="var type1" id="S42T11U282">rough</span> = <span class="mxinfo " id="T11:U192"><span class="var type1" id="S4T6U284">sld</span>(<span class="var type1" id="S39T11U285">nl</span>,<span class="mxinfo " id="T28:U195">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,44" id="srcline44">44</a></span><span class="line">            <span class="mxinfo " id="T11:U196"><span class="var type1" id="S43T11U289">snlay</span> = (<span class="mxinfo " id="T11:U198"><span class="mxinfo " id="T11:U199">1</span> - (<span class="mxinfo " id="T11:U200"><span class="var type1" id="S41T11U295">rho</span>*(<span class="mxinfo " id="T11:U202">(<span class="mxinfo " id="T11:U203"><span class="var type1" id="S21T11U300">lam</span>*<span class="var type1" id="S21T11U301">lam</span></span>) / <span class="var type1" id="S24T11U302">twopi</span></span>)</span>)</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,45" id="srcline45">45</a></span><span class="line">            <span class="mxinfo " id="T11:U207"><span class="var type1" id="S31T11U305">preal</span> = <span class="mxinfo " id="T11:U209">(<span class="mxinfo " id="T11:U210"><span class="var type1" id="S43T11U309">snlay</span>*<span class="var type1" id="S43T11U310">snlay</span></span>) - <span class="mxinfo " id="T11:U213">(<span class="mxinfo " id="T11:U214"><span class="var type1" id="S25T11U314">snair</span>*<span class="var type1" id="S25T11U315">snair</span></span>) *<span class="mxinfo " id="T11:U217"><span class="mxinfo " id="T11:U218">cos(<span class="var type1" id="S29T11U319">theta</span>)</span>^2</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,46" id="srcline46">46</a></span><span class="line">            <span class="mxinfo " id="T111:U220"><span class="var type1" id="S44T111U323">pimag</span> = <span class="mxinfo " id="T111:U222">sqrt(<span class="mxinfo " id="T111:U223"><span class="var type1" id="S31T11U327">preal</span>*<span class="var type1" id="S14T111U328">c1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,47" id="srcline47">47</a></span><span class="line">            <span class="mxinfo " id="T111:U226"><span class="var type1" id="S45T111U331">beta</span> = <span class="mxinfo " id="T111:U228"><span class="mxinfo " id="T11:U229">(<span class="mxinfo " id="T11:U230"><span class="var type1" id="S24T11U336">twopi</span> / <span class="var type1" id="S21T11U337">lam</span></span>)*<span class="var type1" id="S40T11U338">thick</span></span>*<span class="var type1" id="S44T111U339">pimag</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,48" id="srcline48">48</a></span><span class="line">            <span class="mxinfo " id="T111:U235"><span class="var type1" id="S46T111U342">rij</span> = <span class="mxinfo " id="T111:U237">complex(<span class="mxinfo " id="T111:U238"><span class="var type1" id="S16T111U347">plast</span> - <span class="var type1" id="S44T111U348">pimag</span></span>) / complex(<span class="mxinfo " id="T111:U241"><span class="var type1" id="S16T111U352">plast</span> + <span class="var type1" id="S44T111U353">pimag</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,49" id="srcline49">49</a></span><span class="line">            <span class="mxinfo " id="T111:U244"><span class="var type1" id="S46T111U356">rij</span> = <span class="mxinfo " id="T111:U246"><span class="var type1" id="S46T111U358">rij</span> * <span class="mxinfo " id="T111:U248">exp(<span class="mxinfo " id="T111:U249"><span class="mxinfo " id="T111:U250"><span class="mxinfo " id="T111:U251"><span class="mxinfo " id="T111:U252"><span class="mxinfo " id="T11:U253">-<span class="var type1" id="S22T11U366">rfac</span></span>*<span class="var type1" id="S16T111U367">plast</span></span>*<span class="var type1" id="S44T111U368">pimag</span></span>*(<span class="mxinfo " id="T11:U257"><span class="var type1" id="S42T11U371">rough</span>*<span class="var type1" id="S42T11U372">rough</span></span>)</span>/(<span class="var type1" id="S21T11U375">lam</span>*<span class="var type1" id="S21T11U376">lam</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,50" id="srcline50">50</a></span><span class="line">            <span class="mxinfo " id="T111:U262"><span class="mxinfo " id="T111:U263"><span class="var type1" id="S18T113U380">N</span>(<span class="mxinfo " id="T28:U265">1</span> , <span class="mxinfo " id="T28:U266">1</span>)</span> = <span class="mxinfo " id="T111:U267">exp(<span class="mxinfo " id="T111:U268"><span class="var type1" id="S17T111U386">blast</span>*<span class="var type1" id="S15T111U387">ci</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,51" id="srcline51">51</a></span><span class="line">            <span class="mxinfo " id="T111:U271"><span class="mxinfo " id="T111:U272"><span class="var type1" id="S18T113U391">N</span>(<span class="mxinfo " id="T28:U274">2</span> , <span class="mxinfo " id="T28:U275">1</span>)</span> = <span class="mxinfo " id="T111:U276"><span class="var type1" id="S46T111U395">rij</span> * <span class="mxinfo " id="T111:U278">exp( <span class="mxinfo " id="T111:U279"><span class="mxinfo " id="T111:U280">- <span class="var type1" id="S17T111U400">blast</span></span>*<span class="var type1" id="S15T111U401">ci</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,52" id="srcline52">52</a></span><span class="line">            <span class="mxinfo " id="T111:U283"><span class="mxinfo " id="T111:U284"><span class="var type1" id="S18T113U405">N</span>(<span class="mxinfo " id="T28:U286">2</span> , <span class="mxinfo " id="T28:U287">2</span>)</span> = <span class="mxinfo " id="T111:U288">exp( <span class="mxinfo " id="T111:U289"><span class="mxinfo " id="T111:U290">- <span class="var type1" id="S17T111U412">blast</span></span>*<span class="var type1" id="S15T111U413">ci</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,53" id="srcline53">53</a></span><span class="line">            <span class="mxinfo " id="T111:U293"><span class="mxinfo " id="T111:U294"><span class="var type1" id="S18T113U417">N</span>(<span class="mxinfo " id="T28:U296">1</span> , <span class="mxinfo " id="T28:U297">2</span>)</span> = <span class="mxinfo " id="T111:U298"><span class="var type1" id="S46T111U421">rij</span> * <span class="mxinfo " id="T111:U300">exp(<span class="mxinfo " id="T111:U301"><span class="var type1" id="S17T111U425">blast</span>*<span class="var type1" id="S15T111U426">ci</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,54" id="srcline54">54</a></span><span class="line">            <span class="mxinfo " id="T111:U304"><span class="var type1" id="S16T111U429">plast</span> = <span class="var type1" id="S44T111U430">pimag</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,55" id="srcline55">55</a></span><span class="line">            <span class="mxinfo " id="T111:U307"><span class="var type1" id="S17T111U433">blast</span> = <span class="var type1" id="S45T111U434">beta</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,56" id="srcline56">56</a></span><span class="line">            <span class="mxinfo " id="T113:U310"><span class="var type1" id="S20T113U437">M</span> = <span class="var type1" id="S19T113U438">MI</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,57" id="srcline57">57</a></span><span class="line">            <span class="mxinfo " id="T113:U313"><span class="var type1" id="S19T113U441">MI</span> = <span class="mxinfo " id="T113:U315"><span class="var type1" id="S20T113U443">M</span> * <span class="var type1" id="S18T113U444">N</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,58" id="srcline58">58</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,59" id="srcline59">59</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,60" id="srcline60">60</a></span><span class="line">    <span class="mxinfo " id="T111:U318"><span class="var type1" id="S46T111U447">rij</span> = <span class="mxinfo " id="T111:U320">(complex(<span class="mxinfo " id="T111:U321"><span class="var type1" id="S16T111U453">plast</span> - <span class="var type1" id="S33T111U454">psub</span></span>)) / (complex(<span class="mxinfo " id="T111:U324"><span class="var type1" id="S16T111U459">plast</span> + <span class="var type1" id="S33T111U460">psub</span></span>))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,61" id="srcline61">61</a></span><span class="line">    <span class="mxinfo " id="T111:U327"><span class="var type1" id="S46T111U463">rij</span> = <span class="mxinfo " id="T111:U329"><span class="var type1" id="S46T111U465">rij</span> * <span class="mxinfo " id="T111:U331">exp(<span class="mxinfo " id="T111:U332"><span class="mxinfo " id="T111:U333"><span class="mxinfo " id="T111:U334"><span class="mxinfo " id="T111:U335"><span class="mxinfo " id="T11:U336">-<span class="var type1" id="S22T11U473">rfac</span></span>*<span class="var type1" id="S16T111U474">plast</span></span>*<span class="var type1" id="S33T111U475">psub</span></span>*(<span class="mxinfo " id="T11:U340"><span class="var type1" id="S8T11U478">ssub</span>*<span class="var type1" id="S8T11U479">ssub</span></span>)</span>/(<span class="var type1" id="S21T11U482">lam</span>*<span class="var type1" id="S21T11U483">lam</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,62" id="srcline62">62</a></span><span class="line">    <span class="mxinfo " id="T111:U345"><span class="mxinfo " id="T111:U346"><span class="var type1" id="S18T113U487">N</span>(<span class="mxinfo " id="T28:U348">1</span>,<span class="mxinfo " id="T28:U349">1</span>)</span> = <span class="mxinfo " id="T111:U350">exp(<span class="mxinfo " id="T111:U351"><span class="var type1" id="S17T111U493">blast</span>*<span class="var type1" id="S15T111U494">ci</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,63" id="srcline63">63</a></span><span class="line">    <span class="mxinfo " id="T111:U354"><span class="mxinfo " id="T111:U355"><span class="var type1" id="S18T113U498">N</span>(<span class="mxinfo " id="T28:U357">2</span>,<span class="mxinfo " id="T28:U358">1</span>)</span> = <span class="mxinfo " id="T111:U359"><span class="var type1" id="S46T111U502">rij</span>*<span class="mxinfo " id="T111:U361">exp( <span class="mxinfo " id="T111:U362"><span class="mxinfo " id="T111:U363">- <span class="var type1" id="S17T111U507">blast</span></span>*<span class="var type1" id="S15T111U508">ci</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,64" id="srcline64">64</a></span><span class="line">    <span class="mxinfo " id="T111:U366"><span class="mxinfo " id="T111:U367"><span class="var type1" id="S18T113U512">N</span>(<span class="mxinfo " id="T28:U369">2</span>,<span class="mxinfo " id="T28:U370">2</span>)</span> = <span class="mxinfo " id="T111:U371">exp( <span class="mxinfo " id="T111:U372"><span class="mxinfo " id="T111:U373">- <span class="var type1" id="S17T111U519">blast</span></span>*<span class="var type1" id="S15T111U520">ci</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,65" id="srcline65">65</a></span><span class="line">    <span class="mxinfo " id="T111:U376"><span class="mxinfo " id="T111:U377"><span class="var type1" id="S18T113U524">N</span>(<span class="mxinfo " id="T28:U379">1</span>,<span class="mxinfo " id="T28:U380">2</span>)</span> = <span class="mxinfo " id="T111:U381"><span class="var type1" id="S46T111U528">rij</span>*<span class="mxinfo " id="T111:U383">exp(<span class="mxinfo " id="T111:U384"><span class="var type1" id="S17T111U532">blast</span>*<span class="var type1" id="S15T111U533">ci</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,66" id="srcline66">66</a></span><span class="line">    <span class="mxinfo " id="T113:U387"><span class="var type1" id="S20T113U536">M</span> = <span class="var type1" id="S19T113U537">MI</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,67" id="srcline67">67</a></span><span class="line">    <span class="mxinfo " id="T113:U390"><span class="var type1" id="S19T113U540">MI</span> = <span class="mxinfo " id="T113:U392"><span class="var type1" id="S20T113U542">M</span> * <span class="var type1" id="S18T113U543">N</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,68" id="srcline68">68</a></span><span class="line">    <span class="mxinfo " id="T111:U395"><span class="var type1" id="S48T111U546">num</span> = <span class="mxinfo " id="T111:U397"><span class="mxinfo " id="T111:U398"><span class="var type1" id="S19T113U549">MI</span>(<span class="mxinfo " id="T28:U400">2</span> , <span class="mxinfo " id="T28:U401">1</span>)</span>*<span class="mxinfo " id="T111:U402">conj(<span class="mxinfo " id="T111:U403"><span class="var type1" id="S19T113U555">MI</span>(<span class="mxinfo " id="T11:U405">2</span> , <span class="mxinfo " id="T11:U406">1</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,69" id="srcline69">69</a></span><span class="line">    <span class="mxinfo " id="T111:U407"><span class="var type1" id="S50T111U560">den</span> = <span class="mxinfo " id="T111:U409"><span class="mxinfo " id="T111:U410"><span class="var type1" id="S19T113U563">MI</span>(<span class="mxinfo " id="T28:U412">1</span> , <span class="mxinfo " id="T28:U413">1</span>)</span>*<span class="mxinfo " id="T111:U414">conj(<span class="mxinfo " id="T111:U415"><span class="var type1" id="S19T113U569">MI</span>(<span class="mxinfo " id="T11:U417">1</span> , <span class="mxinfo " id="T11:U418">1</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,70" id="srcline70">70</a></span><span class="line">    <span class="mxinfo " id="T111:U419"><span class="var type1" id="S51T111U574">quo</span> = <span class="mxinfo " id="T111:U421"><span class="var type1" id="S48T111U576">num</span>/<span class="var type1" id="S50T111U577">den</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,71" id="srcline71">71</a></span><span class="line">    <span class="mxinfo " id="T11:U424"><span class="mxinfo " id="T11:U425"><span class="var type1" id="S2T1U581">out</span>(<span class="var type1" id="S27T11U582">loop</span>)</span> = <span class="mxinfo " id="T11:U428">real(<span class="var type1" id="S51T111U585">quo</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,72" id="srcline72">72</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,73" id="srcline73">73</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="101,74" id="srcline74">74</a></span><span class="line"><span class="keyword">return</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,75" id="srcline75">75</a></span><span class="line"><span class="keyword">end</span> </span></span>
</pre>
