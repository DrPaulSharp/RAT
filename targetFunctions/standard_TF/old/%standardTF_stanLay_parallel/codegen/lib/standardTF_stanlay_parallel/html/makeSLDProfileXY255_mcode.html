<pre class="code">
<span class="srcline"><span class="lineno"><a href="68,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T3U3">out</span> = makeSLDProfileXY(<span class="var type1" id="S3T11U6">nbair</span>,<span class="var type1" id="S4T11U7">nbsub</span>,<span class="var type1" id="S5T11U8">ssub</span>,<span class="var type1" id="S6T26U9">layers</span>,<span class="var type1" id="S7T11U10">numberOfLayers</span>,<span class="var type1" id="S8T11U11">nrepeats</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="68,2" id="srcline2"> 2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="68,3" id="srcline3"> 3</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T27:U8"><span class="var type1" id="S7T11U15">numberOfLayers</span>&gt;<span class="mxinfo " id="T11:U10">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="68,4" id="srcline4"> 4</a></span><span class="line">    <span class="mxinfo " id="T11:U11"><span class="var type1" id="S9T11U19">layerThicks</span> = <span class="mxinfo " id="T11:U13">sum(<span class="mxinfo " id="T46:U14"><span class="var type1" id="S6T26U23">layers</span>(<span class="mxinfo " id="T62:U16">:</span>,<span class="mxinfo " id="T29:U17">1</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="68,5" id="srcline5"> 5</a></span><span class="line">    <span class="mxinfo " id="T11:U18"><span class="var type1" id="S11T11U28">totalRange</span> = <span class="mxinfo " id="T11:U20">(<span class="mxinfo " id="T11:U21"><span class="var type1" id="S9T11U32">layerThicks</span>*<span class="var type1" id="S8T11U33">nrepeats</span></span>) + <span class="mxinfo " id="T11:U24">150</span></span></span>;  </span></span>
<span class="srcline"><span class="lineno"><a href="68,6" id="srcline6"> 6</a></span><span class="line">    <span class="mxinfo " id="T13:U25"><span class="var type1" id="S12T13U37">x</span> = <span class="mxinfo " id="T13:U27">0:<span class="var type1" id="S11T11U40">totalRange</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="68,7" id="srcline7"> 7</a></span><span class="line">    <span class="mxinfo " id="T86:U29"><span class="var type1" id="S13T86U43">Lays</span> = <span class="mxinfo " id="T86:U31">zeros(<span class="mxinfo " id="T11:U32">length(<span class="var type1" id="S12T13U48">x</span>)</span>,<span class="mxinfo " id="T11:U34">(<span class="mxinfo " id="T11:U35"><span class="var type1" id="S7T11U52">numberOfLayers</span>*<span class="var type1" id="S8T11U53">nrepeats</span></span>)+<span class="mxinfo " id="T11:U38">2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="68,8" id="srcline8"> 8</a></span><span class="line">    <span class="mxinfo " id="T11:U39"><span class="var type1" id="S16T11U57">boxCen</span> = <span class="mxinfo " id="T11:U41">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="68,9" id="srcline9"> 9</a></span><span class="line">    <span class="mxinfo " id="T11:U42"><span class="var type1" id="S17T11U61">boxWidth</span> = <span class="mxinfo " id="T11:U44">100</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="68,10" id="srcline10">10</a></span><span class="line">    <span class="mxinfo " id="T11:U45"><span class="var type1" id="S18T11U65">nextLayRough</span> = <span class="mxinfo " id="T11:U47"><span class="var type1" id="S6T26U67">layers</span>(<span class="mxinfo " id="T11:U49">1</span>,<span class="mxinfo " id="T29:U50">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="68,11" id="srcline11">11</a></span><span class="line">    <span class="mxinfo " id="T13:U51"><span class="var type1" id="S19T13U72">airBox</span> = <span class="mxinfo " id="T13:U53"><span class="fcn" id="F211N2:B74">asymconvstep</span>(<span class="var type1" id="S12T13U75">x</span>,<span class="var type1" id="S17T11U76">boxWidth</span>,<span class="var type1" id="S16T11U77">boxCen</span>,<span class="var type1" id="S18T11U78">nextLayRough</span>,<span class="var type1" id="S18T11U79">nextLayRough</span>,<span class="var type1" id="S3T11U80">nbair</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="68,12" id="srcline12">12</a></span><span class="line">    <span class="mxinfo " id="T11:U60"><span class="var type1" id="S21T11U83">lastBoxEdge</span> = <span class="mxinfo " id="T11:U62"><span class="var type1" id="S16T11U85">boxCen</span> + (<span class="mxinfo " id="T11:U64"><span class="var type1" id="S17T11U88">boxWidth</span>/<span class="mxinfo " id="T11:U66">2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="68,13" id="srcline13">13</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S22T11U92">n</span> = <span class="mxinfo " id="T11:U68">1</span>:<span class="var type1" id="S8T11U95">nrepeats</span></span></span>
<span class="srcline"><span class="lineno"><a href="68,14" id="srcline14">14</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S23T11U98">i</span> = <span class="mxinfo " id="T11:U71">1</span>:<span class="var type1" id="S7T11U101">numberOfLayers</span></span></span>
<span class="srcline"><span class="lineno"><a href="68,15" id="srcline15">15</a></span><span class="line">            <span class="mxinfo " id="T11:U73"><span class="var type1" id="S24T11U104">thisLayThick</span> = <span class="mxinfo " id="T11:U75"><span class="var type1" id="S6T26U106">layers</span>(<span class="var type1" id="S23T11U107">i</span>,<span class="mxinfo " id="T29:U78">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="68,16" id="srcline16">16</a></span><span class="line">            <span class="mxinfo " id="T11:U79"><span class="var type1" id="S25T11U111">thisLaySLD</span> = <span class="mxinfo " id="T11:U81"><span class="var type1" id="S6T26U113">layers</span>(<span class="var type1" id="S23T11U114">i</span>,<span class="mxinfo " id="T29:U84">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="68,17" id="srcline17">17</a></span><span class="line">            <span class="mxinfo " id="T11:U85"><span class="var type1" id="S26T11U118">thisLayRough</span> = <span class="mxinfo " id="T11:U87"><span class="var type1" id="S6T26U120">layers</span>(<span class="var type1" id="S23T11U121">i</span>,<span class="mxinfo " id="T29:U90">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="68,18" id="srcline18">18</a></span><span class="line">            <span class="keyword">if</span> <span class="mxinfo " id="T27:U91"><span class="var type1" id="S23T11U126">i</span>&lt;<span class="var type1" id="S7T11U127">numberOfLayers</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="68,19" id="srcline19">19</a></span><span class="line">                <span class="mxinfo " id="T11:U94"><span class="var type1" id="S18T11U130">nextLayRough</span> = <span class="mxinfo " id="T11:U96"><span class="var type1" id="S6T26U132">layers</span>(<span class="mxinfo " id="T11:U98"><span class="var type1" id="S23T11U134">i</span>+<span class="mxinfo " id="T11:U100">1</span></span>,<span class="mxinfo " id="T11:U101">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="68,20" id="srcline20">20</a></span><span class="line"><span class="comment">%             elseif (i == numberOfLayers) &amp;&amp; (n &lt; nrepeats)</span></span></span>
<span class="srcline"><span class="lineno"><a href="68,21" id="srcline21">21</a></span><span class="line"><span class="comment">%                 nextLayRough = layers(1,3);</span></span></span>
<span class="srcline"><span class="lineno"><a href="68,22" id="srcline22">22</a></span><span class="line">            <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="68,23" id="srcline23">23</a></span><span class="line">                <span class="mxinfo " id="T11:U102"><span class="var type1" id="S18T11U140">nextLayRough</span> = <span class="var type1" id="S5T11U141">ssub</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="68,24" id="srcline24">24</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="68,25" id="srcline25">25</a></span><span class="line">            <span class="mxinfo " id="T11:U105"><span class="var type1" id="S27T11U144">thisBoxCentre</span> = <span class="mxinfo " id="T11:U107"><span class="var type1" id="S21T11U146">lastBoxEdge</span> + (<span class="mxinfo " id="T11:U109"><span class="var type1" id="S24T11U149">thisLayThick</span>/<span class="mxinfo " id="T11:U111">2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="68,26" id="srcline26">26</a></span><span class="line">            <span class="mxinfo " id="T13:U112"><span class="var type1" id="S28T13U153">thisBox</span> = <span class="mxinfo " id="T13:U114"><span class="fcn" id="F212N2:B155">asymconvstep</span>(<span class="var type1" id="S12T13U156">x</span>,<span class="var type1" id="S24T11U157">thisLayThick</span>,<span class="var type1" id="S27T11U158">thisBoxCentre</span>,<span class="var type1" id="S26T11U159">thisLayRough</span>,<span class="var type1" id="S18T11U160">nextLayRough</span>,<span class="var type1" id="S25T11U161">thisLaySLD</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="68,27" id="srcline27">27</a></span><span class="line">            <span class="mxinfo " id="T1:U121"><span class="mxinfo " id="T1:U122"><span class="var type1" id="S13T86U165">Lays</span>(<span class="mxinfo " id="T85:U124">:</span>,<span class="mxinfo " id="T11:U125"><span class="var type1" id="S23T11U168">i</span>+(<span class="mxinfo " id="T11:U127"><span class="var type1" id="S7T11U171">numberOfLayers</span>*(<span class="mxinfo " id="T11:U129"><span class="var type1" id="S22T11U174">n</span>-<span class="mxinfo " id="T11:U131">1</span></span>)</span>)</span>)</span> = <span class="var type1" id="S28T13U176">thisBox</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="68,28" id="srcline28">28</a></span><span class="line">            <span class="mxinfo " id="T11:U133"><span class="var type1" id="S21T11U179">lastBoxEdge</span> = <span class="mxinfo " id="T11:U135"><span class="var type1" id="S27T11U181">thisBoxCentre</span> + (<span class="mxinfo " id="T11:U137"><span class="var type1" id="S24T11U184">thisLayThick</span>/<span class="mxinfo " id="T11:U139">2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="68,29" id="srcline29">29</a></span><span class="line">            <span class="comment">%plot(x,Lays(:,i));</span></span></span>
<span class="srcline"><span class="lineno"><a href="68,30" id="srcline30">30</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="68,31" id="srcline31">31</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="68,32" id="srcline32">32</a></span><span class="line">    <span class="mxinfo " id="T11:U140"><span class="var type1" id="S26T11U188">thisLayRough</span> = <span class="var type1" id="S18T11U189">nextLayRough</span></span>;<span class="comment">%layers(end,3);</span></span></span>
<span class="srcline"><span class="lineno"><a href="68,33" id="srcline33">33</a></span><span class="line">    <span class="mxinfo " id="T11:U143"><span class="var type1" id="S24T11U192">thisLayThick</span> = <span class="mxinfo " id="T11:U145">(<span class="mxinfo " id="T11:U146"><span class="mxinfo " id="T11:U147"><span class="var type1" id="S12T13U197">x</span>(<span class="mxinfo " id="T11:U149">end</span>)</span>-<span class="var type1" id="S21T11U200">lastBoxEdge</span></span>)*<span class="mxinfo " id="T11:U151">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="68,34" id="srcline34">34</a></span><span class="line">    <span class="mxinfo " id="T11:U152"><span class="var type1" id="S25T11U204">thisLaySLD</span> = <span class="var type1" id="S4T11U205">nbsub</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="68,35" id="srcline35">35</a></span><span class="line">    <span class="mxinfo " id="T11:U155"><span class="var type1" id="S18T11U208">nextLayRough</span> = <span class="var type1" id="S5T11U209">ssub</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="68,36" id="srcline36">36</a></span><span class="line">    <span class="mxinfo " id="T11:U158"><span class="var type1" id="S27T11U212">thisBoxCentre</span> = <span class="mxinfo " id="T11:U160"><span class="var type1" id="S12T13U214">x</span>(<span class="mxinfo " id="T11:U162">end</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="68,37" id="srcline37">37</a></span><span class="line">    <span class="mxinfo " id="T1:U163"><span class="mxinfo " id="T1:U164"><span class="var type1" id="S13T86U220">Lays</span>(<span class="mxinfo " id="T85:U166">:</span>,<span class="mxinfo " id="T11:U167">(<span class="mxinfo " id="T11:U168"><span class="var type1" id="S7T11U225">numberOfLayers</span>*<span class="var type1" id="S8T11U226">nrepeats</span></span>)+<span class="mxinfo " id="T11:U171">1</span></span>)</span> = <span class="mxinfo " id="T13:U172"><span class="fcn" id="F212N2:B229">asymconvstep</span>(<span class="var type1" id="S12T13U230">x</span>,<span class="var type1" id="S24T11U231">thisLayThick</span>,<span class="var type1" id="S27T11U232">thisBoxCentre</span>,<span class="var type1" id="S26T11U233">thisLayRough</span>,<span class="var type1" id="S18T11U234">nextLayRough</span>,<span class="var type1" id="S25T11U235">thisLaySLD</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="68,38" id="srcline38">38</a></span><span class="line">    <span class="comment">%plot(x,Lays(:,(numberOfLayers*nrepeats)+1))</span></span></span>
<span class="srcline"><span class="lineno"><a href="68,39" id="srcline39">39</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="68,40" id="srcline40">40</a></span><span class="line">    <span class="mxinfo " id="T1:U179"><span class="mxinfo " id="T1:U180"><span class="var type1" id="S13T86U239">Lays</span>(<span class="mxinfo " id="T85:U182">:</span>,<span class="mxinfo " id="T11:U183">(<span class="mxinfo " id="T11:U184"><span class="var type1" id="S7T11U244">numberOfLayers</span>*<span class="var type1" id="S8T11U245">nrepeats</span></span>)+<span class="mxinfo " id="T11:U187">2</span></span>)</span> = <span class="var type1" id="S19T13U247">airBox</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="68,41" id="srcline41">41</a></span><span class="line">    <span class="comment">%plot(x,Lays(:,(numberOfLayers*nrepeats)+2))</span></span></span>
<span class="srcline"><span class="lineno"><a href="68,42" id="srcline42">42</a></span><span class="line">    <span class="mxinfo " id="T92:U189"><span class="var type1" id="S30T92U250">SLD</span> = <span class="mxinfo " id="T1:U191">sum(<span class="var type1" id="S13T86U253">Lays</span>,2)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="68,43" id="srcline43">43</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="68,44" id="srcline44">44</a></span><span class="line">    <span class="mxinfo " id="T13:U193"><span class="var type1" id="S12T13U258">x</span> = <span class="mxinfo " id="T88:U195">0:100</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="68,45" id="srcline45">45</a></span><span class="line">    <span class="mxinfo " id="T11:U196"><span class="var type1" id="S31T11U264">subsBoxCen</span> = <span class="mxinfo " id="T11:U198">max(<span class="var type1" id="S12T13U267">x</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="68,46" id="srcline46">46</a></span><span class="line">    <span class="mxinfo " id="T11:U200"><span class="var type1" id="S33T11U270">airBoxCen</span> = <span class="mxinfo " id="T11:U202">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="68,47" id="srcline47">47</a></span><span class="line">    <span class="mxinfo " id="T11:U203"><span class="var type1" id="S34T11U274">widths</span> = <span class="mxinfo " id="T11:U205">max(<span class="var type1" id="S12T13U277">x</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="68,48" id="srcline48">48</a></span><span class="line">    <span class="mxinfo " id="T13:U207"><span class="var type1" id="S19T13U280">airBox</span> = <span class="mxinfo " id="T89:U209"><span class="fcn" id="F246N2:B282">asymconvstep</span>(<span class="var type1" id="S12T13U283">x</span>,<span class="var type1" id="S34T11U284">widths</span>,<span class="var type1" id="S33T11U285">airBoxCen</span>,<span class="var type1" id="S5T11U286">ssub</span>,<span class="var type1" id="S5T11U287">ssub</span>,<span class="var type1" id="S3T11U288">nbair</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="68,49" id="srcline49">49</a></span><span class="line">    <span class="mxinfo " id="T89:U216"><span class="var type1" id="S35T89U291">subBox</span> = <span class="mxinfo " id="T89:U218"><span class="fcn" id="F246N2:B293">asymconvstep</span>(<span class="var type1" id="S12T13U294">x</span>,<span class="var type1" id="S34T11U295">widths</span>,<span class="var type1" id="S31T11U296">subsBoxCen</span>,<span class="var type1" id="S5T11U297">ssub</span>,<span class="var type1" id="S5T11U298">ssub</span>,<span class="var type1" id="S4T11U299">nbsub</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="68,50" id="srcline50">50</a></span><span class="line">    <span class="mxinfo " id="T92:U225"><span class="var type1" id="S30T92U302">SLD</span> = <span class="mxinfo " id="T89:U227"><span class="var type1" id="S19T13U304">airBox</span> + <span class="var type1" id="S35T89U305">subBox</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="68,51" id="srcline51">51</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="68,52" id="srcline52">52</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="68,53" id="srcline53">53</a></span><span class="line"><span class="comment">%plot(x,SLD)</span></span></span>
<span class="srcline"><span class="lineno"><a href="68,54" id="srcline54">54</a></span><span class="line"><span class="mxinfo " id="T3:U230"><span class="var type1" id="S2T3U308">out</span> = <span class="mxinfo " id="T3:U232">[<span class="mxinfo " id="T1:U233"><span class="var type1" id="S12T13U312">x</span>(:)</span>,<span class="mxinfo " id="T1:U235"><span class="var type1" id="S30T92U315">SLD</span>(:)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="68,55" id="srcline55">55</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="68,56" id="srcline56">56</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="68,57" id="srcline57">57</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="68,58" id="srcline58">58</a></span><span class="line"></span></span>
</pre>
