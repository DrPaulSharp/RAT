<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of mcmcplot</title>
  <meta name="keywords" content="mcmcplot">
  <meta name="description" content="MCMCPLOT Plot mcmc chain">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html minimisers --><!-- menu.html mcmcstat -->
<h1>mcmcplot
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>MCMCPLOT Plot mcmc chain</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function mcmcplot(chain,inds,names,plottype,varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment">MCMCPLOT Plot mcmc chain
 mcmcplot(chain,inds,names,plottype, ...)
 plot several plots from mcmc chain
  chain    - mcmc chain matrix
  inds     - columns to use, default all columns
  names    - names of the columns of chain as char array
  plottype - 'chain', 'chainpanel', 'pairs', 'dens', 'denspanel', 'acf', 'hist'
   'pairs':  mcmcplot(...,'pairs',smo,rho)
             SMO is the bandwidth parameter for 2D kernel estimation: smoother
             density curves with big smo (if smo not defined, no density
             curves plotted)
             RHO is the correlation for the kernel estimator (if not
             defined, calculated from the chain)
   'dens':   mcmcplot(...,'dens',smo)
             SMO is the bandwidth for 1D kernel estimation (default: 1)
   'hist':   mcmcplot(...,'hist',nbin,dens)
             NBIN is the number of bins used for the histograms
             DENS ('normal', 'lognor', or 'kernel') adds estimated density
             on top of the histogram
   'chain':  mcmcplot(...,'chain',maxpoints)
             MAXPOINTS max n:o of points in the chain plot
   'acf':    no optional parameters
 example: mcmcplot(chain(2000:10:10000,:),1:4,[],'pairs')</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="acf.html" class="code" title="function y=acf(x,lagmax)">acf</a>	ACF Autocorrelation function</li><li><a href="density.html" class="code" title="function [y,xo]=density(x,xout,ss,gaus)">density</a>	DENSITY  Density estimator using Gaussian kernel</li><li><a href="histp.html" class="code" title="function h=histp(y,nbin,dens,smo)">histp</a>	HISTP   Histogram scaled as relative frequencies (probabilities)</li><li><a href="lognordf.html" class="code" title="function y=lognordf(x,mu,sigma2,theta)">lognordf</a>	LOGNORDF Lognormal cumulative distribution</li><li><a href="lognorpf.html" class="code" title="function y=lognorpf(x,mu,sigma2,theta)">lognorpf</a>	LOGNORPF Lognormal probability density</li><li><a href="lowess.html" class="code" title="function [ys,rw,res]=lowess(x,y,f,nsteps,delta)">lowess</a>	ys=lowess(x,y,f,nsteps,delta)</li><li><a href="nordf.html" class="code" title="function y=nordf(x,mu,sigma2)">nordf</a>	NORDF the standard normal (Gaussian) cumulative distribution.</li><li><a href="norpf.html" class="code" title="function y=norpf(x,mu,sigma2)">norpf</a>	NORPF(x,mu,sigma2)  Normal (Gaussian) density function</li><li><a href="pairs.html" class="code" title="function pairs(x,panelfun,names,skip,varargin)">pairs</a>	PAIRS pairs plot like in R</li><li><a href="../../minimisers/mcmcstat_new/acf.html" class="code" title="function y=acf(x,lagmax)">acf</a>	ACF Autocorrelation function</li><li><a href="../../minimisers/mcmcstat_new/density.html" class="code" title="function [y,xo]=density(x,xout,ss,gaus)">density</a>	DENSITY  Density estimator using Gaussian kernel</li><li><a href="../../minimisers/mcmcstat_new/histp.html" class="code" title="function h=histp(y,nbin,dens,smo)">histp</a>	HISTP   Histogram scaled as relative frequencies (probabilities)</li><li><a href="../../minimisers/mcmcstat_new/lognordf.html" class="code" title="function y=lognordf(x,mu,sigma2,theta)">lognordf</a>	LOGNORDF Lognormal cumulative distribution</li><li><a href="../../minimisers/mcmcstat_new/lognorpf.html" class="code" title="function y=lognorpf(x,mu,sigma2,theta)">lognorpf</a>	LOGNORPF Lognormal probability density</li><li><a href="../../minimisers/mcmcstat_new/lowess.html" class="code" title="function [ys,rw,res]=lowess(x,y,f,nsteps,delta)">lowess</a>	ys=lowess(x,y,f,nsteps,delta)</li><li><a href="../../minimisers/mcmcstat_new/nordf.html" class="code" title="function y=nordf(x,mu,sigma2)">nordf</a>	NORDF the standard normal (Gaussian) cumulative distribution.</li><li><a href="../../minimisers/mcmcstat_new/norpf.html" class="code" title="function y=norpf(x,mu,sigma2)">norpf</a>	NORPF(x,mu,sigma2)  Normal (Gaussian) density function</li><li><a href="../../minimisers/mcmcstat_new/pairs.html" class="code" title="function pairs(x,panelfun,names,skip,varargin)">pairs</a>	PAIRS pairs plot like in R</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../minimisers/mcmcstat/examples/algaeex.html" class="code" title="">algaeex</a>	%</li><li><a href="../../minimisers/mcmcstat/examples/bananaex.html" class="code" title="">bananaex</a>	%</li><li><a href="../../minimisers/mcmcstat/examples/beetleex.html" class="code" title="">beetleex</a>	%</li><li><a href="../../minimisers/mcmcstat/examples/boxoex.html" class="code" title="">boxoex</a>	%</li><li><a href="../../minimisers/mcmcstat/examples/cauchyex.html" class="code" title="">cauchyex</a>	%</li><li><a href="../../minimisers/mcmcstat/examples/himmelex.html" class="code" title="">himmelex</a>	%</li><li><a href="../../minimisers/mcmcstat/examples/monodex.html" class="code" title="">monodex</a>	%</li><li><a href="../../minimisers/mcmcstat/examples/normalex.html" class="code" title="">normalex</a>	%</li><li><a href="../../minimisers/mcmcstat/examples/normalex50.html" class="code" title="">normalex50</a>	%</li><li><a href="../../minimisers/mcmcstat/examples/threemodesex.html" class="code" title="">threemodesex</a>	%</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function mcmcplot(chain,inds,names,plottype,varargin)</a>
0002 <span class="comment">%MCMCPLOT Plot mcmc chain</span>
0003 <span class="comment">% mcmcplot(chain,inds,names,plottype, ...)</span>
0004 <span class="comment">% plot several plots from mcmc chain</span>
0005 <span class="comment">%  chain    - mcmc chain matrix</span>
0006 <span class="comment">%  inds     - columns to use, default all columns</span>
0007 <span class="comment">%  names    - names of the columns of chain as char array</span>
0008 <span class="comment">%  plottype - 'chain', 'chainpanel', 'pairs', 'dens', 'denspanel', 'acf', 'hist'</span>
0009 <span class="comment">%   'pairs':  mcmcplot(...,'pairs',smo,rho)</span>
0010 <span class="comment">%             SMO is the bandwidth parameter for 2D kernel estimation: smoother</span>
0011 <span class="comment">%             density curves with big smo (if smo not defined, no density</span>
0012 <span class="comment">%             curves plotted)</span>
0013 <span class="comment">%             RHO is the correlation for the kernel estimator (if not</span>
0014 <span class="comment">%             defined, calculated from the chain)</span>
0015 <span class="comment">%   'dens':   mcmcplot(...,'dens',smo)</span>
0016 <span class="comment">%             SMO is the bandwidth for 1D kernel estimation (default: 1)</span>
0017 <span class="comment">%   'hist':   mcmcplot(...,'hist',nbin,dens)</span>
0018 <span class="comment">%             NBIN is the number of bins used for the histograms</span>
0019 <span class="comment">%             DENS ('normal', 'lognor', or 'kernel') adds estimated density</span>
0020 <span class="comment">%             on top of the histogram</span>
0021 <span class="comment">%   'chain':  mcmcplot(...,'chain',maxpoints)</span>
0022 <span class="comment">%             MAXPOINTS max n:o of points in the chain plot</span>
0023 <span class="comment">%   'acf':    no optional parameters</span>
0024 <span class="comment">% example: mcmcplot(chain(2000:10:10000,:),1:4,[],'pairs')</span>
0025 
0026 <span class="comment">% ML, 2001</span>
0027 <span class="comment">% $Revision: 1.26 $  $Date: 2017/01/23 14:16:18 $</span>
0028 
0029 <span class="keyword">if</span> exist(<span class="string">'lowess_mexgw'</span>) == 3
0030   smooth=1; <span class="comment">% lowess smooth with 'chain' plot</span>
0031 <span class="keyword">else</span>
0032   smooth=0;
0033 <span class="keyword">end</span>
0034 maxpoints = 10000; <span class="comment">% default max n:o of points in the chain plot</span>
0035 
0036 <span class="keyword">if</span> nargin  &lt; 4 | isempty(plottype)
0037   plottype=<span class="string">'chainpanel'</span>;
0038 <span class="keyword">end</span>
0039 
0040 <span class="keyword">if</span> nargin==1 &amp; isstruct(chain) &amp; isfield(chain,<span class="string">'class'</span>) &amp; strcmp(chain.class,<span class="string">'MCMC'</span>)
0041   <span class="comment">% calling with results struct only</span>
0042   results = chain;
0043   chain = GetArray(<span class="string">'chain'</span>);
0044   names = results.names;
0045   plottype=<span class="string">'chainpanel'</span>;
0046 <span class="keyword">end</span>
0047 
0048 [nsimu,npar2]=size(chain);
0049 
0050 <span class="keyword">if</span> nargin &lt; 2 | isempty(inds)
0051   inds = 1:npar2;
0052 <span class="keyword">end</span>
0053 <span class="keyword">if</span> nargin &lt; 3 | isempty(names)
0054   <span class="keyword">for</span> i=1:length(inds);
0055     names{i} = num2str(inds(i));
0056   <span class="keyword">end</span>
0057 <span class="keyword">else</span> 
0058   <span class="keyword">if</span> isstruct(names) <span class="comment">% results struct from mcmcrun</span>
0059     results=names;
0060     names=results.names;
0061   <span class="keyword">end</span>
0062   names = names(inds);
0063 <span class="keyword">end</span>
0064 
0065 skip=1;
0066 
0067 <span class="keyword">switch</span> plottype
0068  <span class="keyword">case</span>(<span class="string">'pairs'</span>)
0069   <span class="keyword">if</span> isempty(varargin)
0070     <a href="pairs.html" class="code" title="function pairs(x,panelfun,names,skip,varargin)">pairs</a>(chain(:,inds),<span class="string">'panellims'</span>,names,skip,0)
0071   <span class="keyword">else</span>
0072     <a href="pairs.html" class="code" title="function pairs(x,panelfun,names,skip,varargin)">pairs</a>(chain(:,inds),<span class="string">'panellims'</span>,names,skip,varargin{:})
0073   <span class="keyword">end</span>
0074  <span class="keyword">case</span>(<span class="string">'dens'</span>)
0075   <span class="keyword">for</span> i=1:length(inds)
0076     [y,x]=<a href="density.html" class="code" title="function [y,xo]=density(x,xout,ss,gaus)">density</a>(chain(:,inds(i)),[],varargin{:});
0077     plot(x,y)
0078     title(sprintf(<span class="string">'Parameter %g: %s'</span>,i,names{i}))
0079     drawnow
0080     <span class="keyword">if</span> i~=length(inds)  <span class="comment">% not on last time</span>
0081       disp(<span class="string">'Pause, press enter to continue ...'</span>);
0082       pause
0083     <span class="keyword">end</span>
0084   <span class="keyword">end</span>
0085  <span class="keyword">case</span>(<span class="string">'denspanel'</span>)
0086   np  = length(inds);
0087   ns1 = ceil(sqrt(np));
0088   ns2 = round(sqrt(np));
0089   <span class="keyword">for</span> i=1:np
0090     h=subplot(ns1,ns2,i);
0091     [y,x]=<a href="density.html" class="code" title="function [y,xo]=density(x,xout,ss,gaus)">density</a>(chain(:,inds(i)),[],varargin{:});
0092     plot(x,y,<span class="string">'-k'</span>)
0093     set(h,<span class="string">'ytick'</span>,[]);
0094     title(sprintf(<span class="string">'%s'</span>,names{i}))
0095     <span class="comment">% add prior density</span>
0096     <span class="keyword">if</span> exist(<span class="string">'results'</span>,<span class="string">'var'</span>)
0097       ii  = inds(i);
0098       mus = results.prior(ii,:);
0099       mu  = mus(1);
0100       sig = mus(2);
0101       mi  = results.limits(ii,1);
0102       ma  = results.limits(ii,2);
0103       <span class="keyword">if</span> ~isinf(sig)
0104         <span class="keyword">if</span> isfield(results,<span class="string">'priortype'</span>) &amp; results.priortype == -1 
0105           <span class="comment">% lognormal prior for all values</span>
0106           xdr=x(end)-x(1);
0107           hold on
0108           xlim=get(gca,<span class="string">'xlim'</span>);
0109 <span class="comment">%         xp = linspace(max(mi,mu-3*sig),min([ma,mu+3*sig,x(end)+xdr]));</span>
0110           xp = linspace(xlim(1),xlim(2));
0111           yp = <a href="lognorpf.html" class="code" title="function y=lognorpf(x,mu,sigma2,theta)">lognorpf</a>(xp,log(mu),sig^2);
0112           yn = <a href="lognordf.html" class="code" title="function y=lognordf(x,mu,sigma2,theta)">lognordf</a>((mi-mu)/sig)+1-<a href="lognordf.html" class="code" title="function y=lognordf(x,mu,sigma2,theta)">lognordf</a>((ma-mu)/sig); <span class="comment">% area outside bounds</span>
0113           plot([xp(1),xp],[0,yp./(1-yn)],<span class="string">'--k'</span>)
0114           hold off
0115           set(gca,<span class="string">'ytick'</span>,[])
0116         <span class="keyword">else</span>
0117           xdr=x(end)-x(1);
0118           hold on
0119           xlim=get(gca,<span class="string">'xlim'</span>);
0120         <span class="comment">% xp = linspace(max(mi,mu-3*sig),min([ma,mu+3*sig,x(end)+xdr]));</span>
0121           xp = linspace(max(mi,mu-3*sig),min([ma,mu+3*sig]));
0122           yp = <a href="norpf.html" class="code" title="function y=norpf(x,mu,sigma2)">norpf</a>(xp,mu,sig^2);
0123           yn = <a href="nordf.html" class="code" title="function y=nordf(x,mu,sigma2)">nordf</a>((mi-mu)/sig)+1-<a href="nordf.html" class="code" title="function y=nordf(x,mu,sigma2)">nordf</a>((ma-mu)/sig); <span class="comment">% area outside bounds</span>
0124           plot([xp(1),xp],[0,yp./(1-yn)],<span class="string">'--k'</span>)
0125           hold off
0126           set(gca,<span class="string">'xlim'</span>,xlim);
0127           set(gca,<span class="string">'ytick'</span>,[])
0128         <span class="keyword">end</span>
0129       <span class="keyword">end</span>
0130       <span class="comment">% force axis to min max region</span>
0131       xlim = get(h,<span class="string">'xlim'</span>);
0132       <span class="keyword">if</span> xlim(1) &lt; mi
0133         xlim(1) = mi-(min(xlim(2),ma)-mi)*0.05;
0134       <span class="keyword">end</span>
0135       <span class="keyword">if</span> xlim(2) &gt; ma
0136         xlim(2) = ma+(ma-max(xlim(1),mi))*0.05;
0137       <span class="keyword">end</span>
0138       <span class="keyword">if</span> ~isinf(sig)
0139       <span class="comment">%  xlim(2) = min(xlim(2),xp(end));</span>
0140       <span class="comment">%  xlim(1) = max(xlim(1),xp(1));</span>
0141       <span class="keyword">end</span>
0142       set(h,<span class="string">'xlim'</span>,xlim);
0143     <span class="keyword">end</span>
0144   <span class="keyword">end</span>
0145  <span class="keyword">case</span>(<span class="string">'hist'</span>)
0146   np  = length(inds);
0147   ns1 = ceil(sqrt(np));
0148   ns2 = round(sqrt(np));
0149   <span class="keyword">for</span> i=1:np
0150     h=subplot(ns1,ns2,i);
0151     <a href="histp.html" class="code" title="function h=histp(y,nbin,dens,smo)">histp</a>(chain(:,inds(i)),varargin{:});
0152     set(h,<span class="string">'ytick'</span>,[]);
0153     title(sprintf(<span class="string">'%s'</span>,names{i}))
0154   <span class="keyword">end</span>
0155  <span class="keyword">case</span>(<span class="string">'chain'</span>)
0156   <span class="comment">% max points in the plot</span>
0157   <span class="keyword">if</span> length(varargin) &gt; 0, maxpoints = varargin{1}; <span class="keyword">end</span>
0158   <span class="keyword">if</span> maxpoints &gt; 0 &amp; nsimu&gt;maxpoints
0159     skip = floor(nsimu/maxpoints);
0160   <span class="keyword">end</span>
0161   
0162   <span class="keyword">for</span> i=1:length(inds)
0163     plot(1:skip:nsimu,chain(1:skip:nsimu,inds(i)),<span class="string">'.'</span>)
0164     <span class="keyword">if</span> length(inds)&gt;1
0165       title(sprintf(<span class="string">'Parameter %g: %s'</span>,i,names{i}))
0166     <span class="keyword">else</span>
0167       title(sprintf(<span class="string">'%s'</span>,names{i}))
0168     <span class="keyword">end</span>
0169     <span class="keyword">if</span> smooth
0170       ys = <a href="lowess.html" class="code" title="function [ys,rw,res]=lowess(x,y,f,nsteps,delta)">lowess</a>(1:skip:nsimu,chain(1:skip:nsimu,inds(i)));
0171       hold on
0172       plot(1:skip:nsimu,ys,<span class="string">'-k'</span>);
0173       hold off
0174     <span class="keyword">end</span>
0175     drawnow
0176     <span class="keyword">if</span> i~=length(inds)  <span class="comment">% not on last time</span>
0177       disp(<span class="string">'Pause, press enter to continue ...'</span>);
0178       pause
0179     <span class="keyword">end</span>
0180   <span class="keyword">end</span>
0181  <span class="keyword">case</span>(<span class="string">'chainpanel'</span>)
0182   <span class="comment">% max points in the plot</span>
0183   <span class="keyword">if</span> length(varargin) &gt; 0, maxpoints = varargin{1}; <span class="keyword">end</span>
0184   <span class="keyword">if</span> maxpoints &gt; 0 &amp; nsimu&gt;maxpoints
0185     skip = floor(nsimu/maxpoints);
0186   <span class="keyword">end</span>
0187 
0188   np  = length(inds);
0189   ns1 = ceil(sqrt(np));
0190   ns2 = round(sqrt(np));
0191   <span class="keyword">for</span> i=1:np
0192     h=subplot(ns1,ns2,i);
0193     plot(1:skip:nsimu,chain(1:skip:nsimu,inds(i)),<span class="string">'.'</span>)
0194 <span class="comment">%    set(h,'ytick',[]);</span>
0195     title(sprintf(<span class="string">'%s'</span>,names{i}))
0196     <span class="keyword">if</span> smooth
0197       ys = <a href="lowess.html" class="code" title="function [ys,rw,res]=lowess(x,y,f,nsteps,delta)">lowess</a>(1:skip:nsimu,chain(1:skip:nsimu,inds(i)));
0198       hold on
0199       plot(1:skip:nsimu,ys,<span class="string">'-k'</span>);
0200       hold off
0201     <span class="keyword">end</span>
0202     set(h,<span class="string">'xlim'</span>,[1 nsimu]);
0203     <span class="keyword">if</span> i&lt;=ns1*ns2-ns2
0204       set(h,<span class="string">'xticklabel'</span>,<span class="string">' '</span>);
0205     <span class="keyword">end</span>
0206   <span class="keyword">end</span>
0207  <span class="keyword">case</span>(<span class="string">'acf'</span>)
0208   np = length(inds);
0209   <span class="keyword">if</span> np&gt;1;clf;<span class="keyword">end</span>
0210   <span class="keyword">for</span> i=1:np
0211     <span class="keyword">if</span> np&gt;1; h=subplot(np,1,i); <span class="keyword">else</span>; h=gca; <span class="keyword">end</span>
0212     plot(<a href="acf.html" class="code" title="function y=acf(x,lagmax)">acf</a>(chain(1:skip:nsimu,inds(i)),varargin{:}),<span class="string">'-'</span>); 
0213     <span class="keyword">if</span> i~=np; set(h,<span class="string">'xtick'</span>,[]); <span class="keyword">end</span>
0214 <span class="comment">%    axis([1 100 -1 1]);</span>
0215 <span class="comment">%    set(h,'ylim',[-1 1]);</span>
0216     ylim = get(h,<span class="string">'ylim'</span>);
0217     ylim(1) = min(ylim(1),0);
0218     set(h,<span class="string">'ylim'</span>,ylim);
0219 
0220     title(sprintf(<span class="string">'Parameter %g: %s'</span>,i,names{i}))
0221   <span class="keyword">end</span>
0222  <span class="keyword">otherwise</span>
0223   disp(<span class="string">'unknown plot type'</span>);
0224 <span class="keyword">end</span> <span class="comment">% switch</span></pre></div>
<hr><address>Generated on Wed 28-Jul-2021 14:15:23 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>