<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of addbin</title>
  <meta name="keywords" content="addbin">
  <meta name="description" content="ADDBIN add columns to a V4 matfile">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html minimisers --><!-- menu.html mcmcstat -->
<h1>addbin
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>ADDBIN add columns to a V4 matfile</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function status=addbin(filename,x) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment">ADDBIN add columns to a V4 matfile
 Usage: addbin(filename,x)
 Adds columns of x to data in mat file. Columns are added because
 MATLAB stores data columnwise. Transpose the data to add rows.
 The file should contain only one double precision matrix.
 This is used in MCMCRUN to save and append temporary mcmc
 chains into binary files.
 See also <a href="savebin.html" class="code" title="function s=savebin(filename,x,name)">SAVEBIN</a> and <a href="readbin.html" class="code" title="function [x,status]=readbin(filename,trans,skip)">READBIN</a>.</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="mcmcrun.html" class="code" title="function [results,chain,s2chain,sschain, hchain]=mcmcrun(model,data,problem,params,options,res)">mcmcrun</a>	MCMCRUN Metropolis-Hastings MCMC simulation for nonlinear Gaussian models</li><li><a href="mcmcrun_compile.html" class="code" title="function [results,chain,s2chain,sschain, hchain]=mcmcrun_compile(model,data,problem,params,options,res)">mcmcrun_compile</a>	MCMCRUN Metropolis-Hastings MCMC simulation for nonlinear Gaussian models</li><li><a href="../../minimisers/mcmcstat_new/mcmcrun.html" class="code" title="function [results,chain,s2chain,sschain, hchain]=mcmcrun(model,data,params,options,res)">mcmcrun</a>	MCMCRUN Metropolis-Hastings MCMC simulation for nonlinear Gaussian models</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function status=addbin(filename,x)</a>
0002 <span class="comment">%ADDBIN add columns to a V4 matfile</span>
0003 <span class="comment">% Usage: addbin(filename,x)</span>
0004 <span class="comment">% Adds columns of x to data in mat file. Columns are added because</span>
0005 <span class="comment">% MATLAB stores data columnwise. Transpose the data to add rows.</span>
0006 <span class="comment">% The file should contain only one double precision matrix.</span>
0007 <span class="comment">% This is used in MCMCRUN to save and append temporary mcmc</span>
0008 <span class="comment">% chains into binary files.</span>
0009 <span class="comment">% See also SAVEBIN and READBIN.</span>
0010 
0011 <span class="comment">% $Revision: 1.3 $  $Date: 2010/12/10 10:47:38 $</span>
0012 
0013 m  = size(x,1);
0014 n  = size(x,2);
0015 
0016 fid = fopen(filename,<span class="string">'r+b'</span>);
0017 <span class="keyword">if</span> fid == -1 
0018   error(sprintf(<span class="string">'error opening binary file %s'</span>,filename));
0019 <span class="keyword">end</span>
0020 
0021 <span class="keyword">if</span> fseek(fid,4,<span class="string">'bof'</span>) == -1
0022   fclose(fid);
0023   error(<span class="string">'error seeking file'</span>);
0024 <span class="keyword">end</span>
0025 
0026 mrows   = fread(fid,1,<span class="string">'integer*4'</span>);
0027 mcols   = fread(fid,1,<span class="string">'integer*4'</span>);
0028 imagf   = fread(fid,1,<span class="string">'integer*4'</span>);
0029 namelen = fread(fid,1,<span class="string">'integer*4'</span>);
0030 
0031 <span class="keyword">if</span> mrows &gt; 0 &amp; mrows ~= m
0032   error(<span class="string">'x should have same number of rows'</span>);
0033 <span class="keyword">end</span>
0034 
0035 <span class="comment">% goto begining of x</span>
0036 <span class="keyword">if</span> fseek(fid,namelen,<span class="string">'cof'</span>) == -1
0037   fclose(fid);
0038   error(<span class="string">'error seeking file'</span>);
0039 <span class="keyword">end</span>
0040 
0041 <span class="keyword">if</span> fseek(fid,0,<span class="string">'eof'</span>) == -1
0042   fclose(fid);
0043   error(<span class="string">'error seeking eof'</span>);
0044 <span class="keyword">end</span>
0045 
0046 <span class="comment">% write the new data to file</span>
0047 fwrite(fid,x,<span class="string">'real*8'</span>);
0048 
0049 <span class="comment">% fix mrows</span>
0050 <span class="keyword">if</span> mrows == 0
0051   <span class="keyword">if</span> fseek(fid,4,<span class="string">'bof'</span>) == -1
0052     fclose(fid);
0053     error(<span class="string">'error seeking file'</span>);
0054   <span class="keyword">end</span>
0055   fwrite(fid,m,<span class="string">'integer*4'</span>);
0056 <span class="keyword">end</span>
0057 
0058 <span class="comment">% write the new column size</span>
0059 <span class="keyword">if</span> fseek(fid,8,<span class="string">'bof'</span>) == -1
0060   fclose(fid);
0061   error(<span class="string">'error seeking file'</span>);
0062 <span class="keyword">end</span>
0063 fwrite(fid,mcols+n,<span class="string">'integer*4'</span>);
0064 
0065 fclose(fid);
0066 
0067 <span class="keyword">if</span> nargout &gt; 0
0068   status = 1;
0069 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Wed 28-Jul-2021 14:15:23 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>