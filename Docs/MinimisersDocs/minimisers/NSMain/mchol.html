<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of mchol</title>
  <meta name="keywords" content="mchol">
  <meta name="description" content="[L,D,E,pneg]=mchol(G)">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html minimisers --><!-- menu.html NSMain -->
<h1>mchol
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>[L,D,E,pneg]=mchol(G)</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function [L,D,E,pneg]=mchol(G) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment">
  [L,D,E,pneg]=mchol(G)

  Given a symmetric matrix G, find a matrix E of &quot;small&quot; norm and c
  L, and D such that  G+E is Positive Definite, and 

      G+E = L*D*L'

  Also, calculate a direction pneg, such that if G is not PD, then

      pneg'*G*pneg &lt; 0

  Note that if G is PD, then the routine will return pneg=[]. 

  Reference: Gill, Murray, and Wright, &quot;Practical Optimization&quot;, p111.
  Author: Brian Borchers (borchers@nmt.edu)
  
  Copyright (c) 2009, Brian Borchers
  All rights reserved.
 
  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are 
  met:

    * Redistributions of source code must retain the above copyright 
      notice, this list of conditions and the following disclaimer.
    * Redistributions in binary form must reproduce the above copyright 
      notice, this list of conditions and the following disclaimer in 
      the documentation and/or other materials provided with the distribution
    * Neither the name of the New Mexico Inst of Mining &amp; Tech nor the names 
      of its contributors may be used to endorse or promote products derived 
      from this software without specific prior written permission.
      
 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; 
 AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE 
 IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE 
 ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE 
 LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR 
 CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF 
 SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS 
 INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN 
 CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) 
 ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE 
 POSSIBILITY OF SUCH DAMAGE.</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="nested_sampler.html" class="code" title="function [logZ, nest_samples, post_samples,H] = nested_sampler(data,Nlive, Nmcmc, tolerance, likelihood, model, prior, extraparams)">nested_sampler</a>	function [logZ, nest_samples, post_samples] = nested_sampler(data, ...</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">%</span>
0002 <span class="comment">%  [L,D,E,pneg]=mchol(G)</span>
0003 <span class="comment">%</span>
0004 <span class="comment">%  Given a symmetric matrix G, find a matrix E of &quot;small&quot; norm and c</span>
0005 <span class="comment">%  L, and D such that  G+E is Positive Definite, and</span>
0006 <span class="comment">%</span>
0007 <span class="comment">%      G+E = L*D*L'</span>
0008 <span class="comment">%</span>
0009 <span class="comment">%  Also, calculate a direction pneg, such that if G is not PD, then</span>
0010 <span class="comment">%</span>
0011 <span class="comment">%      pneg'*G*pneg &lt; 0</span>
0012 <span class="comment">%</span>
0013 <span class="comment">%  Note that if G is PD, then the routine will return pneg=[].</span>
0014 <span class="comment">%</span>
0015 <span class="comment">%  Reference: Gill, Murray, and Wright, &quot;Practical Optimization&quot;, p111.</span>
0016 <span class="comment">%  Author: Brian Borchers (borchers@nmt.edu)</span>
0017 <span class="comment">%</span>
0018 <span class="comment">%  Copyright (c) 2009, Brian Borchers</span>
0019 <span class="comment">%  All rights reserved.</span>
0020 <span class="comment">%</span>
0021 <span class="comment">%  Redistribution and use in source and binary forms, with or without</span>
0022 <span class="comment">%  modification, are permitted provided that the following conditions are</span>
0023 <span class="comment">%  met:</span>
0024 <span class="comment">%</span>
0025 <span class="comment">%    * Redistributions of source code must retain the above copyright</span>
0026 <span class="comment">%      notice, this list of conditions and the following disclaimer.</span>
0027 <span class="comment">%    * Redistributions in binary form must reproduce the above copyright</span>
0028 <span class="comment">%      notice, this list of conditions and the following disclaimer in</span>
0029 <span class="comment">%      the documentation and/or other materials provided with the distribution</span>
0030 <span class="comment">%    * Neither the name of the New Mexico Inst of Mining &amp; Tech nor the names</span>
0031 <span class="comment">%      of its contributors may be used to endorse or promote products derived</span>
0032 <span class="comment">%      from this software without specific prior written permission.</span>
0033 <span class="comment">%</span>
0034 <span class="comment">% THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span>
0035 <span class="comment">% AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
0036 <span class="comment">% IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</span>
0037 <span class="comment">% ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE</span>
0038 <span class="comment">% LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR</span>
0039 <span class="comment">% CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF</span>
0040 <span class="comment">% SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS</span>
0041 <span class="comment">% INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN</span>
0042 <span class="comment">% CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)</span>
0043 <span class="comment">% ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE</span>
0044 <span class="comment">% POSSIBILITY OF SUCH DAMAGE.</span>
0045 
0046 <a name="_sub0" href="#_subfunctions" class="code">function [L,D,E,pneg]=mchol(G)</a>
0047 <span class="comment">%</span>
0048 <span class="comment">%  n gives the size of the matrix.</span>
0049 <span class="comment">%</span>
0050 n=size(G,1);
0051 <span class="comment">%</span>
0052 <span class="comment">%  gamma, zi, nu, and beta2 are quantities used by the algorithm.</span>
0053 <span class="comment">%</span>
0054 gamma=max(diag(G));
0055 zi=max(max(G-diag(diag(G))));
0056 nu=max([1,sqrt(n^2-1)]);
0057 beta2=max([gamma, zi/nu, 1.0E-15]);
0058 <span class="comment">%</span>
0059 <span class="comment">%  Initialize diag(C) to diag(G).</span>
0060 <span class="comment">%</span>
0061 C=diag(diag(G));
0062 <span class="comment">%</span>
0063 <span class="comment">%  Loop through, calculating column j of L for j=1:n</span>
0064 <span class="comment">%</span>
0065 
0066 L=zeros(n);
0067 D=zeros(n);
0068 E=zeros(n);
0069 theta = zeros(n);
0070 
0071 <span class="keyword">for</span> j=1:n,
0072     bb=[1:j-1];
0073     ee=[j+1:n];
0074 
0075     <span class="comment">%</span>
0076     <span class="comment">%  Calculate the jth row of L.</span>
0077     <span class="comment">%</span>
0078     <span class="keyword">if</span> (j &gt; 1),
0079         L(j,bb)=C(j,bb)./diag(D(bb,bb))';
0080     <span class="keyword">end</span>;
0081     <span class="comment">%</span>
0082     <span class="comment">%  Update the jth column of C.</span>
0083     <span class="comment">%</span>
0084     <span class="keyword">if</span> (j &gt;= 2),
0085         <span class="keyword">if</span> (j &lt; n), 
0086             C(ee,j)=G(ee,j)-(L(j,bb)*C(ee,bb)')';
0087         <span class="keyword">end</span>;
0088     <span class="keyword">else</span>
0089         C(ee,j)=G(ee,j);
0090     <span class="keyword">end</span>;
0091     <span class="comment">%</span>
0092     <span class="comment">% Update theta.</span>
0093     <span class="comment">%</span>
0094     <span class="keyword">if</span> (j == n)
0095         theta(j)=0;
0096     <span class="keyword">else</span>
0097         theta(j)=max(abs(C(ee,j)));
0098     <span class="keyword">end</span>;
0099     <span class="comment">%</span>
0100     <span class="comment">%  Update D</span>
0101     <span class="comment">%</span>
0102     D(j,j)=max([eps,abs(C(j,j)),theta(j)^2/beta2]');
0103     <span class="comment">%</span>
0104     <span class="comment">% Update E.</span>
0105     <span class="comment">%</span>
0106     E(j,j)=D(j,j)-C(j,j);
0107 
0108     
0109     <span class="comment">%</span>
0110     <span class="comment">%  Update C again...</span>
0111     <span class="comment">%</span>
0112     <span class="comment">%%%%%%%% M.Zibulevsky: begin of changes, old version is commented %%%%%%%%%%%%%</span>
0113     
0114     <span class="comment">%for i=j+1:n,</span>
0115     <span class="comment">%    C(i,i)=C(i,i)-C(i,j)^2/D(j,j);</span>
0116     <span class="comment">%end;</span>
0117     
0118     ind=[j*(n+1)+1 : n+1 : n*n]';
0119     C(ind)=C(ind)-(1/D(j,j))*C(ee,j).^2;
0120 
0121 
0122 <span class="keyword">end</span>;
0123 
0124 <span class="comment">%</span>
0125 <span class="comment">% Put 1's on the diagonal of L</span>
0126 <span class="comment">%</span>
0127 <span class="comment">%for j=1:n,</span>
0128 <span class="comment">%    L(j,j)=1;</span>
0129 <span class="comment">%end;</span>
0130 
0131 ind=[1 : n+1 : n*n]';
0132 L(ind)=1;
0133 
0134 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%% M.Zibulevsky: end of changes %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0135 
0136 <span class="comment">%</span>
0137 <span class="comment">%  if needed, find a descent direction.</span>
0138 <span class="comment">%</span>
0139 <span class="keyword">if</span> ((nargout == 4) &amp; (min(diag(C)) &lt; 0.0))
0140     [m,col]=min(diag(C));
0141     rhs=zeros(n,1);
0142     rhs(col)=1;
0143     pneg=L'\rhs;
0144 <span class="keyword">else</span>
0145   pneg=[];
0146 <span class="keyword">end</span>;
0147 
0148 
0149 <span class="keyword">return</span>
0150 
0151 
0152 
0153 
0154 
0155</pre></div>
<hr><address>Generated on Wed 28-Jul-2021 14:15:23 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>