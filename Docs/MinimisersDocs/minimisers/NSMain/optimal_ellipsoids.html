<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of optimal_ellipsoids</title>
  <meta name="keywords" content="optimal_ellipsoids">
  <meta name="description" content="function [Bs, mus, VEs, ns] = optimal_ellipsoids(u, VS)">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html minimisers --><!-- menu.html NSMain -->
<h1>optimal_ellipsoids
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function [Bs, mus, VEs, ns] = optimal_ellipsoids(u, VS)</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function [Bs, mus, VEs, ns] = optimal_ellipsoids(u, VS) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> function [Bs, mus, VEs, ns] = optimal_ellipsoids(u, VS)

 This function attempts to optimally partition the multi-dimensional
 samples u (uniformly distributed within the sample volume VS), into
 a set of subclusters enclosed by bounding ellipsoids.  The algorithm 
 is based on Algorithm 1 of the MULTINEST paper by Feroz, Hobson, 
 and Bridges, MNRAS, 398, 1601-1614 (2009).

 Output:
   Bs:  an array of bounding matrices for the ellipsoids enclosing
        the subclusters, scaled to have at least the minimum volume
        required by the subclusters. ( (K x ndims) x ndims )
   mus: an array of centroids for the bounding ellipsoids (K x ndims)
   VEs: an array of volumes for the bounding ellipsoids   (K x 1)
   ns:  an array containing the number of points for each subcluster (K x 1)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="calc_ellipsoid.html" class="code" title="function [B, mu, VE, flag] = calc_ellipsoid(u, VS)">calc_ellipsoid</a>	</li><li><a href="optimal_ellipsoids.html" class="code" title="function [Bs, mus, VEs, ns] = optimal_ellipsoids(u, VS)">optimal_ellipsoids</a>	function [Bs, mus, VEs, ns] = optimal_ellipsoids(u, VS)</li><li><a href="split_ellipsoid.html" class="code" title="function [u1, u2, VE1, VE2, nosplit] = split_ellipsoid(u, VS)">split_ellipsoid</a>	function [u1, u2, VE1, VE2, nosplit] = split_ellipsiod(u, VS)</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="nested_sampler.html" class="code" title="function [logZ, nest_samples, post_samples,H] = nested_sampler(data,Nlive, Nmcmc, tolerance, likelihood, model, prior, extraparams)">nested_sampler</a>	function [logZ, nest_samples, post_samples] = nested_sampler(data, ...</li><li><a href="optimal_ellipsoids.html" class="code" title="function [Bs, mus, VEs, ns] = optimal_ellipsoids(u, VS)">optimal_ellipsoids</a>	function [Bs, mus, VEs, ns] = optimal_ellipsoids(u, VS)</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [Bs, mus, VEs, ns] = optimal_ellipsoids(u, VS)</a>
0002 
0003 <span class="comment">% function [Bs, mus, VEs, ns] = optimal_ellipsoids(u, VS)</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% This function attempts to optimally partition the multi-dimensional</span>
0006 <span class="comment">% samples u (uniformly distributed within the sample volume VS), into</span>
0007 <span class="comment">% a set of subclusters enclosed by bounding ellipsoids.  The algorithm</span>
0008 <span class="comment">% is based on Algorithm 1 of the MULTINEST paper by Feroz, Hobson,</span>
0009 <span class="comment">% and Bridges, MNRAS, 398, 1601-1614 (2009).</span>
0010 <span class="comment">%</span>
0011 <span class="comment">% Output:</span>
0012 <span class="comment">%   Bs:  an array of bounding matrices for the ellipsoids enclosing</span>
0013 <span class="comment">%        the subclusters, scaled to have at least the minimum volume</span>
0014 <span class="comment">%        required by the subclusters. ( (K x ndims) x ndims )</span>
0015 <span class="comment">%   mus: an array of centroids for the bounding ellipsoids (K x ndims)</span>
0016 <span class="comment">%   VEs: an array of volumes for the bounding ellipsoids   (K x 1)</span>
0017 <span class="comment">%   ns:  an array containing the number of points for each subcluster (K x 1)</span>
0018 <span class="comment">%</span>
0019 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0020 <span class="keyword">global</span> DEBUG
0021 
0022 N = size(u,1); <span class="comment">% number of samples in multi-dimensional space</span>
0023 ndims = size(u,2); <span class="comment">% number of dimensions</span>
0024 K = 1;
0025 
0026 <span class="comment">% calculate bounding matrix, etc. for bounding ellipsoid associated</span>
0027 <span class="comment">% with the original set of points u</span>
0028 [B, mu, VE, flag] = <a href="calc_ellipsoid.html" class="code" title="function [B, mu, VE, flag] = calc_ellipsoid(u, VS)">calc_ellipsoid</a>(u, VS);
0029 
0030 <span class="comment">% attempt to split u into two subclusters</span>
0031 [u1, u2, VE1, VE2, nosplit] = <a href="split_ellipsoid.html" class="code" title="function [u1, u2, VE1, VE2, nosplit] = split_ellipsoid(u, VS)">split_ellipsoid</a>(u, VS);
0032 n1 = size(u1,1);
0033 n2 = size(u2,1);
0034 
0035 <span class="keyword">if</span> nosplit || n1&lt;ndims+1 || n2&lt;ndims+1
0036     <span class="comment">% couldn't split the cluster</span>
0037     Bs = B;
0038     mus = mu;
0039     VEs = VE;
0040     ns = N;
0041 <span class="keyword">else</span>
0042     <span class="comment">% check if we should keep the partitioning of S</span>
0043     <span class="keyword">if</span> (VE1 + VE2 &lt; VE || VE &gt; 2*VS) 
0044         <span class="keyword">if</span> DEBUG
0045             fprintf(<span class="string">'PARTITION ACCEPTED: N=%d splits to n1=%d, n2=%d\n'</span>, N, n1, n2);
0046         <span class="keyword">end</span>
0047         K = K + 1;
0048         VS1 = n1 * VS / N;
0049         VS2 = n2 * VS / N;
0050 
0051         [B1, mu1, VE1, n1] = <a href="optimal_ellipsoids.html" class="code" title="function [Bs, mus, VEs, ns] = optimal_ellipsoids(u, VS)">optimal_ellipsoids</a>(u1, VS1);
0052         [B2, mu2, VE2, n2] = <a href="optimal_ellipsoids.html" class="code" title="function [Bs, mus, VEs, ns] = optimal_ellipsoids(u, VS)">optimal_ellipsoids</a>(u2, VS2);
0053 
0054         Bs =  [B1 ; B2];
0055         mus = [mu1 ; mu2];
0056         VEs = [VE1 ; VE2];
0057         ns =  [n1 ; n2];
0058     <span class="keyword">else</span>
0059         <span class="keyword">if</span> DEBUG
0060             fprintf(<span class="string">'PARTITION REJECTED: N=%d doesnt split into n1=%d and n2=%d\n'</span>, N, n1, n2);
0061         <span class="keyword">end</span>
0062         Bs = B;
0063         mus = mu;
0064         VEs = VE;
0065         ns = N;
0066     <span class="keyword">end</span>
0067 
0068 <span class="keyword">end</span>
0069 
0070 <span class="keyword">return</span>
0071</pre></div>
<hr><address>Generated on Wed 28-Jul-2021 14:15:23 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>