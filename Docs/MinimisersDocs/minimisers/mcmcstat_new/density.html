<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of density</title>
  <meta name="keywords" content="density">
  <meta name="description" content="DENSITY  Density estimator using Gaussian kernel">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html minimisers --><!-- menu.html mcmcstat_new -->
<h1>density
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>DENSITY  Density estimator using Gaussian kernel</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function [y,xo]=density(x,xout,ss,gaus) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment">DENSITY  Density estimator using Gaussian kernel
 Y = DENSITY(X,XOUT,S)
 X is the vector of data values.
 The density estimator is evaluated at XOUT points.
 S is a scale factor for the default kernel bandwidth,
 default S = 1.
 Without output arguments the density is plotted.</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../minimisers/mcmcstat/gammapf.html" class="code" title="function y=gammapf(x,a,b)">gammapf</a>	GAMMAPF - gamma probability density function</li><li><a href="../../minimisers/mcmcstat/iqrange.html" class="code" title="function y=iqrange(x)">iqrange</a>	Interquantile range of each column of x</li><li><a href="../../minimisers/mcmcstat/norpf.html" class="code" title="function y=norpf(x,mu,sigma2)">norpf</a>	NORPF(x,mu,sigma2)  Normal (Gaussian) density function</li><li><a href="gammapf.html" class="code" title="function y=gammapf(x,a,b)">gammapf</a>	GAMMAPF - gamma probability density function</li><li><a href="iqrange.html" class="code" title="function y=iqrange(x)">iqrange</a>	Interquantile range of each column of x</li><li><a href="norpf.html" class="code" title="function y=norpf(x,mu,sigma2)">norpf</a>	NORPF(x,mu,sigma2)  Normal (Gaussian) density function</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../minimisers/mcmcstat/histp.html" class="code" title="function h=histp(y,nbin,dens,smo)">histp</a>	HISTP   Histogram scaled as relative frequencies (probabilities)</li><li><a href="../../minimisers/mcmcstat/mcmcplot.html" class="code" title="function mcmcplot(chain,inds,names,plottype,varargin)">mcmcplot</a>	MCMCPLOT Plot mcmc chain</li><li><a href="../../minimisers/mcmcstat/panellims.html" class="code" title="function panellims(x,y,smo,rho,dens,ccolor)">panellims</a>	PANELLIMS 2d density with probability limits added to pairs plot. See PAIRS.</li><li><a href="histp.html" class="code" title="function h=histp(y,nbin,dens,smo)">histp</a>	HISTP   Histogram scaled as relative frequencies (probabilities)</li><li><a href="mcmcplot.html" class="code" title="function mcmcplot(chain,inds,names,plottype,varargin)">mcmcplot</a>	MCMCPLOT Plot mcmc chain</li><li><a href="panellims.html" class="code" title="function panellims(x,y,smo,rho,dens,ccolor)">panellims</a>	PANELLIMS 2d density with probability limits added to pairs plot. See PAIRS.</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [y,xo]=density(x,xout,ss,gaus)</a>
0002 <span class="comment">%DENSITY  Density estimator using Gaussian kernel</span>
0003 <span class="comment">% Y = DENSITY(X,XOUT,S)</span>
0004 <span class="comment">% X is the vector of data values.</span>
0005 <span class="comment">% The density estimator is evaluated at XOUT points.</span>
0006 <span class="comment">% S is a scale factor for the default kernel bandwidth,</span>
0007 <span class="comment">% default S = 1.</span>
0008 <span class="comment">% Without output arguments the density is plotted.</span>
0009 
0010 <span class="comment">% Marko Laine &lt;marko.laine@fmi.fi&gt;</span>
0011 <span class="comment">% $Revision: 1.11 $  $Date: 2014/09/28 17:46:32 $</span>
0012 
0013 <span class="keyword">if</span> nargin&lt;3
0014   ss=1;
0015 <span class="keyword">end</span>
0016 <span class="keyword">if</span> nargin&lt;4
0017   gaus=1;
0018 <span class="keyword">end</span>
0019 
0020 <span class="keyword">if</span> nargin&lt;2 | isempty(xout)
0021   xmin=min(x); xmax=max(x); xrange=xmax-xmin;
0022   <span class="keyword">if</span> length(x) &gt; 200
0023     xout=linspace(xmin-0.08*xrange,xmax+0.08*xrange);
0024   <span class="keyword">else</span>
0025     xout=linspace(mean(x)-4*std(x),mean(x)+4*std(x));
0026   <span class="keyword">end</span>
0027 <span class="keyword">end</span>
0028 y  = zeros(size(xout));
0029 n  = length(xout);
0030 nx = length(x);
0031 
0032 <span class="comment">%%% see MASS 2nd ed page 181.</span>
0033 <span class="keyword">if</span> <a href="iqrange.html" class="code" title="function y=iqrange(x)">iqrange</a>(x)&lt;=0
0034   s=1.06*std(x)*nx^(-1/5);
0035 <span class="keyword">else</span>
0036   s=1.06*min(std(x),<a href="iqrange.html" class="code" title="function y=iqrange(x)">iqrange</a>(x)/1.34)*nx^(-1/5);
0037 <span class="keyword">end</span>
0038 <span class="comment">%  s=1.144*std(x)*nx^(-1/5);</span>
0039 <span class="keyword">if</span> ss&gt;0
0040   s=ss*s;
0041 <span class="keyword">elseif</span> ss&lt;0
0042   s = abs(ss);
0043 <span class="keyword">end</span>
0044 <span class="keyword">if</span> gaus==1
0045   <span class="comment">% Gaussian kernel</span>
0046   <span class="keyword">for</span> i=1:n
0047     y(i) = 1/nx*sum(<a href="norpf.html" class="code" title="function y=norpf(x,mu,sigma2)">norpf</a>((xout(i)-x)/s))./s;
0048   <span class="keyword">end</span>
0049 <span class="keyword">elseif</span> gaus == 0
0050   <span class="comment">% triangular kernel</span>
0051   s=s*1.2113;
0052   <span class="keyword">for</span> i=1:n
0053     y(i) = 1/nx*sum(max(0,1-abs(xout(i)-x)/s))./s;
0054   <span class="keyword">end</span>
0055 <span class="keyword">else</span>
0056   <span class="comment">% Gamma kernel</span>
0057   <span class="keyword">if</span> std(x)/mean(x) &gt; 0.9
0058     b = s;
0059   <span class="keyword">elseif</span> std(x)/mean(x) &gt; 0.4
0060     b = s/2;
0061   <span class="keyword">elseif</span> std(x)/mean(x) &gt; 0.2
0062     b = s/5;
0063   <span class="keyword">else</span>
0064     b = s/40; <span class="comment">% how to choose this?</span>
0065   <span class="keyword">end</span>
0066   ii = x &gt;= 2*b;
0067   <span class="keyword">for</span> i=1:n    
0068     <span class="keyword">if</span> xout(i)&gt;0
0069       y(i) = 1/nx*sum(<a href="gammapf.html" class="code" title="function y=gammapf(x,a,b)">gammapf</a>(xout(i),x(ii)/b,b));
0070       y(i) = y(i) + 1/nx*sum(<a href="gammapf.html" class="code" title="function y=gammapf(x,a,b)">gammapf</a>(xout(i),(x(~ii)/2/b).^2+1,b));
0071 <span class="comment">%      y(i) = 1/nx*sum(gammapf(xout(i),x/b+1,b));</span>
0072     <span class="keyword">end</span>
0073   <span class="keyword">end</span>  
0074 <span class="keyword">end</span>
0075 
0076 <span class="keyword">if</span> nargout&gt;1
0077   xo=xout;
0078 <span class="keyword">end</span>
0079 
0080 <span class="keyword">if</span> nargout==0
0081   plot(xout,y)
0082   clear y <span class="comment">% no output</span>
0083 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Wed 28-Jul-2021 14:15:23 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>