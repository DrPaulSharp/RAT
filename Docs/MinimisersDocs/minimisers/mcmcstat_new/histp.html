<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of histp</title>
  <meta name="keywords" content="histp">
  <meta name="description" content="HISTP   Histogram scaled as relative frequencies (probabilities)">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html minimisers --><!-- menu.html mcmcstat_new -->
<h1>histp
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>HISTP   Histogram scaled as relative frequencies (probabilities)</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function h=histp(y,nbin,dens,smo) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment">HISTP   Histogram scaled as relative frequencies (probabilities)

 HISTP(Y) histogram for vector Y.
 HISTP(Y,NBIN) histogram with NBIN bins.
 HISTP(Y,DENS) or HISTP(Y,NBIN,DENS), where DENS is 'normal',
  'lognor', or 'kernel' adds estimated density on top of the histogram.</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../minimisers/mcmcstat/density.html" class="code" title="function [y,xo]=density(x,xout,ss,gaus)">density</a>	DENSITY  Density estimator using Gaussian kernel</li><li><a href="../../minimisers/mcmcstat/iqrange.html" class="code" title="function y=iqrange(x)">iqrange</a>	Interquantile range of each column of x</li><li><a href="../../minimisers/mcmcstat/lognorpf.html" class="code" title="function y=lognorpf(x,mu,sigma2,theta)">lognorpf</a>	LOGNORPF Lognormal probability density</li><li><a href="../../minimisers/mcmcstat/norpf.html" class="code" title="function y=norpf(x,mu,sigma2)">norpf</a>	NORPF(x,mu,sigma2)  Normal (Gaussian) density function</li><li><a href="../../minimisers/mcmcstat/range.html" class="code" title="function y=range(x)">range</a>	Y=RANGE(X) range of columns of X</li><li><a href="density.html" class="code" title="function [y,xo]=density(x,xout,ss,gaus)">density</a>	DENSITY  Density estimator using Gaussian kernel</li><li><a href="iqrange.html" class="code" title="function y=iqrange(x)">iqrange</a>	Interquantile range of each column of x</li><li><a href="lognorpf.html" class="code" title="function y=lognorpf(x,mu,sigma2,theta)">lognorpf</a>	LOGNORPF Lognormal probability density</li><li><a href="norpf.html" class="code" title="function y=norpf(x,mu,sigma2)">norpf</a>	NORPF(x,mu,sigma2)  Normal (Gaussian) density function</li><li><a href="range.html" class="code" title="function y=range(x)">range</a>	Y=RANGE(X) range of columns of X</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../minimisers/mcmcstat/mcmcplot.html" class="code" title="function mcmcplot(chain,inds,names,plottype,varargin)">mcmcplot</a>	MCMCPLOT Plot mcmc chain</li><li><a href="mcmcplot.html" class="code" title="function mcmcplot(chain,inds,names,plottype,varargin)">mcmcplot</a>	MCMCPLOT Plot mcmc chain</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function h=histp(y,nbin,dens,smo)</a>
0002 <span class="comment">%HISTP   Histogram scaled as relative frequencies (probabilities)</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% HISTP(Y) histogram for vector Y.</span>
0005 <span class="comment">% HISTP(Y,NBIN) histogram with NBIN bins.</span>
0006 <span class="comment">% HISTP(Y,DENS) or HISTP(Y,NBIN,DENS), where DENS is 'normal',</span>
0007 <span class="comment">%  'lognor', or 'kernel' adds estimated density on top of the histogram.</span>
0008 
0009 <span class="comment">% Marko Laine &lt;marko.laine@fmi.fi&gt;</span>
0010 <span class="comment">% $Revision: 1.7 $  $Date: 2014/02/17 19:32:19 $</span>
0011 
0012 <span class="keyword">if</span> length(y) ~= prod(size(y))
0013   error(<span class="string">'sorry, histp works only for vectors'</span>)
0014 <span class="keyword">end</span>
0015 
0016 my = mean(y); 
0017 sy = std(y);
0018 n  = length(y);
0019 
0020 <span class="keyword">if</span> nargin&gt;1&amp;isstr(nbin)
0021   <span class="keyword">if</span> nargin&gt;2
0022     smo=dens;
0023   <span class="keyword">else</span>
0024     smo=1;
0025   <span class="keyword">end</span>
0026   dens=nbin;
0027   nbin=[];
0028 <span class="keyword">elseif</span> nargin&lt;3
0029   dens=<span class="string">''</span>;
0030   smo=1;
0031 <span class="keyword">elseif</span> nargin&lt;4
0032   smo=1;
0033 <span class="keyword">end</span>
0034 
0035 <span class="keyword">if</span> nargin&lt;2|isempty(nbin)
0036 <span class="comment">% nbin=ceil(log2(n)+1);                        % Sturges' formula</span>
0037 <span class="comment">% nbin=ceil(range(y)/(3.5*sy*n^(-1/3)));       % Scott</span>
0038   nbin=ceil(<a href="range.html" class="code" title="function y=range(x)">range</a>(y)/(2*<a href="iqrange.html" class="code" title="function y=iqrange(x)">iqrange</a>(y)*n^(-1/3))); <span class="comment">% Freedman &amp; Diaconis</span>
0039 
0040   <span class="comment">% bar(...,'w') does not work with nbin&gt;150</span>
0041   nbin=min(150,nbin);
0042 <span class="keyword">end</span>
0043 
0044 <span class="comment">% scaled histogram</span>
0045 [n,x]=hist(y,nbin); 
0046 dx = x(2)-x(1);
0047 hh = bar(x,n./sum(n)/dx,1,<span class="string">'w'</span>);
0048 
0049 <span class="comment">% add density on top</span>
0050 h2 = [];
0051 <span class="keyword">switch</span> dens
0052  <span class="keyword">case</span> <span class="string">'normal'</span>
0053   t = linspace(my-3.5*sy,my+3.5*sy);
0054   hold on; h2=plot(t,<a href="norpf.html" class="code" title="function y=norpf(x,mu,sigma2)">norpf</a>(t,my,sy*sy)); hold off
0055  <span class="keyword">case</span> <span class="string">'lognor'</span>
0056   t = linspace(x(1)-0.5*dx,x(end)+2*dx);
0057   hold on; h2=plot(t,<a href="lognorpf.html" class="code" title="function y=lognorpf(x,mu,sigma2,theta)">lognorpf</a>(t,mean(log(y)),var(log(y)))); hold off
0058  <span class="keyword">case</span> <span class="string">'kernel'</span>
0059   [yk,xk]=<a href="density.html" class="code" title="function [y,xo]=density(x,xout,ss,gaus)">density</a>(y,linspace(x(1)-2*dx,x(end)+2*dx,200),smo);
0060   hold on; h2=plot(xk,yk); hold off
0061 <span class="keyword">end</span>
0062 
0063 <span class="comment">% return handles to the bars and to the density</span>
0064 <span class="keyword">if</span> nargout&gt;0
0065   h=[hh;h2];
0066 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Wed 28-Jul-2021 14:15:23 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>