<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of hwdiag</title>
  <meta name="keywords" content="hwdiag">
  <meta name="description" content="HWDIAG  Heidelberger-Welch MCMC convergence diagnostics">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html minimisers --><!-- menu.html mcmcstat_new -->
<h1>hwdiag
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>HWDIAG  Heidelberger-Welch MCMC convergence diagnostics</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function [B,pB]=hwdiag(chain,ns) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment">HWDIAG  Heidelberger-Welch MCMC convergence diagnostics
 plot(hwdiag(chain)) plots the Brownian bridges assosiated with
 the chain columns.
 [B,pB] = hwdiag(chain) returns the p-values of Cramer-von Mises
 statistic for stationarity of the chain components.

 See:
 Stephen P. Brooks and Gareth O. Roberts.
 Assessing convergence of Markov chain Monte Carlo algorithms.
 Statistics and Computing, 8:319--335, 1998.</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../minimisers/mcmcstat/cramerdf.html" class="code" title="function y=cramerdf(q)">cramerdf</a>	CRAMERDF  Distribution function of the Cramer-von Mises statistic</li><li><a href="../../minimisers/mcmcstat/spectrum0.html" class="code" title="function s=spectrum0(x)">spectrum0</a>	SPECTRUM0 Spectral density at frequency zero</li><li><a href="cramerdf.html" class="code" title="function y=cramerdf(q)">cramerdf</a>	CRAMERDF  Distribution function of the Cramer-von Mises statistic</li><li><a href="spectrum0.html" class="code" title="function s=spectrum0(x)">spectrum0</a>	SPECTRUM0 Spectral density at frequency zero</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [B,pB]=hwdiag(chain,ns)</a>
0002 <span class="comment">%HWDIAG  Heidelberger-Welch MCMC convergence diagnostics</span>
0003 <span class="comment">% plot(hwdiag(chain)) plots the Brownian bridges assosiated with</span>
0004 <span class="comment">% the chain columns.</span>
0005 <span class="comment">% [B,pB] = hwdiag(chain) returns the p-values of Cramer-von Mises</span>
0006 <span class="comment">% statistic for stationarity of the chain components.</span>
0007 <span class="comment">%</span>
0008 <span class="comment">% See:</span>
0009 <span class="comment">% Stephen P. Brooks and Gareth O. Roberts.</span>
0010 <span class="comment">% Assessing convergence of Markov chain Monte Carlo algorithms.</span>
0011 <span class="comment">% Statistics and Computing, 8:319--335, 1998.</span>
0012 
0013 <span class="comment">% ns is the length of the the Brownian birdge returned</span>
0014 
0015 <span class="comment">% ML, 2002</span>
0016 <span class="comment">% $Revision: 1.3 $  $Date: 2003/05/07 12:22:19 $</span>
0017 
0018 [nsimu,npar] = size(chain);
0019 
0020 <span class="keyword">if</span> nargin&lt;2
0021   ns=200;
0022 <span class="keyword">end</span>
0023 
0024 y = cumsum(chain);
0025 x = y(nsimu,:)./nsimu;
0026 
0027 <span class="comment">%% Spectral density estimate for variance</span>
0028 n2 = floor(nsimu/2);
0029 S0 = <a href="spectrum0.html" class="code" title="function s=spectrum0(x)">spectrum0</a>(chain(n2:nsimu,:));
0030 
0031 s = linspace(0,1,ns);
0032 B = zeros(ns,npar);
0033 <span class="keyword">for</span> i=1:ns
0034   n = floor(nsimu*s(i));
0035   <span class="keyword">if</span> n==0
0036     B(i,:) = zeros(1,npar);
0037   <span class="keyword">else</span>
0038     B(i,:) = (y(n,:)-n.*x)./sqrt(nsimu.*S0);
0039   <span class="keyword">end</span>
0040 <span class="keyword">end</span>
0041 
0042 <span class="comment">%BB = cramerdf(sum(B.*B)./ns)&lt;0.95;</span>
0043 pB = <a href="cramerdf.html" class="code" title="function y=cramerdf(q)">cramerdf</a>(sum(B.*B)./ns);</pre></div>
<hr><address>Generated on Wed 28-Jul-2021 14:15:23 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>